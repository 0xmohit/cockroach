# LogicTest: local

# ---------------------------------------------------------
# JOIN
# ---------------------------------------------------------

statement ok
CREATE TABLE a (a INT PRIMARY KEY);

statement ok
CREATE TABLE b (b INT, INDEX (b) WHERE b IS NOT NULL)

# The partial index can be used because the ON condition implicitly implies the
# partial index predicate, b IS NOT NULL.
query T
EXPLAIN SELECT * FROM a JOIN b ON a = b
----
distribution: local
vectorized: true
·
• merge join
│ equality: (a) = (b)
│ left cols are key
│
├── • scan
│     missing stats
│     table: a@primary
│     spans: FULL SCAN
│
└── • scan
      missing stats
      table: b@b_b_idx (partial index)
      spans: FULL SCAN
