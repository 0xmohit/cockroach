# LogicTest: 5node-dist

statement ok
CREATE TABLE xyz (
  x INT,
  y INT,
  z TEXT
)

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

statement ok
ALTER TABLE xyz SPLIT AT VALUES (2), (3), (4), (5)

statement ok
ALTER TABLE xyz EXPERIMENTAL_RELOCATE VALUES
  (ARRAY[1], 1),
  (ARRAY[2], 2),
  (ARRAY[3], 3),
  (ARRAY[4], 4),
  (ARRAY[5], 5)

query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder from [SHOW EXPERIMENTAL_RANGES FROM TABLE xyz]
----
start_key  end_key  replicas  lease_holder
NULL       /2       {1}       1
/2         /3       {2}       2
/3         /4       {3}       3
/4         /5       {4}       4
/5         NULL     {5}       5

subtest Union

# Simple UNION ALL and UNION. (The ORDER BY applies to the UNION, not the last select.)
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION ALL SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0ll9v2jAUxd_3Kaz7tGmOgp2EP3miW5mExKADJm2qeMiIVSFRnDlBgiK--5RkUQui13YIj0l8jn8-9whzgPTvGkKYDUaDr3OyVWvybTr5Th4Hvx5Gd8Mx-Xg_nM1nP0afyP8lu3LBbv9Cfo6HkzG5G40ufJtM7wdT8uU32S2AwkbGYhw9ixTCR2BAgQMFDyj4QCGABYVEyaVIU6nyJYdCMIx3ELYorDbJNstfLygspRIQHiBbZWsBIcyjP2sxFVEslNsCCrHIotW62CZRq-dI7fu7_QtQmCXRJg2J4-Y7T7ZZSPoMFkcKcpu92qdZ9CQgZEdaDyFoDIHbIMykyoRy2VkCffb5XX-vjn_QhP-rrVSxUCK-ZHoBYiwdmbj89Izvbe-fbM_MJ8gMJuhyx_Wsa2QB0W4QgttAVINmdQdt6N-u68_NQ-QmIXqO61tP0gKi0yAEt4GokuY3Srry79T198xD9ExC9J3i19dukhYQ3QYhuA1ElbR3o6Qr_25df988RN8kxMCxnqMFQq8xBG6DUKXs3yjlyr93o78AU5EmcpMKo9u3ld_fIn4S5X2fyq1aigcll8U25eOk0BUvYpFm5VdePgw35acc8K2YoWIPF3NU7J-I2bnYu0bs42dmOHeAqju4uI2Ku7i4c82hu9eIe6iYaRJjeMmYrmV4zTTo7KqeMbxoLNCg41VjbY0c75qOHS-bTo23jfU06HjfeEsjxxunYed44c7Vi-OHfwEAAP__HtgCVw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz UNION SELECT x FROM xyz ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysll-L2kAUxd_7KcJ9aulIvDOJrnnatloQrG7VQsuSh9QMS8BN7GQCuuJ3LyaLuxGdP4mPSebcc3-eg8we8n9rCGAxmoy-LZ1CrJ3v89kP53H0-2HyZTx1Pg7Hi-Xi5-ST83pkWx3Y7l6cX9PxbHrh_Ww-HM2dr3-cbQgE0izm0-iZ5xA8AgIBCgQYEPCAgA8hgY3IVjzPM3E8si8F43gLQZdAkm4KeXwdElhlgkOwB5nINYcAltHfNZ_zKObC7QKBmMsoWZc2G5E8R2J3v929AIHFJkrzwOm4R-dZIQPnHiE8EMgK-TY-l9EThwAPxHyFYZLLJF1J16_7K-ZTm_nvEfF2jKwRI5pDelcN3uYWaSZiLnhcmxoeVCvQrvEKvg3jIhOSC5fi-fjPV-f3avPRIkeDGF3acZl1WTVLnH7FXsOy2kDekpI1okRzzHpdqTkmNaFkHdezzlKzxImy3zBLC0i8JSVrRInmmPUsmTkmM6H0OuVfvV2WmiVOlHcNs7SAxFtSskaUaI5Zz9Izx_RMKP2OdZKaFU6Mg4ZJWiDi7RhZI0Y0h7x-HbhgMOf5JktzfnYtuDy5e7wu8PiJV3eLPCvEij-IbFXaVI-zUle-iHkuq69YPYzT6tNxwfdiVIq9mhjPxVQpZmpn1sbZU4p9tbOvFFOqVveU6r5a3G8DfacUD9TOgzbOqOmYrmStWobqmqGmZ9iqaKhuGmqqhuqu6czVXUNN2bBV21BdN9T0DVsVjqoLRzWFo3aFCw8f_gcAAP__so088A==

# UNION with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x < 3 UNION SELECT x FROM xyz WHERE x >= 3 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt9q2zAUh-_3FOJcbUzBObLTP4ZBtzVlgS7pnIxtdL7wbFEMrp3JMrgtefdhe6R1aSXZymUs_c45-vRB9ADl3wx8WM8v5583pBIZuQhWX8n1_OfV5cfFkrw9X6w362-X78j_LXW3ob67Jz--zIM5qcnvajp1Y-KS78vFaqnbyD8Ql6yC83lAPv0idQgU8iLhy-iWl-BfAwIFBhRcoOABhRmEFLaiiHlZFqLZ8tAGFkkN_pRCmm8r2XwOKcSF4OA_gExlxsGHTfQn4wGPEi6cKVBIuIzSrG2zFeltJO7O6rt7oLDeRnnpk4nTdL5IM8mFT85wfzTf9xfLzQlQWFWyWYFwR6Go5GPvUkY3HHzcUfP5ztNSpnksnVl_OEV9NqT-0_PjeADNlZkTcEcRQHME3qsNHutWeSESLnjSqxruVCOwqfEIsyFnXBdCcuEwfF7-_av1j3r1ccAtG1yywyaOe1jPNRPuER-N9HwIARsENqabMkBzCH3TmTkEZsLAnTjeYTXQTLhHcDxSgwEE0AaBjQamDNAcQl8D1xyCa8LAm7R_PwfUQDPhHsHJSA0GEEAbBDYamDJAcwh9DTxzCJ4Jg9nksBJo5tsDOB0pwYDz43gANgqYEkBzBK8_fV5oEPByW-Qlf_YEernytHka8eSGd--osqhEzK9EEbdtup-rNtd-SHgpu1XsfizybqkZ8GkYlWGvF8bnYaYMu-rOrk1nTxmeqTvPlGHG1OkjZfpYHT62OfSJMnyq7nxq0xk1jukks7IM1ZqhxjO0Eg3VpqFGNVS7pmuudg01sqGVbajWDTW-oZVwTC0c0wjHhgkX7t78CwAA__9_SZP8

# UNION with partial overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM xyz WHERE x <= 4 UNION SELECT x FROM xyz WHERE x > 1 ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslt9umzAUh-_3FNa52jRH5BjSP0iTuq2pFqlLOpJpmzouGFgVEoXMGIm2yrtPwJSWqrUNziXYv3OOPz4JP0D5NwMf1vPL-ecNqURGLoLVV3I9_3l1-XGxJG_PF-vN-tvlO_J_S91tqO_uyY8v82BOavK7mk7d-APxyPflYrXU7eQEySo4nwfk0y9Sh0AhLxK-jG55Cf41IFBgQMEFCh5QmEFIYSuKmJdlIZotD21gkdTgTymk-baSzeuQQlwIDv4DyFRmHHzYRH8yHvAo4cKZAoWEyyjN2jZbkd5G4u6svrsHCuttlJc-mThN54s0k1z45Awfj-b7_mK5OQEKq0o2SxDuKBSVfGxeyuiGg487aj7geVrKNI-lM-tPp6jPhtR_CgDHE-AEzQG4owCgOQHv1QaPdau8EAkXPOlVDXeqEdjUeITZkDOuCyG5cBg-L__-1fpHvfo44CMbfGOHTRz3wJ5rRtwzPhrp-RAENgwsTDdFgOYM-qYzcwbMBIE7cbwDa6AZcc_geKQGAxCgDQMLDUwRoDmDvgauOQPXBIE3af8-h9RAM-KewclIDQYgQBsGFhqYIkBzBn0NPHMGngmC2eTAEmgG3BM4HSnBAAA4noCFAqYA0JzA61efFxoEvNwWecmfXYFerjxtrkY8ueHdPaosKhHzK1HEbZvucdXm2hcJL2W3it3DIu-WmgGfhlEZ9nphfB5myrCr7uzadPaU4Zm680wZZkydPlKmj9XhY5tDnyjDp-rOpzadUeOYTjIry1CtGWo8QyvRUG0aalRDtWu65mrXUCMbWtmGat1Q4xtaCcfUwjGNcGyYcOHuzb8AAAD__9wdk_Y=

# UNION ALL with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz UNION ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyklF-Lm0AUxd_7KYb71MIVndHsH5-ytCkI1myTFAqLDzZeloDr2BkF3ZDvXtS22yzZMqOPM_cezo8zd-4R9M8CQtiu4tXHHWtUwT5v1l_Yw-r7fXwXJez9p2i7236NP7DfLS2ybuxpu2f2LYnWCbuL4z_lDln7t5wCQilzSrIn0hA-AAcEAQg-IASAsIAUoVJyT1pL1bccB0GUtxB6CIeyaur-OkXYS0UQHqE-1AVBCLvsR0EbynJSrgcIOdXZoRhsKnV4ylS3bLtnQNhWWalD5ri987qpQ7bkuBSQnhBkU7846Dp7JAj5CadRLCwpBC75mxTiTYoX86aUKidF-ZlxerrAmUhHVi73XnVe9vbPvLl5AtwgAVc4rj_lJSw4rqw5LN5CmHMIEw7fcYMpeVhwXFtzWOThm3P4JhyBM_wk6zwsOG6sOSzyCMw5AhOOhTMlDQuKW0uKiXvrAsWGdCVLTUZbyev3GuWPNC5BLRu1p3sl94PNeFwPuuEiJ12PVTEeonIoDTH9K-ZzxOK_Ys7P1N5rtT_HOpgjXswRX80RX88R38wR386aErsZS0_vfgUAAP__Or0DnQ==

# UNION ALL and UNION with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lkFv2k4Qxe__T7GaU6IsMjO2gfhE_g2VkCikkEqtIg4uXkVIhKVrI0EivnsFtpSQhtn1lt7A3vF7v5nn9b5A_msBCUx6g96ne7E2C_F5PPoiHnrf7wY3_aG4uO1P7idfB5fiolqzKVdsts9iNL7tjcX_P8T2Unwb9kdDcTMYsAufL19_b6YgYakzNUyfVA7JAyBIIJAQgoQIJMQwlbAyeqbyXJv9kpdDQT_bQNKUMF-u1sX-8lTCTBsFyQsU82KhIIH79OdCjVWaKRM0QUKminS-OMiszPwpNdvuZvsMEiardJknohHslUfrIhFdlF2C6U6CXhevCnmRPipIcCfdXUy0KZQJ4mMDXbpy06KTWq8S2mTKqOxPhenuA0ND3dCrAN91pLJy0kdYh_lt5xHrtz48aSPyaD22PHsf_6PeE9brfcsDmuidJbw6-fy2z_PDczzf1kfk-xgdLT8l3zmSxxrRdUhuQI0g9Nk2LD6qNvtGl7yZyQfa9YV1g8b2WV5Ycqd2gg4bQeQzaYuPCtqXmXyZMfSBdp20GzR2zjLp0J3aCTpqHL7XtSdt8VFB-zKTLzNGPtCuk3aDxuuzTDpyp3aCjhs-c7a4qJB9icmXGOP6yK5TdkOm5tmPWh-IjVW-0stcOX39m_vzg8oeVXneyPXazNSd0bODTPl3dKg7XMhUXpR3sfzTX5a39gbfFiNbTEfF-L6Y2OIWrxyyxRFfHLHFMW87ZovbvHKLLe7wyu2_Ke7wo4p539d8SpqWmPAhs-QE-ZQhWcT5nFmmjXzQ0JI05KNmI-ezhpZ3BPm02cj5uGHHIm4JnEWcDxxZAkd84CzkZNnWLIEjPnC2XZEPHFkCR_X2tunuv98BAAD__7nyFSA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJysl01v2kwQx-_Pp7DmlChGZmdtXnziaUMlpBRSSKVWEQcXryIkYlPbSBDEd694kRw2YWbX5hbAs__Z3_525Gwh_7uAECb9h_7XJ2eVLZxv49F357n_6_Hh_8HQubkfTJ4mPx5unZvTM-vjE-vNmzMa3_fHzpffzubW-TkcjIbkQ2-35d_rKbiQpLEaRq8qh_AZBLiA4IIEF3xwIYCpC8ssnak8T7P9I9tDwSBeQ9h0YZ4sV8X-66kLszRTEG6hmBcLBSE8RX8WaqyiWGVeE1yIVRHNF4eYZTZ_jbJNb715AxcmyyjJQ6fh7ZNHqyJ0esLtIUx3LqSrokzIi-hFQSh2rnkXkzQrVOYF5w308M4sC22y7ud5MU9mhSe0_fZEmXYxStpEvYcrAnu68mIbfgW6qO_XFG9QCS_qp2mCt3UxqkxYJWkWq0zFZ-tPd1Qz8uNZX2qhXQGtFPrydxfX75ytLywMMhDIw4Ynq1xQpo_TPltXuaBMVnlBP1C1vqA2eFtV-JpeUTO-qO-42hU1BYz6edpfUTQHjCZ8ZcPzq_jL9HHi276Kv0xW6S_W9tcCr2hX4Wvqrxlf1HdczV9TwKifp72_0hywNOHrNw5vMdb-Mn2c-Hau4i-TVfora_trgVd0qvA19deML-o7ruavKWDUz9PeX98csG_CN2hUsZfp4kS3exV7mazSXr-2vRZwRdeerqm7ZnRR3281d03xon6a9V7vP4kaq3yZJrnSXvM_X7m5f_1X8Ys6_q-Qp6tsph6zdHaIOX4cHeoOX8QqL46_iuOHQXL8ad_g-2JBFiNdjGRx66xY6MWSLPbpZJ8sDujioE7bLbK4TSe3yWLJ4O6Q1V26uEtb0mQ0oSVjmAnaMsHsW9CeCcmU06ZxvdOqCcY1QcsmWkw5rRvXO-2b6DDhtHCCMU7QyjG9I20cMnMNmcHGTbZaow1p45AZbkgrh4xyWGu-IW0cMhMOaeWQUQ5p5bjeaeMkM-QkrZxklJO0cnrv091__wIAAP__FU6FIg==

# UNION ALL with conflicting numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) UNION ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0llFv2j4Uxd__n8K6T61qFK6TAM0T_a9MQmLQQSdtqnjIiFUhUZw5QYJWfPeJJFJLU64dlz2G-Obc3z3Hxi-Q_VlBBLPBaPDlnm30in2dTr6xh8HPu9HNcMwuboez-9n30SW7qNZsyxXb3TObTG8HU_b_L7a7ZD_Gw8mY3YxG9ELOni9fH7dz4LBWiRzHTzKD6AEQOAjg4AOHADiEMOeQarWQWab0YclLUTBMthC1OSzX6SY__DznsFBaQvQC-TJfSYjgPv69klMZJ1J7beCQyDxergqZVC-fYr3rb3fPwGGWxussYi3voDzZ5BHrI-8LmO85qE3-qpDl8aOECPfcvouZ0rnUXnjcQF9c2WmJk1qvEkonUsukrjDff9DQWLVU6uG7iVStnOzDb8L8dvKIDqPnff9kJ4HD9LFTGw7v-1fWmuEnXCiECCcENnOi48AvxLu28Ork97su3_fP8X3TLJGeY3C0_JR870geGwTZIseeaHm-yyFi6KMacz3FLodIE2bhBG2_fe24sXvO7Svs-a3w_ZYXuHhu6KNir6O7eN6AGX0naHvP7bixd07PfXt-K_ygVfyjN_bc0EfFXkd38bwBMwZO0Pae23Hj9Tk9D-z5rfDDlovjhi4q8jq4i-MNiDF0QLb3245atP_VtewDzanMUrXOpNUtoX24Z8jkUZb3kkxt9ELeabUoZMrHSVFX_JDILC_fYvkwXJevDg2-LUayWBwV4_tiQRZ3aGWfLA7o4oAsDum2Q7K4Syt3yOIerdz9THGPtiqk-76mU9I2xIQOmSEnSKcMhUGczpnBbaSDhoakIR01EzmdNTTsEaTTZiKn44Y9g7ghcAZxOnDCEDhBB85ALgzHmiFwgg6c6VSkAycMgRPNzrb5_r-_AQAA__-bmSDS

# Only one distinct processor should be used in the single node UNION case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) VALUES (1), (2) UNION VALUES (2), (3)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJykkc9q8zAQxO_fU4g9xSCI5dx0-kLjgsF10jgpheCDkZZgUKVUf0oh-N2LZWia0pS0PWp2fzsz6AjuWQGHOi_zmw0JVpHb9fKO7PLHVTkvKjJZFPWmvi8T8jAvt3lNJiyhZJIlZFsVy-pdzQZ1ljRAQRuJVfuEDvgOGDQUDtYIdM7YQTrGhUK-Ak8pdPoQ_CA3FISxCPwIvvMKgYMyolXkpVUBHUmnKVCQ6NtOxf2eggn-RDvf7hE46-kvHdiUXeWQXXQ4HQ7aWIkW5aeLX2RYdM53WvhpdrYL_xlcSjD7Scc1uoPRDq_qlg4JUe5xrONMsAJX1ohoMz6XkYuCROfHaTY-Ch1H8RM-wuwvcPYtPDuD077p_70FAAD__6Ke6m8=

subtest Intersect

# Basic INTERSECT ALL and INTERSECT case -- should return every row.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT ALL (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9u2jAUh-_3FNG5ajWjYCfhT6RJdCvTkBh0hItNVS5S4hUkSjInSE0r3n1KKOuSgE9M2twV8Gf_cvydnjxD9GcNNjjD8fDLXNuKtfZ1Nv2u3Q5_3oyvRhPt4nrkzJ0f40vt4mVNsl_xmDxdaqPJfDhz0m-vxuOjK6az6-FM-_xLS1wgsAl8PvEeeAT2LVAgwICAAQRMIGCBSyAUwYJHUSDSJc8ZMPIfwW4TWG3CbZx-7RJYBIKD_QzxKl5zsGHu3a35jHs-F3obCPg89lbr7JhQrB48kQwekycg4ITeJrK1lp6ePN3GtjZg4O4IBNv4ZfvXXe8SbelFy_x-AwruziUQxd49B5vuyHkxrUZjspMxX_fZbgLhc8H93E5uSmJLjjzrNy9aOjyehjot3Mg8CbmddwcIrPnv-GJALz-J1f0y--vfo9PCo78-lqFSfScQMRc6tYqV-nhyf7NC2Y5V5GXTIyEmQSsIddYu1vjo8VbueFpdLlpBLp21dONdukAhaKfhoOxk0Ab6gDbUB0j9D33QObcPWPX7ZVXu12jp5ruIqBC023BQdjJoAyKyhkRE6n8QsXuuiEb1-zWq3K_Zysby24uoELTXcFB2MmgDIhoNiYjU_yBi71wRzer3a1a5X6v1LhoqxOw3GpOdjNmAhGZDEiLVP0jYf4vX0yP7z3gUBpuIV3rzbKc14_49399BFGzFgt-IYJEds_84zbjsdcPnUbz_le0_jDb7n9KA1eFuHZjSWrRVi-7LaapQM6YGd-vAhZqp0lYtui-nWZFu_08bObhdhA0pbMpvy5TCjMqPtur0hxxG-kMOY_2B0Eh_IDTSH506_SGHkf6Qw1h_IDTSHwiN9EdXamlPLmmvTn_06xguhxHD5TBmOEIjhiM0NgFUxmb5P6nK3FSl0SGgNDmVcURzWpoiOVUpk4tO5WMEMZ2W5oiK6giNuI7QmOwYjtiO4ZjupRmqpLucxnSX06juCI7pjuCY7qVBmte9g-hemilKupdmipLuchrTXU6juiM4pjuCY7qX5qmS7nIa011Oo7ojOKY7gmO6l6Zq_l27LdedlWaLVHd39-FvAAAA__9fq3zW

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) INTERSECT (SELECT y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF9v4kYUxd_7Kaz7lKhGZv4QiKVK2TZURaJhCzy0WvHghWmCxGJqGylslO9eARsINr7HY5u8JeAzc3zmnp9sXij-b0E-jbr97m9jZx0tnN-Hgz-dL92_P_c_9R6cq_veaDz6q3_tXP24ZrO_4nnz_drpPYy7w9H203PfDob33aHz6z_OZkIuLcOZeQi-mZj8LyTIJUkuKXJJk0stmri0isKpieMw2l7yshP0Zs_kN12aL1frZPvxxKVpGBnyXyiZJwtDPo2DrwszNMHMRF6TXJqZJJgvdtusovm3INrcPW--k0ujVbCMfafhbXcerBPfuZM0eXUpXCfH5eMkeDTki1e3uIX7eZzMl9PEa53ufydS6x8lXzfOUxA_nbn-6EHaeHgfg6gvB1UqB1FvEDrXxHGd9TKMZiYys5OVdqvk2pRNYPNooXUpCyipo4WbChbcUi7_COKnkUkGK0-lkhpvVsZ_1_9P_T65tDD_Jld34vqXaP74tPvrMGH5t9W2mbBRGCUm8lQmtZ9z1-8UiO1cIj8WPWPiIWyEK0830xmf3f72ZHthUeICHfZkw1PWNAMmDrN5c0Ga2QRRZxKqVBKi3ih0romKMBEleVajBZRUHs_sLFTmmfggnoEJe-NZJrWiPJPFeySL1Eg1PG0NFGDiMBztCwLFIghRZxKqVBKi3ih0romKbZYlgVKjBZRUHlDsLFQGivwgoIAJewNKJrWiQFHFe6SK1Eg3dm9FdkABJg7D0bkgUCyCEHUmoUolIeqNQueaqNhmVRIoNVpASeUBxc5CZaCoDwIKmLA3oGRSKwoUXbxHukiNWg1rnAALh9G4vSBOLGIQ9eWgSuUg6g1C55qo2GRdEiY1WkBJ5cHEzkJlmOgPggmYsDeYZFIr8_PNmfWHJl6Fy9gU-mWmuc3MzB7N_gzicB1NzeconO622f872Ol2H8xMnOy_Fft_esv9V1uD78UiLRbvxfpELOzEQlVRS1FJfVtFrdq8WrKJKz5xxW7d4nfmxQKcF6-WsopaNSupO7xas4nf8OKWhVimxTesuM2fdZsVg3vusGINin3LU6EJsJCBihUXeDUEAy-HZAByhAZejtggMmg5DV6C4DNsscEDUCM-ADkCBJAjQiA5qIvIEOY0eBQdj5iUPIMJwUNG3IBj5zGDbp3njOiAzTOksSo7r4Zl5-Ww7ECOys7LYdl5ykpAWcmjBkwsUKOyAzkqO5CjsiM5mHjJU1aCoZP8E1xKnim75FEjNTh2HjXo1nnSSEAamSGNTdmBGpUdyFHZkRyUHcjhUz9PWQkoK3nUoLIDyqJzA5hEZQeYRGUHcjTxPGUVmBrFvyCn5JmyKx41CjzQKR414NYVTxoFSKMypLEpO1CjsgM5KjuSg7IDOSq74imrAGUVjxr0lg8oi84NYBK95wNMohd9IEcTz1NWoWPn35pT8mzZedRo8ECnedSkb33y-tP_AQAA___L4gvN

# INTERSECT ALL and INTERSECT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl01v2kwUhffvr7DuKlGMzIwNSSy9EmlDJSQCKbBoFbFw8JQgEeyOjRQS8d8rPlTC1xwPY9xdgHm41-feMyd8UPJ7TD5168361541lWPrW6f9YD3Vfzw27xot6-K-0e11vzcvrYv1mdnqxNvs3Wp37usd68tPa3ZpNVq9eqe7OHDXbILDfbJpEoWiFbyKhPwnYmQTJ5tcsskjmyrUtymW0UAkSSQXRz6WQCN8I79s02gST9PF232bBpEU5H9QOkrHgnzqBc9j0RFBKKRTJptCkQaj8bJMLEevgZzV3mbvZFM3DiaJb5WcReX2NPWtGqf-3KZomm6-PkmDoSCfze3sLXQjmQrpVLar19jVztdviOeZ9RIkL7sA9eebFrhOC59VYPnJ4J4gA8tZB-9oD5vviWQopAgPFs506sDjPAg5FF2RtmOH7yjam8XC37YA2TQWv9KLGru6_F-Ohi-rP_9qzI5qXDF7vgOdt6JSFDt8ew7Hyle3yjONNcuwZQ4vOa623UAT6z2rntNuOjrkKYR7ghAsZyW8oz0UZzhWmOF49knzLIN2S46nvfGgifWgr8-58Ro6sDyFcE8QguWshHe0h-I2nhe28W72SbtZBu2Vlv_66G08aGI96JtzbryGDixPIdwThGA5K-Ed7aG4jXcL23gv-6S9LIOulLT3HbSwHvPtOfddQwWWnwzuCTKwnHXwjvZQ3LZ7_-QnxIGmOiKJo0kiMv06KC8eS4RDsRIriaZyIB5lNFiWWb1sL7nlG6FI0tWnbPWiMVl9tGjwM8x2YfYZ9rZgpgezshFdMaG5UW0OanOl4q5acVdDca4H7yiuS1dMaG5Um4PanlJxMK6KEuZV9byqSvpaDV-b2EsNI3sBGmimppG9AA1q3ygVv1UrfmtiLzWM7AVosOJqGtkL0KA2U2cIuor3btPtBOIggvauU60MUtMwhACOHl2NwxgCOKq-d6luC-8B4fduVR2vABqZBeFoY9U4sgvCUXV1pKCxqSOFgUxhRqECaOgXs1gBOPSLWbAwdbIwEC3MKFsADf1ili4Ah34xyxdulC9cnS8c5As3yhdAI78gHD26Wb4gHFVX5wsH-cKN8gXQyC8IRxtrli8IR9X18qU__-9PAAAA__9mm4e6

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) INTERSECT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzE2Ftv4kYcBfD3fgprnhKtEcyFm6VKbBsqIbFhCzy0WvHAwjRBYjG1jRQS5btXXFQHD_6fGWPYt1x87L-PPT8NvLH43yUL2Kjb7_4-9jbR0vtjOPjifev-9bX_uffo3T30RuPRn_177-54zPZwxMv21RsMH7pD77e_ve2913scd4ej3QH0gRPms1U414_THzpmwTfGmc8E85lkPlPMZ3U28dk6Cmc6jsNod8jbPtCbv7Cg5rPFar1Jdn-e-GwWRpoFbyxZJEvNAjaefl_qoZ7OdVStMZ_NdTJdLPeXWUeLH9No23nZvjKfjdbTVRx4leruyoNNEngdwSbvPgs3SXr6OJk-aRbwd99-hFEYJTqq1k-v3uGfck8vXE7_sIiTxWqWVHkte4XdnURzHel54HV45nLpGb5vvedp_GykJ-_pSNJlpI-l83pprasCrQujlPza64VqF8aDLbH2Ru5I6XnCw7XO3Sc1t3R7XdKZmlecya3LdKaWxUyb1bmpJrskOuTMzF909KRHOhmsqyrT5Hi71sEH_j73-8xnS_1Pctfhn-5_jRZPz4cf_3_p8--sXXrbj2ElXFdVPVvDeelqJ9fnDgvfYt1XRaUqnb0FQxxXfqOot-D0qbf8Zt661N4osXdVoHdh1GIrrm3xwni0VxOXl6qb2wuTJ265M7l1mSfu-ZmuJy6_mbjCfukJm5UnK1XlLB4Y4rjymkXFA6dPxRM3E8-hdt4ssXdVoHdh1GIrnm3xwni0VxNPlKqL2wuTJ165M7l1mSfe-ZmuJ564mXjSfulJm5WnKvvPvm7igSGOK69VVDxw-lQ8eTPxHGrnrRJ7VwV6F0YttuLZFi-MR3s18WSpuri9MHnilTuTW5d54p2f6XriyZuJp-yXnrJZefWKs3dghOO6axf1Dpw-9U7dzDuH0nm7tNZVgdaFUYqtdra1C-PBXk07Vaosbq9LnnblzuTWZZ5252e6nnbqp3yHeGaooY7X4SrWVl8P1na3pedP-lBTHG6imf4ahbP9ZQ6_Dva5_R_mOk4O_-WHX3qrw792A34MczIs6LDIhvnHcOMkzN3C_KK0qF-SluqStJJ0WpKNK7pxRYbrdLhOzt2kx6bD_KK0AA-bTkvwsOm0Ag-7QTbeosNNh7DIhltkuE1fuU2_ZQ2gAjAFoUKrwgEr_CJXQBrBAuJIFhBHtIA4soXTuHCgC6d54cAXfhEwII2EAXFEDIgjY0AcIcNpZThghtPOcAANv0gaTlMjamAPQVMjADXCoMZpD0Kn4SaEjsNdCB2H2xA6jqwQBjWnxUtQPE2NANQIgxoXK0AaWQHiyAoQR1aAOLJCGNScFo_unaYmEzesEDQ1wApBSyPa4KWhqZGAGmlQ42IFSCMrQBxZAeLIChCHn1noDZ0EGzpJUyMBNdKgxsUKkEZWgDiyAsSRFSCOrJD0hk6i4WlqMnHDCklTA6yQtDSyBV4amhoJqJEGNU5W0GloBR2HVtBxaAUdR1YoekOnwIZO0dQoQI2iP0CBxQ7SyAoQR1aAOLICxJEVCnwxha5OU5OJG1YompqsFZP3X_4LAAD__3D5ZP0=

# INTERSECT ALL and INTERSECT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8ll9v4jgQwN_vU1jz1OqMEjsJfyJVau9KVSQOeoC0u-rykBJvQaIk6yQStOp3XyWU7YZQT0xK3krjX4aZ-Q3jF4h-LsGFcbff_XdCErkkN6Phf-S--_Wuf9UbkLPr3ngy_r9_Ts7ezqy3J9abZ_LltjvqkjX5npimNSP8nPQGk-5onB676vdRRFykzHB03R2Rf76R9RQorAJfDLwnEYF7DwwocKBgAQUbKDgwpRDKYCaiKJDpkZcM6PlrcE0Ki1WYxOm_pxRmgRTgvkC8iJcCXJh4D0sxEp4vpGECBV_E3mKZhQnl4smTm8v15hkojENvFbmkYaSRbxbLWEiXXLLfWbqu2xtM2kBhmMTpE5i-UgiS-C32e8iHDZl70TwfLDs_pRDF3qMAl73S43Jwjs4hLfvnJsE_TOL9PckqkL6Qws-9aZqS2JEDlbj1ovlYxMPQYHvNnGxC4eZFBApL8SM-u2TnF3LxOM_--jD197Qsnd6MAxkLaTBnv1J_f_h-u0TZDlXk7aUHvsQgaAShwc39Gh8M7-TCs_LqsRLqGbxhWPUPkEYWzQpZnHqEWL0jxGoaIaQ7uxFqHjtCvHz3eZnuWw3Drt9hjSxaFbI4tcO8Xod5TQ4j3dk53DrWYat8960y3bcb2VWhZoc1smhXyOLUDlv1OmzV5DDSnZ3D7WMdtst33y7TfadRv8EaOXSOzuHU_tr1-mvX5C_Sm52_nc-4ih94_0hEYbCKRKlbtpnWTPiPYtuDKEjkTNzJYJaF2X4cZlx2P_JFFG-f8u2H3mr7KP2C5eFWFZixSrRTie6oaaZRM64Ht6rAezXTpZ1KdEdN833a_JO2crC5D1tK2FZ3y1bCnKlDO1XmQw0j86GGsflAaGQ-EBqZj2aV-VDDyHyoYWw-EBqZD4RG5qOltLStlrRdZT46VQxXw4jhahgzHKERwxEa2wA6a7P4S6qzN3VpdAlobU5tHNGcFbZITlXG1aIz9RpBTGeFPaKjOkIjriM0JjuGI7ZjOKZ7YYdq6a6mMd3VNKo7gmO6Izime2GR5nVvIroXdoqW7oWdoqW7msZ0V9Oo7giO6Y7gmO6Ffaqlu5rGdFfTqO4IjumO4Jjuha2av2ubat15YbcodZ--_vUrAAD__0qR08k=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) INTERSECT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYfxe-fT2HNVaLHCOaFl1haKduG1SJR2AJSW225YGGaILGY2kaCjfLdK2ADwcb_M-MxuUvAZ-b4zP_8ZPPM4n8XLGDDdrf968hbRwvv06D_m_e1_eeX7sdOz7t56AxHw9-7t97Nz2s2hys22x_eH5_bg7a38f5e12py6olbr9MbtQfD3WXocv1hd31_8NAeeL_85W3GzGfLcKZ7k-86ZsFXxpnPBPOZZD5TzGd1NvbZKgqnOo7DaHfJ817QmW1YUPPZfLlaJ7uPxz6bhpFmwTNL5slCs4CNJt8WeqAnMx1Va8xnM51M5ov9Nqto_n0Sbe832x_MZ8PVZBkHXqW62_nTfJHoKPDu-fEOgyDo9EYt5rP-Otl9w8YvPgvXyWnvOJk8ahbwF9_c38M8TubLaVKtn5vLrH-SfNt6T5P46cL1Jw_CxsPbjHjxkHbnap6SLJQSLzcmlWvitM56GUYzHenZ2Ur7VXJtihqwebJQv5YFlNTJQsPBgl_I5edJ_DTUSX9VlamkRtuVDt7A5GO3y3y20P8kN_f89kM0f3za_2UwYU2bCRuGUaKjqsyk9v_c9VsGsV1K5OeiF0z0wkq4qqpaOuOL29-dbc8tKm7Q8KqoVGW5IAQOj4PbuCIIbVJyickFhaY58XKDUrkmHDnEC6KwRAsoqTwU2llwRiF_JxSCCXtFYSY1UxQK85YJk5LJSlWVyyLg8Dg5zSuyyCIl7hKTC4tMc-LlBqVyTTiCQBRkUYkWUFJ5LLKz4Mwi8U4sAhP2yqJMaqYskuYtkyYlU5X9m1qJLAIOj5PTuiKLLFLiLjG5sMg0J15uUCrXhCMIZEEWlWgBJZXHIjsLziyS78QiMGGvLMqkZsoiZd4yZVKyeqVcEgF_x7m5uyKJLDLixUNy4ZBpSrzcmFSuCUcIqIIcKtECSiqPQ3YWnDmk3olDYMJeOZRJrchPVRfWH-h4FS5jbfQrVG2XmZ496sMZxOE6muovUTjdb3P4t7_X7T-Y6Tg5fMsP_3SWh692Bt-KeVrM34rVmZjbibl0UQvupL5zUcsmrRZk4pJOXJJb1-mdaTEH50WrhXBRy5qTukWrFZl4gxbXLcQiLW6Q4iZ91k1SDO65RYoVKPYdTYUawEIGKlZcoNUQDLQckgHIERpoOWIDz6DlPHgBgs-wxQYPQI34AOQIEECOCIHkoC48Q5jz4FF0NGJS8gwmOA0Z3gDHTmMG3TrNGd4Cm2dIY1V2Wg3LTsth2YEclZ2Ww7LTlBWAsoJGDZhYoEZlB3JUdiBHZUdyMPGCpqwAQyfoJ7iUPFN2QaNGKHDsNGrQrdOkEYA0IkMam7IDNSo7kKOyIzkoO5DDp36asgJQVtCoQWUHlEXnBjCJyg4wicoO5GjiacpKMDWSfkFOyTNllzRqJHigkzRqwK1LmjQSkEZmSGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzWn5Nmy06hR4IFO0ahJ3_r45X__BQAA__9LB2LA

# INTERSECT ALL and INTERSECT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT ALL (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt1u6kYQgO_7FKu5Cuoie9c2P5YikTZEQaKQAlJbpb5w8DYgEeyujQSJePcjQ0iOMdnx4uC7w2G_HWbmm8y-Qfz_AlwYd_vd3ydkJRfkbjT8gzx2_37o3_QG5Oq2N56M_-zXyNX7mc3-xHrzSv667466ZE3-XZmmNSVWjfQGk-5onB676fdRRFwTViPD0W13RH77h2w8oLAMAzHwX0QM7iMwoMCBggUUbKDggEchkuFUxHEo0yNvO6AXrME1KcyX0SpJ_9ujMA2lAPcNknmyEODCxH9aiJHwAyENEygEIvHni12YSM5ffLnprDevQGEc-cvYJXUjjXw3XyRCuqTDPrJ0Xbc3mLSAwnCVuKTDwdtSCFfJe-zPkE8bMvPjWTZYh4G39SjEif8swGVbel4Oztk5pGX_3iT4l0l83rNahjIQUgSZm7yUxI6cqMS9H8_GIhlGBjtq5mQTCTcrIlBYiP-Sqw6rXcv582z3r4_U2VHqn2lZOr0ZhzIR0mDOcaV-_fJ-u0DZTlXk_dITP2IQ1sPI4OZxjU-GdzLhWXH1WAH1DF43rOoHSCOLRoksLj1CrNoRYhWNENKdwwg1zh0hXrz7vEj3rbphV--wRhbNEllc2mFercO8IoeR7hwcbp7rsFW8-1aR7tv13VOhYoc1smiVyOLSDlvVOmxV5DDSnYPDrXMdtot33y7SfadevcEaObTPzuHS_trV-mtX5C_Sm4O_7e94ip-4fyTiKFzGotAr20xrJoJnse9BHK7kVDzIcLoLs_843HG791Eg4mT_Ld9_6C33X6U_sDjcLAMzVop2StFtNc00asb14GYZ-KhmurRTim6raX5Mmz_TVgY2j2FLCdvqbtlKmDN1aKfMfKhhZD7UMDYfCI3MB0Ij89EoMx9qGJkPNYzNB0Ij84HQyHw0lZa21JK2ysxHu4zhahgxXA1jhiM0YjhCYxtAZ23m_5Lq7E1dGl0CWptTG0c0Z7ktklGVcbXoTL1GENNZbo_oqI7QiOsIjcmO4YjtGI7pntuhWrqraUx3NY3qjuCY7giO6Z5bpFndG4juuZ2ipXtup2jprqYx3dU0qjuCY7ojOKZ7bp9q6a6mMd3VNKo7gmO6Izime26rZt_aplp3ntstSt297S8_AgAA__-K3tPW

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x < 3) INTERSECT (SELECT y FROM xyz WHERE x >= 1) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYfxe-fT2HNVaLHCOaFl1haiW3DapEobAGprbZcsDBNkFhMbSOFjfLdK2ADwcb_M-MxuUvAx3PmzP_8ZPPM4n-XLGCjTq_z69jbREvv03Dwm_e18-eX3sdu37u5747Go997t97Nz2u2hyuetj-8Pz53hh3vyft7U6vJmSdvvW5_3BmOdpehy_UHj996g-F9Z-j98pe3nTCfrcK57k-_65gFXxlnPhPMZ5L5TDGf1dnEZ-sonOk4DqPdJc97QXf-xIKazxar9SbZfTzx2SyMNAueWbJIlpoFbDz9ttRDPZ3rqFpjPpvrZLpY7pdZR4vv02jbftr-YD4braerOPAq1d3KnxbLREeB1-bHHQZB0O2PW8xng00SeG3BJi8-CzfJae04mT5oFvAX39zf_SJOFqtZUq2fm2vz1P1Pkm9b73EaP164_uRB2Hh4mxEvHtLuXM1TkoVS4uXGpHJNnO6zWYXRXEd6fnan_V1ybYoasHmyUL-WBZTUyULDwYJfyOXnafw40slgXZWppMbbtQ7ewORjr8d8ttT_JDdtfvshWjw87v86Tlj-tpo2EzYKo0RHVZlJ7f-5928ZxHYpkZ83vWCiH1bCdVXV0hlfXP7ubHluUXGDhldFpSrLBSFweBzcxhVBaJOSS0wuKDTNiZcblMo14cghXhCFJVpASeWh0M6CMwr5O6EQTNgrCjOpmaJQmLdMmJRMVqqqXBYBh8fJaV6RRRYpcZeYXFhkmhMvNyiVa8IRBKIgi0q0gJLKY5GdBWcWiXdiEZiwVxZlUjNlkTRvmTQpmars39RKZBFweJyc1hVZZJESd4nJhUWmOfFyg1K5JhxBIAuyqEQLKKk8FtlZcGaRfCcWgQl7ZVEmNVMWKfOWKZOS1Svlkgj4O87N3RVJZJERLx6SC4dMU-LlxqRyTThCQBXkUIkWUFJ5HLKz4Mwh9U4cAhP2yqFMakV-qrpw_6GO1-Eq1ka_QtV2men5gz6cQRxuopn-EoWz_TKHfwd73f6DuY6Tw7f88E93dfhqZ_CtmKfF_K1YnYm5nZhLF7XgTuo7F7Vs0mpBJi7pxCW5dJ1emRZzcF60WggXtaw5qVu0WpGJN2hx3UIs0uIGKW7SZ90kxWDPLVKsQLHvaCrUABYyULHiAq2GYKDlkAxAjtBAyxEbeAYt58ELEHyGLTZ4AGrEByBHgAByRAgkB3XhGcKcB4-ioxGTkmcwwWnI8AY4dhozaOs0Z3gLLJ4hjVXZaTUsOy2HZQdyVHZaDstOU1YAygoaNWBigRqVHchR2YEclR3JwcQLmrICDJ2gn-BS8kzZBY0aocCx06hBW6dJIwBpRIY0NmUHalR2IEdlR3JQdiCHT_00ZQWgrKBRg8oOKIvODWASlR1gEpUdyNHE05SVYGok_YKckmfKLmnUSPBAJ2nUgK1LmjQSkEZmSGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzWn5Nmy06hR4IFO0ahJb33y8r__AgAA__8cdmLN

# INTERSECT ALL and INTERSECT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll9v2jwUxu_fTxGdq1YyCnYCLZFeiWpjGhKDDriYVOUiJV5BSpPMTiTSqt99StKu48984hmyyxD_4sc-P4nnGeSPCDxYjCajD0srF5H1aT77Yt2Nvt1ObsZT6-LjeLFcfJ1cWq9LtsQq6jXb4skaT5ej-aL8_WYyeVtSEGv7a4kPBOIk5NPgkUvw7oACAQYEHCDgAoEe-ARSkay4lIkolzxXwDjcgtclsInTPCt_9gmsEsHBe4Zsk0UcPFgG9xGf8yDkwu4CgZBnwSaqtknF5jEQxXBbPAGBRRrE0rM6drnzLM88a0jJkIH_QiDJs9cd3j98X1jrQK53P_mG-ARkFjxw8OgL-buwPc2wjAypaVj2x7Dvn8rjRIRc8HDnY35JYkuOnPhzINcLns1Sm-5NZ1mk3Nu1BwhE_Ht2UQW__F9sHtZvD6qZvZ_PMTjfkfDTpJOkNu3t38TRvd2dvWlzEWgDEWzWsZ0zeqsRt68d9_Tm0nbNpW2by5qPgzUZh9Ox3TPaoxH3Sjvu6e1h7drD2rbHaT4Op8k43E71Z3UuezTiXmvHPb09Trv2OG3b4zYfh9tkHL3OGd3RCDvQDHt6c9x2zXH_Zd86Em3OZZrEkjdqU93ycDx84PVlySQXK34rklW1Tf04q7iqDYRcZvVbVj-M4_pVGbA53DeBByYwNcpNe2qaalwZ04P7JvDABKZGufeu7IBm-3T3d9pR37ejhOnunXX3addEcDWMCK6GEcHVMCY4QiOC90wEV8OI4GoYEVwNY4IjNCJ430TwKxNF1TCiqBpGFFXDmKIIjSh6baKoGkYUVcOIomoYUxShEUUHJopSo56A0IikCI1YitCYphiOdQWzsmDWFszqgmFfMCsM1Kgx0IPKoGWrmsZsVdOYrWoatRXBMVt1ytLhzHTaki6N2arVl7RxzNaD8qC01X_572cAAAD__xATi70=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz INTERSECT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv4kYUhd_7K6z7tCsNgpkxhFiqlFU3VZFosg08VFrx4IVpgsRiahsJNsp_rzApBBvfM2Pj7COYz3N8fM_xmGdK_l1QQKPb4e1vY28dL7zfH-7_9L7e_v1l-Glw5334PBiNR38NP3qvP9kIb7v_zWb7wxvcjW8fRrvvXw9vhbc5HJ6QoGU0M3fhd5NQ8JUkCVIkSJMgnwR1aSJoFUdTkyRRvPvJcwYMZhsKOoLmy9U63X09ETSNYkPBM6XzdGEooHH4bWEeTDgzcbtDgmYmDeeLbJlVPP8extubzfYHCRqtwmUSeK32buX7dRp4N1LcKJq8CIrW6XGFJA0fDQXyRdir-DxP0vlymra7pxLOLXGkvm29pzB5Oo8clSgXJW_9kK6GKHEjSw3RlQyRTTjil0o5nmq9jOKZic3s5GTZWUrFqg4We1TRbUqFhWVHFb0aKkQloX-EydPIpPerts75Nd6uTPCmDT4NhyRoYf5JP2QX8fHXeP749P8HuxxeXdblu6gVrdq6m3fi7Nr9k7WlQ_IsgtdWrbau0kVAx2GOeo13kYsj7pY4tJGtJbIJT_xSKTV7QFZvowuqsLCsrI3cVNRuI_nebaTs51_ZjL9utf0qjQB0HO7lVeON4OCIdLfEoRFsLZFNeOKXSqmZRVW9ES6owsKyskZwU1G7EdR7N4K2n39tM_5-K3ulcG4EoONwL_uNN4KDI9LdEodGsLVENuGJXyqlZhZ19Ua4oAoLy8oawU1F7UbQ790Ivv38-zbj321V6QOg4nAnrxvvAwc_pKshDm1ga4hswhG_VErNHPrV2-CCKiwsK2sDNxW128D_mf9fnJH2YJJVtEyM1b8Tnd3Fmdmj2ZuVROt4ar7E0TRbZv_xPuOyL2YmSfdH5f7DYLk_tBP4FpZ5WL6F_RNYusFS1aKv69CqV4fWmqcV67jmHdfs0l1-ZR6WQDdPq04t-qoOrcGk-azj4GZ3HWCVh3ssDC76ih-UHj8pfZa-5uHrOsHmYRRsQINg8zQKNk-jYEvQpahM-VoB2QY0CjfAUboRDiYd4Cjfkq9UifBCu3B4IeOSrxd06Xy_SJByWWgYp0cwT8NnMMDRQ5jH4VOYx2Fa-XqVfWB8oV-d0srTMK08DtMKcDSyPA7TWmjZE-OVBNsnvmVzeCGtqlA1LmlVfNMosHtT_D4GGAdolFaEg7QCHKUV4HDTzJes6gLjCy3rklZAo7QCHKUV4WhkeRylVfFbWNUHON-yObyYVn4Xiy6dbxrdAe9ahaZxSSugUVoRDtIKcJRWgKO0ar5ktQLGF1rW6S2Xp-FrLo_D91yAoxddHkdp1fxWViPr-JbN4YW0an4vm7_0ycsv_wUAAP__w6sofg==

# INTERSECT ALL and INTERSECT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2jwYhs_fXxE9R0UNCnYClEivRLcyDYlBBxxsqjhIiVeQKMmSIEEr_vvEh0RJGt92EDnjw3f85Iqvx4Z3iv8uyKVRp9f5OjZW0cL4Nhz8MJ46vx57992-cfPQHY1HP3sV4-Y4Zn0Ysd68GYPhQ2dofPltbCpGtz_uDEe7Afe9nnTwW-X0ej0hk5aBL_req4jJfSJGJnEyySaTHDKpThOTwiiYijgOot2Q932g66_JrZk0X4arZPfxxKRpEAly3ymZJwtBLo2954UYCs8XkVUjk3yRePPFfpowmr960aa93ryRSaPQW8auUbV2Mw9WiWu0mdnmNNmaFKyS0wxx4r0IctnWVK9iFESJiKz6eQFtfiub6xR_3hgzL56l0owm21M9XKeej1RYASx2Lha7ABZ2TS5ObkGn6wSRLyLhZ6uY7MIKoz65t-9ePBuJZBBaPAV4vAmFey4LmbQQf5KbNqv8H81fZvtXJwa5tOsFaPM0bXabe_1GYXgsB0s_qAahZZ8jyZu-eTY901jTCkva4lXLLuI6qOOIuVGa6zpcCoFRtV0NDLsmGSe3oNJsZyXZrkabp2kr287VlxVXWVV21XKK6AbqON5nszTdNLiwQmBUdVMDw65JxsktqDTdeEm6qdHmadrKutnqy8pWWVVOdX_c1NYN1HG8z7vSdNPgwgqBUdVNDQy7Jhknt6DSdLNL0k2NNk_TVtbNUV9WjsqqqleLyAaqON5lqzTZNKiwAlhUVVPDwq7JxcktqDTVnJJUU6PN07QL_Wz85PpDEYfBMhZKvwhrO2bCfxGHJxEHq2gqHqNgup_m8Hawz-0_8EWcHL5lhzfd5eGrXYEfwywdZh_DzlmY6YUZuyjdvCTN7YvSLXmaS4nbcuK2BnGuF04R1003L0mniOumW_K0IyVelxOvS8MN-bNuyJ810KspTd_Jw3eXuCkPIzdBGrgpTyM3QRq42ZJ3wxpoh5lmqmMnSCM9URz4CeJIUBQHhrJMSz0HzwF4eU8FkrJMdzmf3AGTZ9qL1i4oT8NtEMTRPiiPw40QxIFtTN5bWQOAz3RXLd3kaagbiCPd5HGoG4gj3eQ7CwNbC8s0WS3d5E2WgybLdZps9vCl1WS140A3EEe6oTg6eMqbLAdNlmearI5uII10Q3GgG4gj3VAc6MblGwwHGwyXn1-BblzeZDloslynyWYn12qy2nGkm1aT1Y4j3eRNloMmy3UO8Nklp3WC144j3bTO8NpxpJt8g7HBBmPL_xJJ6zbZ_vcvAAD__9IRrwc=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYUB_D3fgprnhKtEczF3KRKbBuqItGwBR5arXhgYZogEUxtI0GifPcVF8nBE85_7DG85eK_5_icmZ8Mbyz-f8nabNTtd38fe5to6f0xHPzlfe_-863_tffo3T30RuPR3_177-50zfZ4xXb36g2GD92h99u_3u7e6z2Ou8PR_gLqwtf79OfthPlsFc714_RFx6z9nXHmM8F8JpnPFPNZwCY-W0fhTMdxGO0veTsEevMta9d8tlitN8n-zxOfzcJIs_YbSxbJUrM2G09_LPVQT-c6qtaYz-Y6mS6Wh2XW0eJlGu06290r89loPV3Fba9S3a882CRtr8P9jmCTd5-FmyRdIU6mT5q1-btvX8UojBIdVYPzAjrii91aIs9aD4s4WaxmSZVnnrfD09UyS6XpHzvveRo_G8nJe1qOzFPOxwHwIP8E5MWuqAITENme2I4gKDQCkZ14WSOoXywnvc9mFUZzHen52Z0Od7lYsDT3zKWONK5VgtmzSyU0HUrwC1X55zR-HulksK6qTKfGu7Vuf-Dva7_PfLbU_yV3HX7_a7R4ej78dHEDpI_VKrCxldG1L5fpqln07bOWnO76SRWPYSVcV4Natsmfr39uJ88BiIUfVVGpyiKGgzpOja6XYjhYKzWc38TwPCOoF5mBreJ2MxDZrhRT3HYIIjvz6yjOyyPU3DV2ipdYgtkzO8XzleCsOL-R4nYbWxlds1Zc2B9hYXOCZaWqiigK6jg9aKMURcFaqaLiJormGAFvFJmBraJ2MxDZrhRT1HYIIjvz6ygqyiPM3DV2ipZYgtkzO0XzleCsqLiRonYbWxlds1ZU2h9haXOCVeXwoT-3oqCO04M2S1EUrJUqKm-iaI4R8GaRGdgqajcDke1KMUVthyCyM7-OorI8wsxdY6doiSWYPbNTNF8JzorKGylqt7GV0TVrRZX9EVY2JzioFDEUVHF6zFYphoK1UkPVTQzNMQDeyj8BW0HtJiCyPSkmqO0IRHbi1xFUlceXuWfsBC2xBLNndoLmK8FZUHUjQe02tjK6Vug72U8WGOp4Ha5ibfV1a23fND1_0schxOEmmulvUTg7LHP8dXDIHf4w13Fy_C8__tJbHf-1L_BjmJNhQYdFNsw_hutnYZ4vzBsuaeGUlk5pBdKS7LiiO67IcECHA7JuUDYd5k2XtHBKS6e0Auk62XEQbuQIi2y4SYZb9KxbNAo1um5OmxIgVGhVOGCFGwfsPC5B3DhheVgCaeQSiCOYQBzJBOKIJk7zwoEv3Dhp5_E6iBtHLY9PII2AAnEkFIgjokAcGcVpZ3gLxGlpMnHDKU5bI2rgJQK8vwCqBHiDQa8wtDUCWCOcrAFp-A7kZg2Iw7cgN2sEbY0A1gjaGgGsEU7WgDSyBsSRNSCOrAFxZI2grRHAGkFbI4A1grZGAmukmzWStkYCayRtjQTWSCdrQBpZA-LIGhBH1oA4_MhFWyOBNZK2RgJrpJM1II2sAXFkDYgja0AcWSNpaySwRtLWSGCNpK1RwBrlZo2irVHAGkVbo4A1yskakEbWgDiyBsSRNSCOrFG0NQpYo2hrFLBGOVkD0sgaEEfWgDiyBsSRNYq2RgFrFG2NAtYo2poAWBPktGby_svPAAAA___7elYH

# INTERSECT ALL and INTERSECT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv6jYcxd_3KaL_U6sapbYDtJEmcbfLNCRW7oCHTVc85DZei0RJlgQJWvW7TwQkSjx87KCGtwI52PnFv2PTN8r_XVBIk_6w_-vUW2UL77fx6A_ve_-vb8Mvgwfv6utgMp38Obz2rvbXrHdXrDev3mj8tT_2fvnb21x7g4dpfzzZXvBlODRfzLzX68PL9YwYLZNYPUQvKqfwO3FiJIiRJEYBMWrTjFGaJY8qz5Nse8lbGRjEawpvGc2X6arYvj1j9JhkisI3KubFQlFI0-jHQo1VFKvMvyVGsSqi-aIcJs3mL1G26a03r8RokkbLPPRa_nbk0aoIvR5nPUGzd0bJqjiMkBfRk6KQvzP7WUySrFCZ3z6eQE_cmMY6xH9svOcof66kOc3eD_MRLvP5SIXXwcJ68iQZWYMM19GwnrwBY7oRCk7O6_A9SRarTMX6c5ptw-iqcsrlkNXb_D3KnyeqGKW-qOCeblIVHttDjBbqn-Kqx69_zuZPz-VfBxQnwbdrgBdV8Pzm5Pd3agPkJ7A8JK0k9eUxklPDd4-G5w4r3GKB-6Llyzrmg3nsMXcaM9-FSz0w9u7bseE6nE92n1_Kfd6Q-3bgRRW8tfvCfpEJmzUmW35QRz4wj_19dhuTz4ELrwfGXj47NlyH88nyiUvJJxqSzw68qIK3lk_aLzJps8aCVnkwdZYPzGN_n3eNyefAhdcDYy-fHRuuw_lk-eSl5JMNyWcHXlTBW8sX2C-ywGaNtVt11AOz2N_lfWPqOVDhdbDYi2dHhutoPlm84FLiBQ2JZwdeVMHX-rn5P98_VnmaLHNl9UvydstMxU9q9zTyZJU9qm9Z8lgOs3s5KnPlG7HKi92nfPdisNx9tJ3gxzCvhvnHcHAU5m5hzs9Kd89JC3lW-t6cFkbi0kxcOhAXbuEKcdd095x0hbhr-t6cDozE22bibWO4Y37WHfOzBnp1jek7c_juHDfNYeQmSAM3zWnkJkgDN-_NbXgL6lArUxc7QRrpieLATxBHgqI4MJRrlXoMXgDw5k4FknKtXY4HD8DgWr047YLmNNwGQRztg-Y43AhBHNjGzd3KOwC81q5OupnTUDcQR7qZ41A3EEe6mXcWDrYWrpWsk27mkhWgZIVLyeqHL6eSdY4D3UAc6Ybi6OBpLlkBSlZoJeuiG0gj3VAc6AbiSDcUB7oJ8wYjwAYjzOdXoJswl6wAJStcSlYf3KlkneNIN6eSdY4j3cwlK0DJCpcDvL7knE7wznGkm9MZ3jmOdDNvMBJsMNL8L5GqbrP3n_4LAAD__4CHveE=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) INTERSECT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82N9u4kYUBvD7PoU1V4liBHNmTAJSJbZNqkZKky3kotWKCzZMEyQWU9tIkCjvvuKP5OAJ5xt7DHdL8Oc5PmfmJy9vIv1_KrpicHN38_tjsEimwR_9h7-Cbzf_fL37cnsfnF3fDh4Hf9-dB2e7a5bbK5ar1-Chf33TD377N1idB7f3jzf9wfoC9sIweD3PPy6HIhSzeGzuRz9MKrrfhBShIBEKJUKhRSgiMQzFPImfTJrGyfqSt03gdrwU3VYoJrP5Ilv_eRiKpzgxovsmskk2NaIrHkffp6ZvRmOTNFsiFGOTjSbTzTLzZPJjlKx6y9WrCMVgPpql3aDRXK_8sMi6QU-GPRLD91DEiyxfIc1Gz0Z05XvoXsUgTjKTNKP9Anp04bYWlVnrepJmk9lT1pSF5-3JfLXCUnn6-yp4GaUvVnL4npejypTzcQAyqjCBsKcONkZXGAIV20IXYU9dOK8ZVRoGFWdf1zDaB8vJ77OYxcnYJGa8d6fNXQ4WrOzdc6gjl8cqwe7ZoRKuPEoIK1X55yh9GZjsYd7UhU49ruam-8HCL3d3IhRT81921pPnvyaT55fNvw5ugPyxOhX2t7a6dnEYsZZD3z5rye6un1RxHzfieTNqFZv8-fr7isoSlDhI0qRGU1XRHNSxa3S7Fs3BWrnm8iSalxlBu9IM3D13GwMVG-Plues4qDj943gu68PU3j9untdYgt0zN8_LleDtuTyR5277W1tdc_ac3A8zuZxl1WjqKp6COnYPelmLp2Ct3FM6iaclRiAvK83A3VO3MVCxMV6euo6DitM_jqdUH2b2_nHztMYS7J65eVquBG9P6USeuu1vbXXN2VPlfpiVy1nWjc1PAqU9BXXsHvSqFk_BWrmn6iSelhiBvKo0A3dP3cZAxcZ4eeo6DipO_zieqvows_ePm6c1lmD3zM3TciV4e6pO5Knb_tZW15w91e6HWbuc5ahRRVNQxe4xO7VoCtbKNdUn0bTEAGSnwgTcLXUbAhXb4mWp6zCoOPvjWKrrg8zePW6W1liC3TM3S8uV4G2pPpGlbvtbW12r9NvtJwv0TTqPZ6lx-lm2tW6aGT-b7RDSeJE8ma9J_LRZZvvxYZPb_GFs0mz7rdx-uJ1tv1oX-DEs2TDxYSqG5cdwey8sy4XlpU-avNLKK61BWrEd13zHNRuO-HDE1g3K5sPyyidNXmnlldYg3WY7DsKXJcJUDF-x4Q4_6w6PQouvW_KmRAgVXhUJWJHWAduPKxC3TlgZlkAauQTiCCYQRzKBOKJJ8rxI4Iu0Ttp-vA3i1lEr4xNII6BAHAkF4ogoEEdGSd4Z2QFxXppC3HJK8tZQC7xEgPcXQBWBNxj0CsNbQ8Aa8rIGpOE7kJ81IA7fgvysId4aAtYQbw0Ba8jLGpBG1oA4sgbEkTUgjqwh3hoC1hBvDQFriLdGAWuUnzWKt0YBaxRvjQLWKC9rQBpZA-LIGhBH1oA4_C8Xb40C1ijeGgWsUV7WgDSyBsSRNSCOrAFxZI3irVHAGsVbo4A1irdGA2u0nzWat0YDazRvjQbWaC9rQBpZA-LIGhBH1oA4skbz1mhgjeat0cAa7WUNSCNrQBxZA-LIGhBH1mjeGg2s0bw1GlijeWsiYE1U0prh-y8_AwAA__9v3mDv

# INTERSECT ALL and INTERSECT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl19v2jAUxd_3KaL71GpGwU5C20iT6FamITHogIdNFQ8p8QoSJVkSpNKK7z4R0Cj_fJIYsrdC_Ou9PtfHh7xR_GdCLvUarcaXvjGLJsbXbue78dD4ed-6bbaNi7tmr9_70bo0LtZr5qsVL_NXo9O9a3SNz7-M10uj2e43ur3lgttWCyweEKNp4Mu29yxjch-IEyNBjCxiZBMjhwaMwigYyjgOouWStxRo-i_kVhmNp-EsWX49YDQMIknuGyXjZCLJpb73OJFd6fkyMqvEyJeJN56kZcJo_OxF8_rL_JUY9UJvGrtGxVxW7swS16gLVrdosGAUzJJNhTjxniS5fMGyd9ELokRGprPdQF18_FeLs7rYqbXBH-fGyItHOzSnwWLTj8jTz3tV-EllsQrIws-pi320oc3_CSJfRtLf72KwhDOsOrC3b1486smkE5piR-D-PJTutkOI0UT-Ti7q_PJTNH4apX9tNDiqtpNhc7PpocYP9twOKkFoCmdn5eHata3aPMeBy3DeTFExrSJGBH2sT1ytNCPm0eXEwlgFhOHnVMY-2lBpVuQlWVFkH7vIMnWrYtpF7AD6WE_9qjQ75NCFn1gYq4Aw_JzK2EcbKs0OoiQ7WNnHbmWZul1Jf0vltgPoYz3169LskEMXfmJhrALC8HMqYx9tqDQ7WCXZwc4-djvL1J1KETOALtYzvynNDDlU4SeVxSogCz-nLvbRhkqzgv0f3lkOdNSVcRhMY5npjaS63JP0n-RKqTiYRUN5HwXDtMzqYyfl0i98GSerp3z1oTldPVo2-B7muzB_D9tbMM8H86oW7ejQQqu2ALWFUnFLrbiVQ3GRD95RPC_t6NBCq7YAtW2l4mBcjhIWNfW8akr6Sg1f6dhLDSN7ARpopqaRvQANal8rFb9RK36jYy81jOwFaHDE1TSyF6BBba7OEHQV792m2wkkQATtXae5MkhNwxACONq6GocxBHBUfe9S3RbeBsLv3ap5vAJoZBaEoxOrxpFdEI6qqyMFjU0dKRxkCtcKFUBDv-jFCsChX_SChauThYNo4VrZAmjoF710ATj0i16-CK18Eep8ESBfhFa-ABr5BeFo63r5gnBUXZ0vAuSL0MoXQCO_IBydWL18QTiqni9fBosPfwMAAP__geqo6Q==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) INTERSECT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEl19v2jAUxd_3KaL71GpGwU5C20iT6FamITHogIdNFQ8p8QoSJVkSpNKK7z4R0Cj_fJIYsrdC_Ou9PtfHh7xR_GdCLvUarcaXvjGLJsbXbue78dD4ed-6bbaNi7tmr9_70bo0LtZr5qsVL_NXo9O9a3SNz7-M10uj2e43ur3lgttWCyweEKNp4Mu29yxjch-IEyNBjCxiZBMjhwaMwigYyjgOouWStxRo-i_kVhmNp-EsWX49YDQMIknuGyXjZCLJpb73OJFd6fkyMqvEyJeJN56kZcJo_OxF8_rL_JUY9UJvGrtGxVxW7swS16gLVrdosGAUzJJNhTjxniS5fMGyd9ELokRGprPdQF18_FeLs7rYqbXBH-fGyItHOzSnwWLTj8jTz3tV-EllsQrIws-pi320oc3_CSJfRtLf72KwhDOsOrC3b1486smkE5piR-D-PJTutkOI0UT-Ti7q_PJTNH4apX9tNDiqtpNhc7PpocYP9twOKkFoCmdn5eHata3aPMeBy3DeTFExrSJGBH2sT1ytNCPm0eXEwlgFhOHnVMY-2lBpVuQlWVFkH7vIMnWrYtpF7AD6WE_9qjQ75NCFn1gYq4Aw_JzK2EcbKs0OoiQ7WNnHbmWZul1Jf0vltgPoYz3169LskEMXfmJhrALC8HMqYx9tqDQ7WCXZwc4-djvL1J1KETOALtYzvynNDDlU4SeVxSogCz-nLvbRhkqzgv0f3lkOdNSVcRhMY5npjaS63JP0n-RKqTiYRUN5HwXDtMzqYyfl0i98GSerp3z1oTldPVo2-B7muzB_D9tbMM8H86oW7ejQQqu2ALWFUnFLrbiVQ3GRD95RPC_t6NBCq7YAtW2l4mBcjhIWNfW8akr6Sg1f6dhLDSN7ARpopqaRvQANal8rFb9RK36jYy81jOwFaHDE1TSyF6BBba7OEHQV792m2wkkQATtXae5MkhNwxACONq6GocxBHBUfe9S3RbeBsLv3ap5vAJoZBaEoxOrxpFdEI6qqyMFjU0dKRxkCtcKFUBDv-jFCsChX_SChauThYNo4VrZAmjoF710ATj0i16-CK18Eep8ESBfhFa-ABr5BeFo63r5gnBUXZ0vAuSL0MoXQCO_IBydWL18QTiqni9fBosPfwMAAP__geqo6Q==

# INTERSECT ALL and INTERSECT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElkFv2jAYhu_7FdF3Asko2Am0RJrUamMaEoMOOEyqckiJV5AoyewgQav-9ylJESOAv3gWyTHET_za3yPxvoH8swIPpv1h_8vM2oiV9W0y_mE99n89DO8HI6vxdTCdTX8Om9bHkm2-oNHYPxNrl_-03b02rcFo1p9M0xf3w6F1flHTBwLrKOSj4IVL8B6BAgEGBBwg4AKBDvgEYhHNuZSRSJe8ZcAg3ILXJrBcx5sk_dknMI8EB-8NkmWy4uDBLHha8QkPQi7sNhAIeRIsV9k2sVi-BGJ3t929AoFpHKylZ7XsdOfxJvGsO0ruGPjvBKJN8rHD4cNPO2sRyMXxJ_eIT0AmwTMHj76T_wvbqSEsuxj28KnNOhIhFzw8-pifktiSMyf-HsjFlCfj2KaF6cx2MfeOBQICK_47aWTBm5_F8nmxfzhcQ-EODodzDA53JvkoakWxTTvFazi7t3u0Ny1vAS1hgc1atnNFaTXidmuJyy7GrUBbWqm2rPwsWJlZOC3bvaI6GnFvaonLLsatQB1WqTpO-Vk4ZWbhtrL_qGupoxH3tpa47GLcCtRxKlXHLT8Lt8wsOq0riqMRtldDWHYxbAXauLV1rDO5JlzG0VryUg2qnZ6Mh888vykZbcScP4honm2TP44zLmsAIZdJ_pblD4N1_ioNWB7umsA9E5ga5aYdNU01rozpwV0TuGcCU6PchSs7oVmRbv9LO-r7dpQwPb6zdpF2TQRXw4jgahgRXA1jgiM0InjHRHA1jAiuhhHB1TAmOEIjgndNBL8xUVQNI4qqYURRNYwpitCIorcmiqphRFE1jCiqhjFFERpRtGeiKDXqCQiNSIrQiKUIjWmK4VhXMCsLZm3BrC4Y9gWzwkCNGgM9qQxatqppzFY1jdmqplFbERyzVacsnc5Mpy3p0pitWn1JG8dsPSkPSlv9909_AwAA__-KBI1m

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) INTERSECT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v4kYUxd_7Kaz7lEiDYGYMIZYqZdVNVSSabAMPlVY8eGGaILHYtY0UNsp3rzBNABvf4_Gf7KPBP-b4-J7jMS8U_7sijya349vfps4mWjm_P9z_6Xy9_fvL-NPozrn4PJpMJ3-NL53_T3nen3Bx8XYsnO3-o-ftj0tndDe9fZjsvjh_wuWMBK2Dhbnzv5uYvK8kSZAiQZoEuSSoTzNBYRTMTRwH0e6UlxQYLZ7J6wlarsNNsvt4JmgeRIa8F0qWycqQR1P_28o8GH9hom6PBC1M4i9X6TJhtPzuR9ub5-0PEjQJ_XXsOZ3ubuX7TeI5N1LcKJq9Cgo2yWGFOPEfDXnyVZRX8XkZJ8v1POn2TyWcW-JAfds6T378dB45KFE2So79kI0aoisZIttwxC2UcvipzTqIFiYyi5MfS3-lUKzqYbEHFf22VJSw7KBiUEOFqCT0Dz9-mpjkPuzqjF_TbWi8o0L4NB6ToJX5J7lIL-Ly12j5-PR2cBi7wou7atbiu6AThF3dz9pwdu3hydrSInYlUtdVna6uUkRAx_sQDVovIhtHGrZEV7JEtuGJWyilZgnI6lXUoIoSlhVVkZ2K2lUkP7SKVPnhV2VmX3e6bpU6ADreb-RV63Vg4Yhs2BJdyRLZhiduoZSaQVTV66BBFSUsK6oDOxW160B9aB3o8sOvy8y-20nfJKzrAOh4v5HD1uvAwhHZsCW6kiWyDU_cQik1g6ir10GDKkpYVlQHdipq14H-0Dpwyw-_W2b2-50qZQBUvN_G69bLwMIP2aghupIhsg1H3EIpNUPoVq-CBlWUsKyoCuxU1K4C96f9Z3FG14OJw2Adm1L_SPR2V2YWj2bvVBxsorn5EgXzdJn94X3KpR8sTJzsv5X7g9F6_9VO4DEss7A8ht0TWNrBUtWir-vQalCH1pqnFeu45h3X7NJ9fmUelkA3T6teLfqqDq3BpLms4-Bm9y1glYUHLAwu-ooflAE_KUOWvubh6zrB5mEUbECDYPM0CjZPo2BL0KWoTPlaAdkGNAo3wFG6EQ4mHeAo35KvVInwXLtweC7jkq8XdOl8v0iQcplrGKtHME_DZzDA0UOYx-FTmMdhWvl6lUNgfK5frdLK0zCtPA7TCnA0sjwO05pr2RPjlQTbJ75lM3gurSpXNTZpVXzTKLB7U_w-BhgHaJRWhIO0AhylFeBw08yXrOoD43Mta5NWQKO0AhylFeFoZHkcpVXxW1g1BDjfshk8n1Z-F4sunW8a3QPvWrmmsUkroFFaEQ7SCnCUVoCjtGq-ZLUCxuda1uotl6fhay6Pw_dcgKMXXR5HadX8VlYj6_iWzeC5tGp-L5u99NnrL_8FAAD__yjAKic=

subtest Except

# Basic EXCEPT ALL and EXCEPT case.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT ALL (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lt9vok4QwN-_fwWZpzbfNbAL-IPkEnutlzPxak986KXhgcpeNbHCLZhIG__3i1ivRewOK8pbKfvZHWY-4-wrxH_m4IDbG_Sux9pSzLVvo-EP7aF3fze46t9qFzd9d-z-HFxqF29r0u2KVfpyqfXur3t3Y-1qMPj3eqVdubk1w9FNb6R9_aWlHhBYhAG_9Z95DM4DUCDAgIAJBCwgYINHIBLhhMdxKDZLXjOgH6zAMQjMFtEy2fzbIzAJBQfnFZJZMufgwNh_nPMR9wMudAMIBDzxZ_PsmEjMnn2RdlfpCxBwI38RO1pD35w8XCaO1mXgrQmEy-Rt-_ddH1Nt6sfT_H5dCt7aIxAn_hMHh67JcWHaimHSSmGyT8N832e5CEXABQ9yO3kbElty4Fu_-_HU5ckw0uleRcZpxJ0P9gCBOf-dXHTp5Rcxe5pmf3363e_fZKqk3g1FwoVO7f00_f_p_laJnB1Kx9umB4K4DRthpDNjP8EHj7dzx9PyZtESZumsoZtnaQGFQJvKgZ6yCWi9TUDraAIk-bsmaB7bBKx8cVmZ4poN3TqLhQqBtpQDPaWFrF4LWR0WIsnfWdg61kKzfHHNMsW1Gtk0Pr2FCoG2lQM9pYVmvRaadViIJH9nYftYC63yxbXKFNdunMVBhTA7imGe0kCrXgOtOgxEUr8zsHOKK-mB_Uc8jsJFzEvdNo1NwnjwxLcFiMOlmPA7EU6yY7aPw4zLbhkBj5PtW7Z96C-2rzYBlodbVWBKK9F2Jbojp6lCzpga3KoC7-VMlbYr0R05zfZp4yNt5mBjHzalsCWvliWFGZUfbVfpDzmM9IccxvoDoZH-QGikP5pV-kMOI_0hh7H-QGikPxAa6Y-W1NK2XNJ2lf7oVDFcDiOGy2HMcIRGDEdobAKojM3iL6nK3FSl0SGgNDmVcURzWpgiOVUpk4tO5WMEMZ0W5oiK6giNuI7QmOwYjtiO4ZjuhRmqpLucxnSX06juCI7pjuCY7oVBmte9iehemClKuhdmipLuchrTXU6juiM4pjuCY7oX5qmS7nIa011Oo7ojOKY7gmO6F6Zq_q5tyHVnhdki1d1b__c3AAD__2oDeK0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz) EXCEPT (SELECT x AS y FROM xyz) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v4kYYhe_7K6y5SlQjMx98xFKlpBuqRqIhBS62WnHhhWmCxGJqGylslP9eYQIEG79nBhvukthn5vjMex7ZeWPxfzPms0Gn2_kydJbRzPmj3_vL-db5-tS9e3h0ru4fBsPB391r5-rjntXmjtfVz2un8_VL52m4u_Tq3A0Orvf6952-8_s_zmrEXDYPJ_ox-KFj5n9jnLlMMJdJ5jLFXNZgI5ctonCs4ziM1re8pYKHySvz6y6bzhfLZP3nkcvGYaSZ_8aSaTLTzGfD4PtM93Uw0ZFXZy6b6CSYztJtFtH0RxCtbl9XP5nLBotgHvtOzVvv3FsmvnMr2OjdZeEy2S8fJ8GzZj5_d80t3E_jZDofJ17jcP9bnll_L_m-cl6C-OXI_XsPwsbD5xi4bQ5Zn3sP8qQceLVBqEIT-3WW8zCa6EhPDlZKVym0KerA5t5C41wWUFJ7C80SFtyTXP4ZxC8DnfQWnswkNVwttL8lwF23y1w20_8mV7f8-rdo-vyS_mQwXi2b8RqEUaIjT-Yi-7Vw_bZBZsfi-Fj0iInHsBYuPFXPBnx0-5uD7blFgw0K7ImaJ61RBkzsBrN5RpTZBGGfhCnMTJPg1UahCk2UJAk_EWYVWkBJFcHMzkJpmPFLwAyM1xZmuchMYSbMSyRMOiRrnrKmCTCxm4zWGWliEQS3T8KUJqZJ8GqjUIUmSlZZnEiTCi2gpIpoYmehNE3EJWgCxmtLk1xkpjSR5iWSJh1StfRjyI4mwMRuMtpnpIlFENw-CVOamCbBq41CFZooWWV5Ik0qtICSKqKJnYXSNJGXoAkYry1NcpGZ0kSZl0iZdKhRs2YJsLCbi5szssQiBm6bgylJTHPg1QahCk2UrLE6kSQVWkBJFZHEzkJpkqhLkASM15YkuchO-ZfNkfX7Ol6E81gb_Temvg5MT5715gDicBmN9VMUjtNtNr_2Ul36h4mOk81VvvnlYb65tDb4WcyzYv5ZrA7E3E7MZRm14KXUN2XUskWrBZm4pBOX5NYNemdazMF50WohyqhlvZS6TasVmXiTFjcsxCIrbpLiFn3WLVIMnrlNihUo9g1NhTrAQg4qVlyg1RAMtBySAcgRGmg5YgPPoeUweAGCz7HFBg9AjfgA5AgQQI4IgeSgLjxHmMPgUXQ0YjLyHCY4DRneBMdOYwY9Os0Z3gab50hjVXZaDctOy2HZgRyVnZbDstOUFYCygkYNmFigRmUHclR2IEdlR3Iw8YKmrABDJ-g3uIw8V3ZBo0YocOw0atCj06QRgDQiRxqbsgM1KjuQo7IjOSg7kMO3fpqyAlBW0KhBZQeURecGMInKDjCJyg7kaOJpykowNZL-QM7Ic2WXNGokeKGTNGrAo0uaNBKQRuZIY1N2oEZlB3JUdiQHZQdyVHZJU1YCykoaNegrH1AWnRvAJPrOB5hEH_pAjiaepqxEx05_NWfk-bLTqFHghU7RqMk--uj9l_8DAAD__0CZB6Q=

# EXCEPT ALL and EXCEPT with MergeJoiner.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT ALL (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l99P-kgUxd_3r2juk-ZbUmbaojbZBFfZhATFBR7cGB4qnUUSpN1pSUTD_77hR5bfczpM6ZvAfLi3594zR34o_XdMAXUbrcZDz5rKsfVnp_1kvTVeX1r3zWfr6rHZ7XX_al1bV-szs9WJr9m31e48NjrWH39bs2ur8frQeOlZ960WONknmyZxJJ7DT5FS8EaMbOJkk0s2eWSTT32bEhkPRJrGcnHkZwk0oy8KqjaNJsk0W7zdt2kQS0HBD2WjbCwooF74PhYdEUZCOlWyKRJZOBovyyRy9BnKWf1r9k02dZNwkgZWxVlUbk-zwKpz6s9tiqfZ5uvTLBwKCtjczt9CN5aZkI6_W73Ofu19_YZ4n1kfYfqxD1B_vmmB67SwrQIrTgb3DBlYwTp4J3vYfE8sIyFFdLRwrlNHHudJyKHoiqydOHxP0d4sEcHW_pNNY_FPdlVnv65_l6Phx-rP_wVmJwX2czzcdHKs8aM9P8eVOHG4v3fyeO3aTm2msWA59svhFcfVNhpoYr1htUsaTUeHIoVwzxCCFayEd7KH8qzGyrEazz9mnmfKbsXxtNcdNLGe8s0l111DB1akEO4ZQrCClfBO9lDeuvNy1t3NP2Y3z5S9yvLfHb11B02sp3x7yXXX0IEVKYR7hhCsYCW8kz2Ut-5uOevu5R-zl2fKfkV72UEL6xnfXXLZNVRgxcngniEDK1gH72QP5a26V_5vhiMddUSaxJNU5PpFUF08k4iGYqVUGk_lQLzIeLAss3rZXnLLNyKRZqtP2epFc7L6aNHgNsz2YbYNezsw04NZ1Yj2TWhuVJuD2lypuKtW3NVQnOvBe4rr0r4JzY1qc1DbUyoOxuUrYV5Tz6umpG_U8I2JvdQwsheggWZqGtkL0KD2rVLxO7Xidyb2UsPIXoAGK66mkb0ADWozdYagq_jgNt1NIA4i6OA61cogNQ1DCODo0dU4jCGAo-oHl-qu8B4Q_uBW1fEKoJFZEI42Vo0juyAcVVdHChqbOlIYyBRmFCqAhn4xixWAQ7-YBQtTJwsD0cKMsgXQ0C9m6QJw6BezfOFG-cLV-cJBvnCjfAE08gvC0aOb5QvCUXV1vnCQL9woXwCN_IJwtLFm-YJwVF0vX_rz3_4LAAD__9rcgk0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY y) EXCEPT (SELECT y FROM xyz ORDER BY y)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYcBfD3fgprnhKtEcyFm6VKbDdUisSGFHjYasUDC9MEicXUNlJIlO9ecek6eOz_8Ribt1x87L-PPT8NvLHw3xXz2Lg_6H-ZONtg5fw5Gn51vve_PQ4-3z84N3f348n4r8Gtc3M6Znc84mX36gxHd_2R88ffzu7W6X_70n-cgKOmzGVrf6EfZj91yLzvjDOXCeYyyVymmMuabOqyTeDPdRj6wf6Qt0PgfvHCvIbLluvNNtr_eeqyuR9o5r2xaBmtNPPYZPZjpUd6ttBBvcFcttDRbLk6XGYTLH_Ogl3vZffKXDbezNah59Tq-ysPt5Hn9ASbvrvM30bx6cNo9qSZx9_d_COM_SDSQb15fvUe_5R5emFz-rtlGC3X86jOG8kr7O8kWOhALzynxxOXi8_wY-c8z8JnIz19j0eSNiN9LJ03S2tdFWhdGKVk194sVLswHmyJtbcyR4rP4x-vlXaf1NzS7nWJZ2pXOJNdl_FMnRwzbddpU033SXRIysxfdfCkxzoabuoq0eRkt9He__Z9HgyYy1b6n-imxz_d_h4sn56PP_5647Nvq3vBbaXM_ODX_E1dNZMFpBvXOLs4t1jyOVZ8XdTq0lpaMMRpzbeKSgtOH0vLryatTe2tEntXBXoXRi15rc1bvDAebWXW8lJds3thsqwtdya7LrOsTZ-pOmv5dawV-dedyLPsZK2urLkDQ5yWXbsod-D0MXfiatxZ1M7bJfauCvQujFrycpe3eGE82sq4E6XSYvfCZHFX7kx2XWZxlz5TddyJ63An8687mWfZqdrh864dd2CI07LrFOUOnD7mTl6NO4vaeafE3lWB3oVRS17u8hYvjEdbGXeyVFrsXpgs7sqdya7LLO7SZ6qOO3kd7lT-dafyLLtmzRo7MMJp0XWLYgdOH2OnroadRem8W1rrqkDrwiglL3V5axfGg62MOlUqK3avSxZ15c5k12UWdekzVUeduv6XhikTjXS48dehzvWVYGN_T3rxpI8dhf42mOvHwJ8fLnP8dXjIHf6w0GF0_C8__nK_Pv5rP-DHMCfDgg6LZJh_DLfOwtwuzC9Ki-YlaakuSStJpyXZuKIbV2S4SYeb5Nxtemw6zC9KC_Cw6bQED5tOK_CwW2TjHTrctgiLZLhDhrv0lbv0W9YCKgBTECq0Khywwi9yBaQRLCCOZAFxRAuII1s4jQsHunCaFw584RcBA9JIGBBHxIA4MgbEETKcVoYDZjjtDAfQ8Iuk4TQ1ogH2EDQ1AlAjDGqs9iB0Gm5C6DjchdBxuA2h48gKYVBzXrwExdPUCECNMKixsQKkkRUgjqwAcWQFiCMrhEHNefHo3mlqEnHDCkFTA6wQtDSiC14amhoJqJEGNTZWgDSyAsSRFSCOrABx-JmF3tBJsKGTNDUSUCMNamysAGlkBYgjK0AcWQHiyApJb-gkGp6mJhE3rJA0NcAKSUsjO-CloamRgBppUGNlBZ2GVtBxaAUdh1bQcWSFojd0CmzoFE2NAtQo-gMUWOwgjawAcWQFiCMrQBxZocAXU-jqNDWJuGGFoqlJWjF9_-2_AAAA__8yWV-Q

# EXCEPT ALL and EXCEPT with no overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT ALL (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lm9P4kwQwN8_n2IzrzTPkna3LX-amOijNZLwgAck58XjRaV7QoK0ty0JaPzulxY5heJOl0rfid1fh5n5DbMvEP-egQsDr-NdDslCzsh1v_c_uffubjsX7S45uWoPhoNvnVNy8nZmuT6xXD2T7zde3yNL8nNhmtaY8FPi3V16t0Ny0emg58VZCvT6V16f_PeDLEdAYR4Gous_iRjce2BAgQMFCyjYQMGBEYVIhmMRx6FMj7xkQDtYgmtSmM6jRZL-e0RhHEoB7gsk02QmwIWh_zATfeEHQhomUAhE4k9nWZhITp98uTpfrp6BwiDy57FLakYa-Xo6S4R0yTn7m6Lruu3usAkUeoskfQKjVwrhInmL_R7yYUUmfjzZDpadH1GIE_9RgMte6WE5OAfnkJb9a5Pgnybx_p7FPJSBkCLYetMoJbEjeypx48eTgUh6kcF2mjlcRcL9YCFQmIlfyck5Oz2T08dJ9teneb_nZOk0ZhDKREiDObtl-vfT99sFaravHG8v3fMlumEtjAxu7hZ4b3hnKzwr7h0r4J3Ba4ZV_fRoZFEvkcWx54dVOz-sivlBWrOZn_qh88OLt54Xab1VM-zqBdbIolEii2MLzKsVmFchMNKajcCNQwW2irfeKtJ6u5bdECoWWCOLZoksji2wVa3AVhUCI63ZCNw8VGC7eOvtIq13atXrq5FD6-Acji2vXa28dhXyIo3ZyNv6iuv3nvf3RRyF81gUulmbacFE8CjWDYjDhRyLWxmOszDrj72My65FgYiT9VO-_tCerx-lX7A43CgDM1aKdkrRLTXNNGrG9eBGGXinZrq0U4puqWm-S5sfaWsLNndhSwnb6m7ZSpgzdWinzHyoYWQ-1DA2HwiNzAdCI_NRLzMfahiZDzWMzQdCI_OB0Mh8NJSWNtWSNsvMR6uM4WoYMVwNY4YjNGI4QmMbQGdt5n9JdfamLo0uAa3NqY0jmrPcFtlSlXG16Ey9RhDTWW6P6KiO0IjrCI3JjuGI7RiO6Z7boVq6q2lMdzWN6o7gmO4IjumeW6TbutcR3XM7RUv33E7R0l1NY7qraVR3BMd0R3BM99w-1dJdTWO6q2lUdwTHdEdwTPfcVt2-a5tq3Xlutyh1H73-8ycAAP__vDHOWQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz WHERE x < 2) EXCEPT (SELECT x FROM xyz WHERE x >= 2) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgYhe_3V1hzlWiNYD74iKVK6TZURWJDFpC2qy4XFGYTJIpZ20jQKP-9AgIEjN8z4zG5S8Bn5vjMex7ZPLP4_ykLWK_Zbn7qe4to6n3udv70vjW_PrQ_tu69q7tWr9_7q33tXb1es9xesVz99P7-0uw2vaX376JSkSNPXHvNr5-aD314rf6wvrjTvWt2vT_-8ZYD5rNZONb3wx86ZsE3xpnPBPOZZD5TzGdVNvDZPApHOo7DaH3J80bQGi9ZUPHZZDZfJOuPBz4bhZFmwTNLJslUs4D1h9-nuquHYx2VK8xnY50MJ9PNNvNo8mMYrW6Xq5_MZ735cBYHXqm83vnzZJroKPBu-f72giBo3fcbzGedRbL-hg1efBYuksPecTJ81CzgL765v7tJnExmo6RcPTaXWv8g-b7ynobx05nrDx6EjYe3GfH8Ia3P1TwlmSslXmxMKtPEYZ3FLIzGOtLjo5U2q2TaFBVg82CheikLKKmDhZqDBT-Xyy_D-Kmnk868LE-S6q_mOtiR5GO7zXw21f8lV7f8-kM0eXza_GUwXnWb8eqFUaKjskxF9nvm-g2DzM7F8broGRP3YSmcl1XlNOCz298cbc8t-m1Q77IolWWxFAQO91NbuyAFbVJyicmFg6Y58WKDUpkmHCHEc3KwQAsoqSwO2llw5iB_Dw6C8dpxMBWZKQeFecWEScNkqayKBRFwuB-b-gVBZJESd4nJBUSmOfFig1KZJhwpIHKCqEALKKksENlZcAaReA8QgfHagSgVmSmIpHnFpEnDVGnzglYgiIDD_dg0Lggii5S4S0wuIDLNiRcblMo04UgBmRNEBVpASWWByM6CM4jke4AIjNcORKnITEGkzCumTBpWLRWLIeBvPzQ3F8SQRUY8f0guEDJNiRcbk8o04UgAlRNCBVpASWVByM6CM4TUe0AIjNcOQqnI8vw8dWb9ro7n4SzWRr88VdaB6fGj3h5AHC6ikX6IwtFmm-2_nY1u88FYx8n2W779pzXbfrU2-FbMT8X8rVgdibmdmEsXteBO6hsXtazTakEmLunEJbl1ld6ZFnNwXrRaCBe1rDipG7RakYnXaHHVQixOxTVSXKfPuk6KwT03SLECxb6hqVABWEhBxYoLtBqCgZZDMgA5QgMtR2zgKbQcBy9A8Cm22OABqBEfgBwBAsgRIZAc1IWnCHMcPIqORsyJPIUJTkOG18Cx05hBt05zhjfA5inSWJWdVsOy03JYdiBHZaflsOw0ZQWgrKBRAyYWqFHZgRyVHchR2ZEcTLygKSvA0An6Ce5Eniq7oFEjFDh2GjXo1mnSCEAakSKNTdmBGpUdyFHZkRyUHcjhUz9NWQEoK2jUoLIDyqJzA5hEZQeYRGUHcjTxNGUlmBpJvyCfyFNllzRqJHigkzRqwK1LmjQSkEamSGNTdqBGZQdyVHYkB2UHclR2SVNWAspKGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasRMdOvzWfyNNlp1GjwAOdolFzeuuDl99-BQAA__9VD11Q

# EXCEPT ALL and EXCEPT with some overlap.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT ALL (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzElt9u2jAUh-_3FNa5KlpQYifhT6RKdG2qIjHoAGmdulykxCtIlGROkKAV7z4BZRRCfWJS0rtS8tk5Pt-P4xeI_47BgZ7bci_7ZCrG5Lrb-U7u3bvb1kWzTc6umr1-70erRM5en5mvn5jNn8nPG7frkhn5PTUMk58TWiLu3aV72ycXrRYKDIhZIp3uldsl336RuQcaTMKAt_0nHoNzDxQ0YKCBCRpYoIENngaRCAc8jkOxfORlBTSDGTiGBqNJNE2W__Y0GISCg_MCySgZc3Cg7z-MeZf7ARe6ARoEPPFH49U2kRg9-WLemM2fQYNe5E9ih5T15c7Xo3HChUMadFui4zjNdr8GGnSmiUMaDLyFBuE0ed18u-fDnAz9eLi7W4OCt_A0iBP_kYNDF9pxRdhHFzEg5sfWwN6tYbvOdBKKgAse7KzkLUnskQMHcePHwx5POpFO95rZn0fceSMhaDDmf5KzBi2di9HjcPXX_7rpXt3bmkyVvvRCkXChU3v_mL6-u76V4cwOHcfrogdeoh2Ww0hnxv4BH9ze3tmeZteOZtBOZ2Xd_IT0KJRRyVHGifNDi80PLSI_SGc2-akcmx-WvfMsS-fNsm59gsAKZVRzlHFigVmxArMiBEY6sxG4eqzAZvbOm1k6b5VXF4SiBVYoo5ajjBMLbBYrsFmEwEhnNgLXjhXYyt55K0vn7fIn6KtQRP3oIk4sr1WsvFYR8iJ92chb_4jr94H1uzyOwknMM92sjeWB8eCRrxsQh1Mx4LciHKy2WX_srLjVtSjgcbL-lq0_NCfrr5YvmB2u5oEpzUXbuei6nKYKZ8bU4GoeeO_MVGk7F12X02yfNt7S5g5s7MOmFLbk3bKkMKPyre08-ZDDSD7kMJYPhEbygdBIPip58iGHkXzIYSwfCI3kA6GRfFSlltbkktby5KOex3A5jBguhzHDERoxHKGxCaAyNtO_pCpzU5VGh4DS5FTGEc1paorsqEqZXHQqHyOI6TQ1R1RUR2jEdYTGZMdwxHYMx3RPzVAl3eU0prucRnVHcEx3BMd0Tw3SXd0riO6pmaKke2qmKOkupzHd5TSqO4JjuiM4pntqnirpLqcx3eU0qjuCY7ojOKZ7aqru3rUNue4sNVukunuLL_8CAAD__7KvzmY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz WHERE x >= 1) EXCEPT (SELECT y FROM xyz WHERE x < 3) ORDER BY y]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mF1v2kgYhe_3V4zmKtEawXzwEUuV6DZURWJDFpC2qy4XFGYTJIpZ20ihUf57BQQINn6PhzG5S8DHc-bMex7ZPPPo_xn3eb_VaX0asGU4Y5973T_Zt9bX-87H9h27um33B_2_Otfs6vWa1faKp9VP9veXVq_Fnti_y0pFmQ9MXLPW10-t-wG8eMzUNev2bls99sc_bDXkHp8HE3M3-mEi7n_jgntcco8r7nHNPV7lQ48vwmBsoigI15c8bwTtyRP3Kx6fzhfLeP3x0OPjIDTcf-bxNJ4Z7vPB6PvM9MxoYsJyhXt8YuLRdLZZZhFOf4zCVfNp9ZN7vL8YzSOflcrrlT9PZ7EJfdYUh-35vt--GzS4x7vL2GdNyYcvHg-W8WHxKB49GO6LFy-_wdtpFE_n47hcPXbXFIn7HyTfV-xxFD2euP7gQdp4eBuSOD-lMVP5Q1JnhSSKTUlnmjjcZzkPwokJzeToTpu7ZNqUFWDzYKF6KQsoqYOFmoMF7yyXX0bRY9_E3UVZJZIarBbG34HkY6fDPT4z_8VXTXH9IZw-PG7-2o9X9p7qNuPVD8LYhGWViuz3zPs3cmR2Ko7Xm54wcReUgkVZV5IBn1z-5mh5YVHvHO0uy1JZFUxBYHE_trULUtAmJpecHDiYNyZRbE4604QjhMSZHCzQAkoqi4N2Fpw5KN6Dg2C8dhxMRZaXgzJ_w2SegqlSWRcMImBxPzf1C4LIIibhkpMDiPLGJIrNSWeacKSAPBNEBVpASWWByM6CM4jke4AIjNcORKnI8oJI5W-YylMwXdq8nxUJImBxPzeNC4LIIibhkpMDiPLGJIrNSWeacKSAOhNEBVpASWWByM6CM4jUe4AIjNcORKnI8oJI52-YzlOwaqlgDAGD-6m5uSCGLEIS56fkAKG8IYliU9KZJhwJoM-EUIEWUFJZELKz4Awh_R4QAuO1g1AqsnN-njpx_56JFsE8Mrl-eaqsAzOTB7M9gChYhmNzHwbjzTLbf7sb3eaDiYni7bdi-097vv1qbfCtWCTF4q1YH4mFnVgoF7UUTuobF7Wq02pJJq7oxBW5dJVemRYLcF60WkoXtao4qRu0WpOJ12hx1UIsk-IaKa7TZ10nxWDPDVKsQbFvaCpUABZSULHiAq2GYKDlkAxAjtBAyxEbRAotx8FLEHyKLTZ4AGrEByBHgAByRAgkB3URKcIcB4-ioxGTkKcwIWjIiBo4dhozaOs0Z0QDLJ4ijVXZaTUsOy2HZQdyVHZaDstOU1YCykoaNWBigRqVHchR2YEclR3JwcRLmrISDJ2kn-AS8lTZJY0aqcGx06hBW6dJIwFpZIo0NmUHalR2IEdlR3JQdiCHT_00ZSWgrKRRg8oOKIvODWASlR1gEpUdyNHE05RVYGoU_YKckKfKrmjUKPBAp2jUgK0rmjQKkEalSGNTdqBGZQdyVHYkB2UHclR2RVNWAcoqGjXoLR9QFp0bwCR6zweYRC_6QI4mnqasQsdOvzUn5Omy06jR4IFO06hJbn348tuvAAAA__-0tF1d

# EXCEPT ALL and EXCEPT with swapped column orders.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT ALL SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEll1v2jAUhu_3K6xz1UpGwU6gJdIkqo5pSKx0hYtKVS5S4hUkSjI7kUir_vcpSbuWj_nEM2SXIXns1z6PxPsM6tcSfJgMRoPLKcnkkny9GX8nd4Pb69HF8IqcfBlOppMfo1Py-smakrz6Zp0_kcHt5eB6Si5Go7f3OSXrP-8DoLCKI3EVPgoF_h0woMCBggsUPKDQgYBCIuOZUCqWxSfPJTCM1uC3KSxWSZYWPwcUZrEU4D9DukiXAnyYhvdLcSPCSEinDRQikYaLZblNIhePocz76_wJKEyScKV80nKKncdZ6pM-o30OwQuFOEtfd3hf-D4n81DNN5d8QwIKKg0fBPjshf5b2I5hWE77zDYs_2vY96WyVSwjIUW0sVhQkNgne078LVTziUjHicO2pjPNE-F_UAcoLMXP9KRMffpZLh7mbw-6gb0fzrU43J7kV3ErThzW2b6GvXt7G3uz-hawGhY4vOW4R5TWIG7XOO7htWXNassa1ZbXnwWvMwu35XhHVMcg7plx3MOrw5tVhzeqjlt_Fm6dWXit8j_qWOoYxD03jnt4ddxm1XEbVcerPwuvziw6rSOKYxC2Zxj28Np4zWrj_beOtSfXjVBJvFKiVoNqFycT0YOobkrFmZyJaxnPym2qx3HJlQ0gEiqt3vLqYbiqXhUB68NdG7hnAzOr3Kyjp5nBlXEzuGsD92xgZpV768p2aL5Ntz_Srv6-XS3MNu-svU17NoLrYURwPYwIrocxwREaEbxjI7geRgTXw4jgehgTHKERwbs2gp_ZKKqHEUX1MKKoHsYURWhE0XMbRfUwoqgeRhTVw5iiCI0o2rNRlFn1BIRGJEVoxFKExjTFcKwr2JUFu7ZgVxcs-4JdYWBWjYHtVAYjW_U0ZquexmzV06itCI7ZalKWdmdm0pZMacxWo75kjGO27pQHra3By6ffAQAA__-YZoZN

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x, y FROM xyz EXCEPT SELECT y, x from xyz]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv2kgUhd_3V1j3qZUGwcwYQiytlKpltZHYJBt4qFTx4MJsgkQxaxsJGuW_rzAbCHZ8z4yN00cwn-f4-J7jMU-U_LuggEaD4eDz2FvHC--P-9u_vG-Dr3fDT9c33ocv16Px6O_hR-__n2yEt93_ZrP96Q2-fh7cjV-ObYW3ORybkKBlNDM34Q-TUPCNJAlSJEiTIJ8EdWkiaBVHU5MkUbz7yVMGXM82FHQEzZerdbr7eiJoGsWGgidK5-nCUEDj8PvC3JtwZuJ2hwTNTBrOF9kyq3j-I4y3V5vtTxI0WoXLJPBa7d3Kt-s08K6kuFI0eRYUrdPjCkkaPhgK5LOwV_FlnqTz5TRtd08lvLXEkfq-9R7D5PFt5KhEuSh57Yd0NUSJK1lqiK5kiGzCEb9UyvFU62UUz0xsZicny85SKlZ1sNijim5TKiwsO6ro1VAhKgn9M0weRya9XbV1zq_xdmWClyr4NBySoIX5J_2QXcHH3-P5w-PLB7sQXpzX4puoFa3aupu34c21-ydrS4fYWaSurVptXaWIgI7DEPUaLyIXR9wtcagiW0tkE574pVJqloCsXkVnVGFhWVkVuamoXUXyXatI2Q-_spl93Wr7VeoA6DjcyIvG68DBEeluiUMd2Foim_DEL5VSM4iqeh2cUYWFZWV14Kaidh2od60DbT_82mb2_Vb2JuFcB0DH4Ub2G68DB0ekuyUOdWBriWzCE79USs0g6up1cEYVFpaV1YGbitp1oN-1Dnz74fdtZr_bqlIGQMXhNl42XgYOfkhXQxyqwNYQ2YQjfqmUmiH0q1fBGVVYWFZWBW4qaleB_8v-s3hD171JVtEyMVb_SHR2V2ZmD2bvVBKt46m5i6Nptsz-423GZV_MTJLuj8r9h-vl_tBO4GtY5mH5GvZPYOkGS1WLvqxDq14dWmueVqzjmndcs0t3-ZV5WALdPK06teiLOrQGk-azjoOb3XWAVR7usTC46At-UHr8pPRZ-pKHL-sEm4dRsAENgs3TKNg8jYItQZeiMuVrBWQb0CjcAEfpRjiYdICjfEu-UiXCC-3C4YWMS75e0KXz_SJBymWhYZwewTwNn8EARw9hHodPYR6HaeXrVfaB8YV-dUorT8O08jhMK8DRyPI4TGuhZU-MVxJsn_iWzeGFtKpC1bikVfFNo8DuTfH7GGAcoFFaEQ7SCnCUVoDDTTNfsqoLjC-0rEtaAY3SCnCUVoSjkeVxlFbFb2FVH-B8y-bwYlr5XSy6dL5pdAe8axWaxiWtgEZpRThIK8BRWgGO0qr5ktUKGF9oWae3XJ6Gr7k8Dt9zAY5edHkcpVXzW1mNrONbNocX0qr5vWz-0ifPv_0XAAD__6dTIw4=

# EXCEPT ALL and EXCEPT with different ORDER BY types.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8mE1v2kAQhu_9FdacgmJkdmwgWKpEmlAViYYUOKSKODh4G5AIdm0jQSL-e8WHCtjxzg4I3_jY1zt-vM_swgfEf6fgQr_Vad0NjHk0Nb73uj-N59bTY-e2_WBc3bf7g_6vTsm42o1ZbEcslu9Gt3ff6hnffhvLktF6ums9DozbTuf_yKVx2_90-Htp_3oxBBNmgS8fvDcZg_sMAkxAMMEGExwwoQpDE8IoGMk4DqL1kI9NoO0vwK2YMJmF82T98dCEURBJcD8gmSRTCS4MvJep7EnPl5FVARN8mXiT6WaaMJq8edGyuVi-gwn90JvFrlG21jN354lrNIXZRBiuTAjmyX6GOPFeJbhiZepX0Q-iREZW9biAJl6r5trHX5bG2IvHqbSA4WpfD3LqOaQiuFjQbNq5WOwTsIhLcnFyC9pfJ4h8GUk_W8VwHdYY9cm9_fDicV8m3dDCFODBMpTugS5gwlT-Sa6aovQ1mryON6_2AHJRV09AjWnU4jr3-rWTyYkcJg9BOQgt-5hH3vT1o-kFY0FrrGcLy5Z9iuhEHTvMtcJE53Dhg2GorgdGXJKMk1tQYaqLIlTXQ41p1Nqqo_6aQp0lZZct5xTXiDp291kvzDUGF8EHw3BND4y4JBknt6DCXMMiXNNDjWnU2q7Z-mvK1llSTnlzymS7RtSxu8-bwlxjcBF8MAzX9MCIS5JxcgsqzDW7CNf0UGMatbZrjv6acnSWVLV8imlEFbu7bBRmGoOK4GJheKaHRVySi5NbUGGeOUV4poca06hP-qn4yfV7Mg6DWSy1fgVW1sCk_yq3jyEO5tFIPkbBaDPN9m13k9t84Ms42X4rtm_as-1X6wIPwyIdFodh5ygseGEhzkrXz0mjfVa6oU6jkritJm4ziCMvnCLOTdfPSaeIc9MNddpREq-qiVeV4Zr6WdfUz5rQq65M36jDN-e4qQ5TbhJpwk11mnKTSBNuNtTdsEK0w0wz5dhJpCk9qTjhJxGnBKXihKEi01KPwSMBXt1TCUlFprscT-4Qk2faC2sXVKfJbZCIU_ugOk5uhEScsE2oe6uoEeAz3ZWlmzpN6kbEKd3UcVI3Ik7ppt5ZBLG1iEyTZemmbrJINFnkNNns4YvVZNlxQjciTulGxamDp7rJItFkMdNkOboRaUo3Kk7oRsQp3ag4oRuqNxgkNhhUn18J3VDdZJFosshpstnJWU2WHad0YzVZdpzSTd1kkWiyyDnAZ5cc6wTPjlO6sc7w7Dilm3qDsYkNxlb_JZLWbbj68i8AAP__xbWq6Q==

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT y AS x FROM xyz ORDER BY z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82F1v4jgXB_D751NEvmo1QeBjhxakR6I7ZbWVum23cDGrERcMeFskhrBJkKBVv_uKl92UGPy348BdX_KPT86xfwq8s_TvKWuzXve--7UfLJJp8Ovz4-_B9-63p_ubu4fg4vau1-_9cX8ZXOyuWW6vWK7egsfn2-5z8Mufweoy6H772n3q_3fVKrjpHbz07TL_eTlgIZvFY_Uw_KlS1v7OOAsZsZAJFjLJQhaxQcjmSTxSaRon60veN4G78ZK1GyGbzOaLbP3nQchGcaJY-51lk2yqWJv1hz-m6lkNxyqpN1jIxiobTqabZebJ5OcwWXWWqzcWst58OEvbQa2-XvlxkbWDDg87xAYfIYsXWb5Cmg1fFGvzj9C-il6cZCqpR_sFdOiL3VrkstbtJM0ms1FW54Xn7fB8tcJSefrHKngdpq9acvCRlyNcyvk8AB45ToDCjjjaFVliAlTsie0IolIjoOLEqxpB82g5-X0WszgZq0SN9-60ucvRgoW-Z4515OpUJeg9O1bCtUcJYakqfxumrz2VPc7rstCp_mqu2v8CeHN_z0I2VX9lFx1--f9k8vK6-eno9PNnapXY1VJr2ZfjbjUsmnaoH7u7HqjiIa7F83rUKHb48Pr7cHIHPSzwqFOtLsoADurYNbpZCeBgrRxwfhbAXUbQdJ6BA-F2M6BiV8oRbjsEKs78NITz6vzUd40d4RWWoPfMjnC3ErwJ5-cg3G5XS61l1oST_fklm-MranVZhlBQx-5BryohFKyVE0pnIdRhBPzKeQYOhNrNgIpdKUeo7RCoOPPTEErV-aXvGjtCKyxB75kdoW4leBNK5yDUbldLrWXWhAr78ytsjq-sbT7rOxMK6tg96HUlhIK1ckLFWQh1GAG_dp6BA6F2M6BiV8oRajsEKs78NISK6vzSd40doRWWoPfMjlC3ErwJFecg1G5XS61l1oRK-_MrbY5vVCsDKKhi95itSgAFa-WAyrMA6jAA3nKcgAOfdhOgYk_K8Wk7AipO_DR8yurs0veMHZ8VlqD3zI5PtxK8-ZTn4NNuV0utZaW-hz2wwLNK5_EsVVZfsTbWHVPjF7WdQBovkpF6SuLRZpntr4-b3OYPY5Vm2__y7S93s-2_1gV-DnNjmMxhKob553BzL8zdwvzKJ01eaeGVliAtjB2X5o5LYzgyhyNj3aBsc5hf-6TJKy280hKkm8aOg_CVQ5iK4WtjuGWedcuMQsNcNzebEiFUzKpwwArXDth-XIC4dsJcWAJp5BKII5hAHMkE4ogmbuaFA1-4dtL2400Q146ai08gjYACcSQUiCOiQBwZxc3O8BaIm6UpxDWnuNkaaoCXCPD-Aqgi8AaDXmHM1hCwhrysAWn4DuRnDYjDtyA_a8hsDQFryGwNAWvIyxqQRtaAOLIGxJE1II6sIbM1BKwhszUErCGzNQJYI_ysEWZrBLBGmK0RwBrhZQ1II2tAHFkD4sgaEIcfuczWCGCNMFsjgDXCyxqQRtaAOLIGxJE1II6sEWZrBLBGmK0RwBphtkYCa6SfNdJsjQTWSLM1ElgjvawBaWQNiCNrQBxZA-LIGmm2RgJrpNkaCayRXtaANLIGxJE1II6sAXFkjTRbI4E10myNBNZIszURsCZytGbw8b9_AgAA__-sH1Hp

# EXCEPT ALL and EXCEPT with different numbers of ORDER BY columns.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT ALL (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmFFv6jYcxd_3KaL_U6sapbYDtJEmcXcv0yqx0gEPd7riIbfxWiRKsiRI0KrffSIgUeLhYwc1vBXIwc4v_h2bvlH-75xCGvcH_a8Tb5nNvd9Hwz-9H_3vD4Mvd_fexbe78WT81-DSu9hds9pesVq_esPRt_7I--1vb33p9b9_7T9MvC-DgflK5r1e7l-upsRokcTqPnpROYU_iBMjQYwkMQqIUZumjNIseVR5nmSbS97KwF28ovCa0WyRLovN21NGj0mmKHyjYlbMFYU0iX7O1UhFscr8a2IUqyKazcth0mz2EmXr3mr9SozGabTIQ6_lb0YeLovQ63HWEzR9Z5Qsi_0IeRE9KQr5O7OfxTjJCpX57cMJ9MSVaax9_Ofae47y50qa0_R9Px_hMp-PVHgdLKwnj5KRNchwHQ3rySswphuh4Oi89t-TZLHKVKw_p-kmjK4qp1wOWb3NP6L8eayKYeqLCu7JOlXhB3WI0Vz9U1z0-OWv2ezpufxrz-Eo9XYN6qJKnV8d_f5ObXr8CJP7pJWkvjzkcWz47sHw3GF5W6xuX7R8WUd7MI8d5k5j2rtwqQfGXnw7NlyH88ni83OJz5sQ3466qFK3Fl_YrzBhs8Bkyw_qmAfmsbvPbmPmOXDh9cDYm2fHhutwPtk8cS7zRBPm2VEXVerW5kn7FSZtFljQKs-jzuaBeezu86Yx8xy48Hpg7M2zY8N1OJ9snjyXebIJ8-yoiyp1a_MC-xUW2CywdquOd2AWu7u8bcw7Byq8DhZ76-zIcB3NJ1sXnMu6oAnr7KiLKvVaPzH_5_tHKk-TRa6sfj1eb4Cp-EltH0WeLLNH9ZAlj-Uw25fDMle-Eau82H7Kty_uFtuPNhP8GObVMP8YDg7C3C3M-Unp7ilpIU9K35rTwkhcmolLB-LCLVwh7prunpKuEHdN35rTgZF420y8bQx3zM-6Y37WQK-uMX1jDt-c4qY5jNwEaeCmOY3cBGng5q25Da9BHWpl6mInSCM9URz4CeJIUBQHhnKtUg_BCwDe3KlAUq61y-HgARhcqxenXdCchtsgiKN90ByHGyGIA9u4uVt5B4DX2tVJN3Ma6gbiSDdzHOoG4kg3887CwdbCtZJ10s1csgKUrHApWf3w5VSyznGgG4gj3VAcHTzNJStAyQqtZF10A2mkG4oD3UAc6YbiQDdh3mAE2GCE-fwKdBPmkhWgZIVLyeqDO5Wscxzp5lSyznGkm7lkBShZ4XKA15ec0wneOY50czrDO8eRbuYNRoINRpr_JVLVbfr-y38BAAD__8kDuHE=

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT x FROM xyz ORDER BY y) EXCEPT (SELECT x FROM xyz ORDER BY y, z) ORDER BY x]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82N9u4kYUBvD7PoU1V4liBHNmTAJSJbYbqkZKkzTkYqsVF2yYJkgspraRQqK8e8WfysETzjf2GO6W4M9zfM7MT17eRPrvVHTFoH_d__oQLJJp8Pv97Z_B9_63u-svVzfByeXV4GHw1_VpcLK95mVzxcvyNbi9v-zfB7_9HSxPg_63r_27B_6qMHg9zT--DEUoZvHY3Ix-mlR0vwspQkEiFEqEQotQRGIYinkSP5o0jZPVJW_rwNX4RXRboZjM5ots9edhKB7jxIjum8gm2dSIrngY_ZiaezMam6TZEqEYm2w0ma6XmSeTn6Nk2XtZvopQDOajWdoNGs3VyreLrBv0ZNgjMXwPRbzI8hXSbPRkRFe-h-5VDOIkM0kz2i2gR2dua1GZtS4naTaZPWZNWXjensxXKyyVp38sg-dR-mwlh-95OapMOR8HIKMKEwh7am9jdIUhULEtdBb21JnzmlGlYVBx9nUNo723nPw-i1mcjE1ixjt3Wt9lb8HK3j37OnJ-qBLsnu0r4cKjhLBSlX-M0ueByW7nTV3o1MNybrr_Q_jl-lqEYmr-yU568vTXZPL0vP7X3unnz9SpsLm11bKz_YK1HJr2WT-2d_2kipu4Ec-bUavY4c_X3yVUlnDEgZEmNZqqCuWgjm2j27VQDtbKKZdHobzMCNqVZuCOudsYqNgYL8xdx0HF6R8Gc1mfpPb-ccO8xhLsnrlhXq4Eb8zlMTB329zaapkz5uR-ksnlIKtGU1fBFNSxfdDzWjAFa-WY0lEwLTECeV5pBu6Yuo2Bio3xwtR1HFSc_mEwpfoks_ePG6Y1lmD3zA3TciV4Y0rHwNRtc2urZc6YKveTrFwOsm6sfwkojSmoY_ugF7VgCtbKMVVHwbTECORFpRm4Y-o2Bio2xgtT13FQcfqHwVTVJ5m9f9wwrbEEu2dumJYrwRtTdQxM3Ta3tlrmjKl2P8na5SBHjSqUgiq2j9mphVKwVk6pPgqlJQYgOxUm4A6p2xCo2BYvSF2HQcXZHwZSXZ9i9u5xg7TGEuyeuUFargRvSPUxIHXb3NpqWaXfaz9Z4N6k83iWGqefYlurjpnxk9lMII0XyaO5S-LH9TKbj7fr3PoPY5Nmm2_l5sPVbPPVqsCPYcmGiQ9TMSw_hts7YVkuLM990uSVVl5pDdKK7bjmO67ZcMSHI7ZuUDYflhc-afJKK6-0Buk223EQPi8RpmL4gg13-Fl3eBRafN2SNyVCqPCqSMCKtA7YblyBuHXCyrAE0sglEEcwgTiSCcQRTZLnRQJfpHXSduNtELeOWhmfQBoBBeJIKBBHRIE4MkryzsgOiPPSFOKWU5K3hlrgJQK8vwCqCLzBoFcY3hoC1pCXNSAN34H8rAFx-BbkZw3x1hCwhnhrCFhDXtaANLIGxJE1II6sAXFkDfHWELCGeGsIWEO8NQpYo_ysUbw1ClijeGsUsEZ5WQPSyBoQR9aAOLIGxOF_uXhrFLBG8dYoYI3ysgakkTUgjqwBcWQNiCNrFG-NAtYo3hoFrFG8NRpYo_2s0bw1GlijeWs0sEZ7WQPSyBoQR9aAOLIGxJE1mrdGA2s0b40G1mgva0AaWQPiyBoQR9aAOLJG89ZoYI3mrdHAGs1bEwFropLWDN9_-S8AAP__OWFbfw==

# EXCEPT ALL and EXCEPT with compatible ORDER BY columns that are not in the final result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT ALL (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8l89u2kwUxfffU1h3legbZGZsk8RSJdKEqkg0pMAiVcTCwdOARLBrGykk4t0rDCr_59ge8C7g-eXeOXfOHPxJ8Z8xudRttBp3PWMajY1vnfYP47nx9Ni6bT4YF_fNbq_7s3VpXKzWzJYr3mcfRrtz3-gYX38ZH5dG4-mu8dgzblstsLJPjCaBLx-8NxmT-0ycGAliZBEjmxg51GcURsFAxnEQLZZ8pkDTfye3ymg0CafJ4us-o0EQSXI_KRklY0ku9byXsexIz5eRWSVGvky80TgtE0ajNy-a1d9nH8SoG3qT2DUq5qJye5q4Rl2wukX9OaNgmqwrxIn3Ksnlc5a9i24QJTIyne0G6uL_f7U4q4udWmv8ZWYMvXi4Q3Pqz9f9iDz9bKrCTyqLVUAWfk5d7KMNrf9PEPkykv5-F_0FnGHVgb199-JhVybt0BQ7AvdmoXQ37EGMxvJ3clHnl1-i0esw_WstwFGpnQw7m04OdX2w4YegEoSmcHZWHq5d26rNc5y2DIfNFBXTKuJC0MfquNVKc2EeXU4sjFVAGH5OZeyjDZXmQ16GD0X2mYssI7cqpl3EC6CP1civSvNCDl34iYWxCgjDz6mMfbSh0rwgyvCClX3mVpaR25X0J1RuL4A-ViO_Ls0LOXThJxbGKiAMP6cy9tGGSvOCVYYX7Owzt7OM3KkUcQLoYjXwm9KckEMVflJZrAKy8HPqYh9tqDQf2GW_pxxopyPjMJjEMtNbSHWxIem_yqVMcTCNBvIxCgZpmeXHdsqlX_gyTpZP-fJDc7J8tGhwE-a7MN-E7S2Y54N5VYt2dGihVVuA2kKpuKVW3MqhuMgH7yiel3Z0aKFVW4DatlJxMC5HCYuael41JX2lhq907KWGkb0ADTRT08hegAa1r5WK36gVv9GxlxpG9gI0OOJqGtkL0KA2V2cIuor3btPtBBIggvau01wZpKZhCAEcbV2NwxgCOKq-d6luC28D4fdu1TxeATQyC8LRiVXjyC4IR9XVkYLGpo4UDjKFa4UKoKFf9GIF4NAvesHC1cnCQbRwrWwBNPSLXroAHPpFL1-EVr4Idb4IkC9CK18AjfyCcLR1vXxBOKquzhcB8kVo5QugkV8Qjk6sXr4gHFXPly_9-X9_AwAA__939qN5

query T
SELECT url FROM [EXPLAIN (DISTSQL) (SELECT y FROM xyz ORDER BY z) EXCEPT (SELECT y FROM xyz ORDER BY z)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy82Ftv4kYUB_D3fgprnhLVCObCVarEdkPVSDSkwMNWKx5YmCZILKa2kUKifPeKS-sws5z_2B54y4U_c3zOzE8Dbyz5Z8k6bNTr9z6Pg028DH4bDv4Ivva-PPY_3T8EN3f3o_Hoz_5tcHN8zfbwipftazAY3vWGwa9_Ba-3Qe_L597jGLxqwkK2iub6YfpdJ6zzlXEWMsFCJlnIFAtZnU1Cto6jmU6SKN695G0fuJ-_sE4tZIvVepPu_jwJ2SyKNeu8sXSRLjXrsPH021IP9XSu42qNhWyu0-liuV9mHS--T-Nt92X7ykI2Wk9XSSeoVHcrDzZpJ-iKsCvZ5D1k0SbNVkjS6ZNmHf4eulcxiuJUx9X6aQFd8fP_a_GwK86uJfKsdbdI0sVqlla58bxdnq1mLJWlv22D52nybCUn71k5Mk85HwfA6z4noApMQJg9cR1BvdAIhDlxXyNonC0ne5_NKornOtbzk3fav8vZgqW9Z851pHmpEuyenSuhVaKEsFCVv0-T55FOB-uqMjo13q515z_wPvX7LGRL_Xd60-W3v8SLp-f9T2ennz1T229bH6JKtK6quvn0PzatdrI4z3GyHQ52VVSqsgiuoI7j0W54wRWsleHKr4JrnhE0_M5AFZiBMLtSjFfXIQhz5pfhlfuzzd41brx6LMHumRuv-UoozSu_Bq_C_XgJl9MlK1VVRDhQx_F0Nb0IB9bKhBNXES7HCHjT7wxUgRkIsyvFhHMdgjBnfhnhhD9e7F3jJpzHEuyeuQmXr4TSwolrCCfdj5d0OV2qsv8Um1s4UMfxdLW8CAfWyoSTVxEuxwh4y-8MVIEZCLMrxYRzHYIwZ34Z4aQ_Xuxd4yacxxLsnrkJl6-E0sLJawin3I-Xcjld9UoR30AVx7PV9uIbWCvzTV3FtxwD4G2fE1AFJiDMnhTTzXUEwpz4ZXRT_mix94ybbh5LsHvmplu-Ekrrpq79BeAPyhnqZB2tEu309V5t90B6_qQPDUqiTTzTj3E02y9z-HWwz-3_MNdJevgvP_xyvzr8a1fgxzAnw4IOCzPMP4YbJ2GeL8xLpUW9TFqqMmkl6bQkO67ojisyXKfDdbLuJl02Heal0gIMm05LMGw6rcCwG2THW3S4mSMszHCLDLfpldv0LmsAFYApCBVaFQ5Y4aVcAWkEC4gjWUAc0QLiyBZO48KBLpzmhQNfeClgQBoJA-KIGBBHxoA4QobTynDADKed4QAaXkoaTlMjauAOQVMjADXCoibXHYROw0sIHYe3EDoOryF0HFkhLGpOGy9B42lqBKBGWNTksQKkkRUgjqwAcWQFiCMrhEXNaePRs9PUGHHLCkFTA6wQtDSiDTYNTY0E1EiLmjxWgDSyAsSRFSCOrABx-JmFvtBJcKGTNDUSUCMtavJYAdLIChBHVoA4sgLEkRWSvtBJVDxNjRG3rJA0NcAKSUsjW2DT0NRIQI20qMllBZ2GVtBxaAUdh1bQcWSFoi90ClzoFE2NAtQo-gMUOOwgjawAcWQFiCMrQBxZocAXU2h1mhojblmhaGpMKybvP_0bAAD__5nkSU4=

# EXCEPT ALL and EXCEPT with a projection on the result.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT ALL (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEllFr4kwUhu-_XzGcK4WROJNoa-CDlq7LCm7tVi8KJRepma2CNdmZCNrS_76YtFijzsnsYHI5Os_MO-c8kPMG6s8CfBj3h_2bCVnJBfl-P_pJHvsPd8PrwS1pfBuMJ-Nfwyb52LLONzQan2tKNvlP681rk_Qfbvp3E3I9HJLjO5oBUFjGkbgNX4QC_xEYUOBAwQUKHlDoQEAhkfFUKBXL7Za3DBhEa_DbFObLZJVufw4oTGMpwH-DdJ4uBPgwCZ8W4l6EkZBOGyhEIg3ni-yaRM5fQrm5Wm9egcI4CZfKJy1ne_NolfrkitErDsE7hXiVftywO_hpQ2ahmu0f-YkEFFQaPgvw2Tv9t7CdGsLyk2F3R62WsYyEFNHeYcGWxLYcefGPUM3GIh0lDit0Z7JJhP_FHqCwEL_TRpa6-b-cP88-F7saFAqwe5lr8bIjsW_jVpw4rFOswdG7vb27WXkFWAkFHN5y3DMaaxC3W0tcfjJuBc6y6pzl5RvByzTCbTneGb0xiHtRS1x-Mm4F3vDqvHHLN8It0wivlX2azuWNQdzLWuLyk3Er8MatzhuvfCO8Mo3otM5ojUHYXg1h-cmwFTjj1TNXHQl1L1QSL5UoNTW1t88S0bPIy6TilZyKOxlPs2vy5Sjjsq9-JFSa_8vzxWCZ_7UNWB7u2sA9G5hZ5WYdPc0MSsbN4K4N3LOBmVXuQskOaF6k219pV19vVwuz_Zq1i7RnI7geRgTXw4jgehgTHKERwTs2guthRHA9jAiuhzHBERoRvGsj-IWNonoYUVQPI4rqYUxRhEYUvbRRVA8jiuphRFE9jCmK0IiiPRtFmdWcgNCIpAiNWIrQmKYYjs0KdsOC3bRgNy5Yzgt2AwOzmhjYwchgZKuexmzV05itehq1FcExW02GpcOemUxLpjRmq9G8ZIxjth4MD1pbg_f__gYAAP__BJKH9g==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT x FROM ((SELECT x, y FROM xyz) EXCEPT (SELECT x, y FROM xyz))]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzEmF9v4kYUxd_7Kaz7lEiDYGYMIZYqZbVL1Ug0SQMPK6148MI0QWKxaxspbJTvXmGaEGx8j8d_so_8-TFnju85HvNM8b8r8mgyGo8-T51NtHL-uL_9y_k2-no3_nR945x9uZ5MJ3-Pz53_v_K0_8LZ2etr4Wz3bz1tf547o6-fR3dT5_Sn5zMStA4W5sb_YWLyvpEkQYoEaRLkkqA-zQSFUTA3cRxEu688p8D14om8nqDlOtwku7dnguZBZMh7pmSZrAx5NPW_r8y98Rcm6vZI0MIk_nKVLhNGyx9-tL162v4kQZPQX8ee0-nuVr7dJJ5zJcWVotmLoGCTHFaIE__BkCdfRHkVX5ZxslzPk27_WMKpJQ7U963z6MePp5GDEmWj5L0fslFDdCVDZBuOuIVSDj-1WQfRwkRmcfRj6a8UilU9LPagot-WihKWHVQMaqgQlYT-6cePE5Pchl2d8Wu6DY332gafxmMStDL_JGfpDs5_j5YPj68vDjNXuLOLZv29CTpB2NX9rAcn1x4erS0tMlcicl3V6eoqLQR0vE3QoPUWsnGkYUt0JUtkG564hVJqNoCs3kMNqihhWVEP2amo3UPy43pIlZ98VWbwdafrVukCoOPtKl603gUWjsiGLdGVLJFteOIWSqmZQlW9CxpUUcKyoi6wU1G7C9THdYEuP_m6zOC7nfQBwroLgI63qzhsvQssHJENW6IrWSLb8MQtlFIzhbp6FzSoooRlRV1gp6J2F-iP6wK3_OS7ZQa_36nSBEDF2zW8bL0JLPyQjRqiKxki23DELZRSM4Fu9R5oUEUJy4p6wE5F7R5wf83_FCdE3Zs4DNaxKfUvRG-3LbN4MHub4mATzc1dFMzTZfYvb1MufWNh4mT_qdy_uF7vP9oJfA_LLCzfw-4RLO1gqWrRl3VoNahDa83TinVc845rduk-vzIPS6Cbp1WvFn1Rh9Zg0lzWcXCx-xawysIDFgabvuAHZcBPypClL3n4sk6weRgFG9Ag2DyNgs3TKNgSdCkqU75WQLYBjcINcJRuhINJBzjKt-QrVSI81y4cnsu45OsFbZ3vFwlSLnMNY3UL5ml4DwY4ugnzOLwL8zhMK1-vcgiMz_WrVVp5GqaVx2FaAY5GlsdhWnMte2S8kuD4xLdsBs-lVeWqxiatim8aBU5vij_HAOMAjdKKcJBWgKO0AhwemvmSVX1gfK5lbdIKaJRWgKO0IhyNLI-jtCr-CKuGAOdbNoPn08qfYtHW-abRPfCslWsam7QCGqUV4SCtAEdpBThKq-ZLVitgfK5lrZ5yeRo-5vI4fM4FOHrQ5XGUVs0fZTWyjm_ZDJ5Lq-bPstmtz15--y8AAP___oUktw==
