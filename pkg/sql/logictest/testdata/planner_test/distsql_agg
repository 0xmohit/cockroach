# LogicTest: 5node-dist

statement ok
CREATE TABLE data (a INT, b INT, c FLOAT, d DECIMAL, PRIMARY KEY (a, b, c, d))

# Prevent the merge queue from immediately discarding our splits.
statement ok
SET CLUSTER SETTING kv.range_merge.queue_enabled = false;

# Split into ten parts.
statement ok
ALTER TABLE data SPLIT AT SELECT i FROM generate_series(1, 9) AS g(i)

# Relocate the ten parts to the five nodes.
statement ok
ALTER TABLE data EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i)

# Verify data placement.
query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW EXPERIMENTAL_RANGES FROM TABLE data]
----
start_key  end_key  replicas  lease_holder
NULL       /1       {1}       1
/1         /2       {2}       2
/2         /3       {3}       3
/3         /4       {4}       4
/4         /5       {5}       5
/5         /6       {1}       1
/6         /7       {2}       2
/7         /8       {3}       3
/8         /9       {4}       4
/9         NULL     {5}       5

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslEGL2zAQhe_9FWJOCcjYsp1s1qcsbQqB7GYbp1BYfFCjwQ04livJ0BLy34vtwjphV3ZRj5LmzXsfI-YM-mcBCaSrzerjntSqIJ9320fysvr2vHlYP5HJp3W6T79spuRvia5PEz7tqgQ3PAMKpRT4xE-oIXkBBhRCoBABhRgozCCjUCl5QK2lakrOrWAtfkESUDiWVW2a64zCQSqE5AzmaAqEBPb8e4E75AKVHwAFgYYfi9amUscTV7-XTQagkFa81AnxfEZ4KQgj0vxABRS2tUnIkkF2oSBr8-qlDc8REnah4_M85LnCnBup_Nl1nPTr42TJpu_ahO_avHavS6kEKhRXrbOLPQgL_i1JdJWEjR8AGzMAn3l-6DSCgUQ98rnLCMLx4OEo8NDzIyfwgUQ98DsX8Gg8eDQKPPL82Al8IFEPfOECHo8Hj0eBx54_cwIfSNQDv_9f2-YNmx3qSpYab7bO252DZhuhyLFbXVrW6oDPSh5am-64bXXthUBtulfWHdZl99QE7IuZVRxeidmtOLQ7D1hHVnVsF8cuuWdW8dzuPHdxvrOKF3bnhYvzvX1WwcA3sX-yW-_s8uFPAAAA__8lIeCd

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum((a-1)*1000 + (b-1)*100 + (c::INT-1)*10 + (d-1)) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVV9r4k4Uff99iuE-Je2EZJLY2jwprT8IqO2qCwslD1Pn4gqacWcS2EX87kuSLSbSTrJkX_TJ--fMuefcwD2C_rGDCJaT6eRxRXK1I_8vnmfkdfLtZTqO58R6iper5ZepTf606HxvFT9OHMJsckOY53k2uSWW9VZL2VVqHUXxfDU8F6q8KBN2xSV4xhOgkEqBc75HDdErMKDgA4UAKIRAYQAJhYOSa9RaqqLlWAJi8RMij8I2PeRZkU4orKVCiI6QbbMdQgQr_rbDBXKByvWAgsCMb3clzUFt91z9GhUzAIXlgac6Io7LCE8FYURm31EBhQWmAlVECuUj5rCo0mXfFOrfg1vLGvnN2vv_shZUQaOj1jAKy8rT5DGejac2JCcKMs_OunTGNwgRO9Hu2sebjcINz6RyB03py68za8Q-p_E_pTm_nqdSCVQoGk8nJ_MgzPu7SYLGJKz7slmXZbvMcf2rWXeL-prLd33W7Xc32e9ksu-4wdWY3KK-ZvJ9H5OD7iYHnUwOHDe8GpNb1NdMHvYxOexuctjJ5NBxB1djcov6mskP_-o6fECzQH2QqcaLK_Hxy15xPVBssDo1WuZqjS9KrkuaKnwucWVCoM6qKquCOK1KxYB1MDOC_QaYXYJ9M3MLdWBEh2Zw2GfugRF8Z2a-68N8bwQPzczDPswP5l15LZ-J-SO75E5O__0OAAD__7BpaAU=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), count(a), max(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L2kAUhu_7K4ZzpTASJ4mumytla0HwY2sUFpZQps7BCjGTzkxgi_jfS5KlG2WdBGLvJh9v3ofnhHMC_TuGAMLpfPq0IZmKybf1akFepy_P88lsSTpfZ-Em_D7vkvdXdHbs8C4lO5klpjgd-VuHd8uc4IZHQCGRApf8iBqCV2BAwQUKHlDwgcIAIgqpkjvUWqr8lVMRmIk3CPoUDkmamfx2RGEnFUJwAnMwMUIAG_4zxjVygcrpAwWBhh_ioiZVhyNXf8Y5A1AIU57ogPQcRngiCCPS_EIFFFaZCciYQXSmIDPz0aUN3yME7Eyb80z2e4V7bqRyBpc44XbRGbMuUHhabZeb9_Ni8lKcbpW7N8s_OrNEKoEKxUVhdLbjsf4tvnC7-DHLCd1_hN5tQu-CkDUfF2syLof1HLfVwGqIKkaG9x-Y21yH20iH23O8VjpqiCo6Hu6vw2uuw2ukw-s5fisdNUQVHaP76_Cb6_Ab6fB7zqCVjhqiio7H_7vdPilfo05lovFqy33-5X6-_VDssVyVWmZqh89K7oqa8nJV5IobArUpn7LyYpaUj3LAaphZw-5FmF2HXXtzTbVnTfv2sN-Ge2AND-3NwzbND9bwyN48atP8aJ9Vv-Y3sf9k193R-cvfAAAA__84xwPC

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), count(a+b), max(a+b) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L4jAUhu_3V4RzNTKRmrQ6Tq-UWRcEP2atwsBQlow5uII2bpLCLOJ_X9rKjMqYFuzeJW3fvg_PCdmD-bOBEKLBaPA0J6nekB-z6Zi8Dl6eR_3hhNx9H0bz6OeoQY6fmHR7J8g9eWtQslRpYj92W_F-XBf_kMKKGCgkSuJEbNFA-AoMKHCg4AOFACi0Iaaw02qJxiidfbLPA0P5DmGLwjrZpTZ7HFNYKo0Q7sGu7QYhhLl42-AMhUTttYCCRCvWm7xmp9dbof_2MgagEO1EYkLS9BgRiSSMKPsbNVCYYSJRh6TH7nsc4gMFldrPRmPFCiFkB1qdqr9aaVwJq7TXPoeKFuO7HmsAhafpYjI_rsf9l3x1rZxfLf_sTBOlJWqUZ4XxwY3HWtf4osX41zAj5B-E_nVC_4yQVR8aqzI0jzU9XsPYSrhOvHTqHxuvLoVXksKbnl-DlBKuEykP9Uvxq0vxK0nxm15Qg5QSrhMp3fqlBNWlBJWkBE2vXYOUEq4TKY__99b7onyGZqcSgxe339d_bmW3IsoVFleoUale4rNWy7ym2E7zXP5AorHFW1ZshknxKgM8DTNnmJ-F2WWYu5tLqn1nOnCHg1u4285wx93cuaX5wRnuupu7tzQ_umfVKjkm7kN22R0fvv0LAAD__3k1DwI=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum((a-1)*1000) + sum((b-1)*100) + sum((c::INT-1)*10) + sum(d-1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMVV9ro0AQf79PscyTNiu6atrUJ0ubAyFNe0kODooP2-yQCySa21W4I-S7H2pJNDSrXMiRt90Zf_7-7MBsQf1aQQDT4Wj4OCO5XJGvk5dn8jb88Tp6iMbEeIqms-m3kUk-PjEMla8NgxOLMJPcEOY4jkl6pKy-16rmvjoPgmg8Gxx6-5aoaiWl4BmPgUKSChzzNSoI3oABBRcoeEDBBwp9iClsZDpHpVJZfLItAZH4DYFDYZls8qwoxxTmqUQItpAtsxVCADP-vsIJcoHSdoCCwIwvVyXNRi7XXP4JCw1AYbrhiQqIZTPCE0EYSbOfKIHCBBOBMiBGyCwWVLbMmyKCjwslRug2W7WOVx0b_X079Mv60_Axen4YQbyjkObZwY7K-AIhYDva3fLDYiFxwbNU2v2m4-n3ZyNkZmG2OLn7k7c_-eZJEe5JEQfuPEmlQImiQRzv9DKZ8y86ay9jhKwXumYv9Mxe6J904DUcsO6Tw7pMjs0s27322WkxXXuU28vNjts9ebdT8q5le9eefIvpWvJ3l0ve65681yl5z7L9a0--xXQt-cHlkve7J-93St637P61J99iupb8_f_ZVJ-ImKDapInCo431-Z-dYpOhWGC19lSayzm-ynRe0lTXlxJXFgSqrOqy6hIlVasQWAczLdhtgNkx2NUzt1B7WrSvB_vn6O5rwbd65ttzmO-04IGeeXAO873-rZyWMdEP2TF3vPvyNwAA__97DpEd

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), min(b), max(c), count(d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF2L2kAUhu_7K4ZzlcBInCTuurlSthYCfmyNwsISymzmYAXN2JkJbBH_e0lSWJXdSarYK_P1-j48Zzh70L82EEEyGo8eF6RQG_JtPpuQl9Hz03gYT4nzNU4WyfexS_5-ooutw11KtuvceS1_-ZuTuZRkssiNI9w6L7jhKVDIpcAp36KG6AUYUPCBQgAUQqDQg5TCTskMtZaq_GRfBWLxBlGXwjrfFaZ8nFLIpEKI9mDWZoMQwYK_bnCOXKDyukBBoOHrTVWzU-stV78HJQNQSHY81xHpeIzwXBBGpPmJCtIDBVmY9wZt-AohYgfanmK4WilccSOV1zuFSJYTZ8BcoDCJp87Ar66Gz84gKK8eZ8vpwhmE7qcY_qcY7-1FLpVAheKkOj3YQVn3X0iT5eRH3MAanLCy9oNjbQbnsY7nXzC6Bo4jI3e3HJ3fXoffSoff8YILdDRwHOm4v6WOoL2OoJWOoOOFF-ho4DjS0b-ljrC9jrCVjrDj9S7Q0cBxpOPhf-25DzDmqHcy13i27z7-5265B1GssF6aWhYqwycls6qmvp1VueqBQG3qt6y-ifP6VQl4HGbWsH8SZudh397cUB1Y06E9HF7D3bOG7-zNd9c031vDfXtz_5rmB_usug3HxH7IzrvTw5c_AQAA___zjwZw

# AVG is more tricky: we do two aggregations (for the sum and for the count)
# and calculate the average at the end.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF2L2kAUhu_7K4ZzleBInEncdXOVZWsh4MfWKBSWUGadQyq4GTuJpUX87yXJwkZZJwHNXb5e38fnDOcA2e8t-BCNJ-OnJdnrLfm2mE_Jy_jH8-QxnBHraxgto-8Tm7x_Iv4klmUJ0iOvNumRte-Hs-WouJR2lZUiFzFQSJXEmXjDDPwXYECBAwUXKHhAYQgxhZ1Wa8wypYtPDmUglH_BH1DYpLt9XjyOKayVRvAPkG_yLYIPS_G6xQUKidoZAAWJudhsy5qd3rwJ_S8oGIBCtBNp5pO-w4hIJWFE5b9QA4UFphK1TywrYL2A273Aff8jvcCD-EhB7fMPgiwXCYLPjrQ95WOSaExErrQzPIWMVlMrYDZQeJqvZsvy-lIlv1j50bRPlZaoUZ7UxEczFBtcoopW059hwcXtmqqAOQG_yOmecLL2A2RtBuiwvsM7GGEDZ83W3a1GyNur4a3U8L7jdqCmgbOm5v5Watz2atxWaty-43WgpoGzpmZ0KzVeezVeKzVe3xl2oKaBs6bmoYud-EnlArOdSjM8242f__Kg2JkoE6wWbKb2eo3PWq3Lmup2XubKBxKzvHrLqpswrV4VgPUwM4b5SZidh7m5uaHaNaY9c9i7hntoDN-Zm--uab43hkfm5tE1zQ_mWQ0ajon5kJ13x8cv_wMAAP__sSUUtA==

# VARIANCE/STDDEV have three local (sqrdiff, sum, and count) and one final stage aggregations.
# We calculate and render the variance/stddev at the end.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), round(stddev(b), 1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lGFr4j4cx5__X0X4PaoQqUnr5vqoYyoUnG62-3MwypGZH57gGi9JjzvE9360HUxltoXiPWuSfvv99JOQPZifWwggnswmDwnJ9ZZMl4tH8jr59jS7j-bEGUdxEj_PeuTjFZO_O6JHiVZ5Jh1jpcRfzluPEtarolJYkQKFTEmci3c0ELwCAwocKHhAwQcKQ0gp7LRaoTFKF6_sy0Akf0MwoLDJdrktplMKK6URgj3Yjd0iBJCIty0uUUjU7gAoSLRisy1rdnrzLvSfsGAACvFOZCYgfZcRkUnCiLI_UAOFRW4DEjIackgPFFRuP-uMFWuEgB1oe6T79VrjWlil3eEpUfzy6ISsV8A8L8fRdOqEvBwV8-XTw-JlnpTPl1D4RZRPgjxTWqJGeVKfHuph2eAS7TSa38--x8l4PPnfCTkNPRr6xcISM4m6tPdxBkJOWRAE0TwZXf4H7-QfWPsdZm122GV9l3fd4waoI203195j3t4Pb-WH912vq58GqCM_t9f247X347Xy4_Vdv6ufBqgjP6Nr-_Hb-_Fb-fH77rCrnwaoIz93__IO_QJliWanMoNnd-nXXx4UdyzKNVYXslG5XuGTVquyphouylw5IdHYapVVgyirlgrA4zCrDfOTMDsP8_rmhmqvNu3Xh_0u3MPa8E19802X5tva8Ki-edSl-a5-rwYNx6T-kJ13p4f__gYAAP__8VsiBA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), round(variance(b), 1) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lNFr4jAcx9_vrwi_pwqRmrQ616eKUyi4ulV3HIxyZOaHJ2jjpe1xh_i_H20HU5lpobi3Jum3308_CTlA-nsLHiwms8l4SXK9JdNo_kheJz-eZqMgJNZDsFgunmcd8v5Kmu8s0aFEqzyR1h-hNyJZofXWoYR1qrAUmYiBQqIkhmKHKXivwIACBwoOUHCBQh9iCnutVpimShevHMpAIP-C16OwSfZ5VkzHFFZKI3gHyDbZFsGDpXjbYoRCorZ7QEFiJjbbsmavNzuh__kFA1BY7EWSeqRrMyISSRhR2S_UQGGeZx7xGfU5xEcKKs8-6tJMrBE8dqTNkUbrtca1yJS2--dEi5dHy2edAuY5egimU8vn5aiYL5_G85dwWT5fQ-FXUT4I8kRpiRrlWX18NMOy3jXaaRCOZj-_j6JgFI4nls-p71DfLZYiTCTq0t_7OfA5ZZ7nBeFyeP0vnLO_YM33mDXZY5t1bd52l2ugTsQNbr3LvLkf3sgP79pOWz81UCd-7m7tx2nux2nkx-nabls_NVAnfoa39uM29-M28uN27X5bPzVQJ37uv_IW_QQlwnSvkhQvbtPPv9wrblmUa6yu5FTleoVPWq3Kmmo4L3PlhMQ0q1ZZNQiSaqkAPA0zY5ifhdllmJuba6odY9o1h9023H1jeGBuHrRpvjOGh-bmYZvme_Ne9WqOifmQXXbHx2__AwAA__-GjSNC

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT stddev(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF1r4kAUhu_3VwznKuJInCS2NlcpVSFgbWvSZaGEZeocXMFm3Jlx2UX870sSoSp1EpDcTT5e38fnhLMD_XsNISTj6fghJVu1JpP50yN5G_94nt7HM-KM4iRNXqYdcnhFGyHwj-M4nHTJe4d0ySIM41k6LI6iU8UFNzwDCrkUOOMfqCF8AwYUPKDgA4UAKAwgo7BRcoFaS1W8sisDsfgLYZ_CKt9sTXE7o7CQCiHcgVmZNUIIKX9f4xy5QOX2gYJAw1frsmajVh9c_YsKBqCQbHiuQ9JzGeG5IIxI8wsVUJhjLlCFxHEi1o28TjfyD3-kGwWQ7SnIrfkk0IYvEUK2p80p75dLhUtupHIHp5DJy3wUTyZOxDoF4-vj4fTw9DpLy_MlAO8iwGfvNpdKoEJxUprt7YjsTOQknt1PfybpaDT-7kSMRh6N_Mtg_gkYaz4_1mR-Luu5XgsTrOE80nPTzgS95qK8RqK8nuu3IKqG80jUbTui_Oai_Eai_J4btCCqhvNI1LAdUUFzUUEjUUHPHbQgqobzSNRd-8vzC4A56o3MNZ4t0a9_uV8sVxRLrDaxllu1wGclF2VNdflU5sobArWpnrLqIs6rRwXgcZhZw95JmJ2HPXtzTbVvTQf2cHAN98AavrE331zTfGsND-3Nw2ua7-yz6td8JvaP7Lw723_7HwAA__9AmiJy

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT variance(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF1r4kAUhu_3VwznKuJInCS2NlcRqxCwsY12WShhmWYOrmAz7mRcdhH_-5JEqEqdBCR3k48375PnDLOH_PcGfFhMZpPxkuzUhkzj-RN5m_x4no3CiFiP4WK5eJl1yPGVP1yteZaiZVmcdMl7h3RJ6vthtBwWS9GpPiC45glQyKTAiH9gDv4bMKDgAAUXKHhAYQAJha2SKea5VMUr-zIQir_g9ymss-1OF7cTCqlUCP4e9FpvEHxY8vcNxsgFKrsPFARqvt6UNVu1_uDqX1AwAIXFlme5T3o2IzwThBGpf6ECCjFmApVPLCtg3cDpdAP3-CPdwIPkQEHu9CdBrvkKwWcH2pxytFopXHEtlT04h1y8xI_hdGoFrFMwvj4dV-P5a7Qs19cAnKsAn727TCqBCsVZaXIwI7ILkdMwGs1-fh_F4SgaT6yA0cChgXsdzT1DY80nyJpM0GY922lhhjWcJ4Lu2pmh01yU00iU07PdFkTVcJ6Ium9HlNtclNtIlNuzvRZE1XCeiBq2I8prLsprJMrr2YMWRNVwnoh6aP_4_AIgxnwrsxwvjtGvv9wvjlcUK6zO4lzuVIrPSqZlTXU5L3PlDYG5rp6y6iLMqkcF4GmYGcPOWZhdhh1zc021a0x75rB3C_fAGL4zN9_d0nxvDA_NzcNbmh_Ms-rXbBPzJrvsTg7f_gcAAP__3CojsA==

# Test various combinations of aggregation functions and verify that the
# aggregation processors are set up correctly.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(b), sum(c), avg(d), stddev(a), variance(b), sum(a+b+c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVl9r6k4Qff99imWeEhyJm8R_eVqpCgFrW2PLD4qUbXbxCjbxbmK5l-J3v2xMa_TeJgFB8G1mZ86eMzkDmw9Ifq7Bg2A0Gd3MyVatyXh2d0ueR__fTwb-lBhDP5gHDxOT5C3J9s3gJhL-vjReTczyMM-FzlMh5HvW8s7Vikeh_OozDE4a5NUkDRJ6nj-d93QozD2n4ClfAEIUCznlbzIB7xkoINiA4ACCCwhtWCBsVBzKJImVbvnIAL74BV4LYRVttqk-XiCEsZLgfUC6StcSPJjz17WcSS6kslqAIGTKV-uMZqNWb1z9ZloDIAQbHiUeaVqU8EgQSuL0h1SAMJORkMojjCJhNhLmIGEuEsNgtMFss8GcfLAGc2GxQ4i36UFRkvKlBI_usL7qwXKp5JKnsbLax6KDx1uDUVPr1ZGto5u7x-k8j7NT5ytyC_UsDh5mQ388zu_IK_SocrinbX47jv3tOIcptlGshFRSHI2w2JUPTFvVEwePty--Vn4y6afqQkdHZ2N_Opi8BPPhcPRksC4yiqx3KDwNZv5gejMyWB-ZjYVbacv8awOszwVgbYt1kLAuEtZDwvrffi3n6GvR-itL66ysRZuWfYGlrdBd8LBzDUtr17fBrmWD3bScC9hQobtgQ_cabHDq2-DUssFpWu4FbKjQXbChdw02uPVtcGvZ4Dat9gVsqNBdsKF_DTZU_BjMZLKJo0SevKj_vrmlX1oplnL_LCfxVoXyXsVhRrNP7zJcdiBkku6rdJ_40b6kBRbBtBRsH4HpKdguZ66gdkrRbjnYPUd3uxTcKWfunMPcLQX3ypl75zD3y71qVaxJ-ZKdci92__0JAAD__3KbueE=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), min(b), max(c), count(d), avg(a+b+c::INT+d), stddev(a+b), variance(c::INT+d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUVl1r4kAUfd9fMdynCV6Jk8SP5mmkKgTUtsaWQpEyzQyuoIk7iaVL8b8vSaSNpSZZ-iA-dXLnnJ577rngvEP8Zw0u-MPx8HpOdnpNRrObCXkaPt6O-96U0IHnz_27sUEOkHi3ocJAslmF9CX9K95oYCAJol2YUGkgEa9LSqkgDfJikAYJXNebznvpMb2NEynV6-EayavQKxEGih5gGSrvQYpELAAhjKSaio2KwX0CBggWINiA4ABCGxYIWx0FKo4jnULeM4In38BtIazC7S5JywuEINIK3HdIVslagQtz8bJWMyWk0mYLEKRKxGqdyWz1aiP0X572AAj-VoSxS5omIyKUhJEo-a00IMxUKJV2CWdIuIWE20i4g4RSzhrcMhrcPthvpOWsmKLyYoM7sNgjRLvks8s4EUsFLttjfSf95VKrpUgibbaPjfj3E8qZAQgTb0q5lZ36j5Tb6en65n46p9xJzxmyXahmZ_9uNvBGI8o7H5hOAdM5wnQ_MN0CpmucNGmdNPnpbRdGWiqt5JGxxb58DKz1P3Pw7yfP3jeT-KhnPkfetD9-9ueDwfCB8i7yHvKrz4uH_szrT6-HlLMWcsaQs0zm1I7wtsk7SHgXCe-dHJF9NCJWf6NZnY02WdO0zrTTFV4KYXYud6et-oFZtQKzmqZ9psAqvBQC615uYHb9wOxagdlN0zlTYBVeCoH1Ljcwp35gTq3AnKbZPlNgFV4KgV1dbmAVb5mZirdRGKsvP_ff_-dW-gxQcqnyN0Mc7XSgbnUUZDL5503GywpSxUl-y_IPL8yv0gaLZFZKto7I7CvZKleukLZL2U452flJ3-1ScqdcufMT5W4puVeu3PuJ8lV5Vq2KNSlfsq_ai_2vfwEAAP___cTpRg==

# Verify that local and final aggregation is correctly shared and de-duplicated.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), stddev(a), avg(a) FILTER (WHERE a > 5), count(b), avg(b), variance(b) FILTER (WHERE b < 8), sum(b) FILTER (WHERE b < 8), stddev(b) FILTER (WHERE b > 2) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzsVktv4jwU3X-_wrqrIBklzoNHVkYl6ItEaRvSzkgdVJnEYpAgYZykmlHFfx8loZAw5CF1wYYFIrbPucfn-ljyB0S_NmDC3Jpady5KxAZNnId79Gp9f5yO7BmSxvbcnT9NO-gAiZKtxDoYRbHv8_fsk72vJNZBE3vqWg6Svv1vORZi6EeiKBpHRgcjL0yCWFoesOn_OxNrFnhcWp4TlznRQ4NUJdk2IfJ9VIE4Uju5JZ_FbAEYgtDnM7blEZivQACDChg0wKADBgMWGHYi9HgUhSKFfGQE2_8NpoJhHeySOJ1eYPBCwcH8gHgdbziY4LLlhjuc-VzICmDweczWm0xmJ9ZbJv7QdA-AYb5jQWSirkwQC3xEUBj_5AIwODzwuTARJRhRkhswTNO0Z-4AI6qmv9z7oDCb49TDDCz2GMIkPm00itmKg0n2uL2Z0Wol-IrFoZCNspf5871ESSe18eSM7cnkMLp7eJ65nys55vNIqFpcvzSrHVlaqbJ2QusnRGnuWKGMvFDBuFDBuFjBqGyiWtnEU--SIBQ-F9wvNW6xr28zUar6PLFno-nb3B2PrReJqpgSXGiYfvh6s1MTRmnUO6L6p0IvI8ceze4siQ4wHWJKlCNq-K8cIZiSVDNTLAU0jaMmUx0jamBEe3L218eIprEcVvZQK_WQtL9VpM2tkklXVq93rxrsFA68d7tXVfdKbZ8JtVUm1K6sXS8TDXYKmejfMlGVCa19JrRWmdC6sn69TDTYKWRicMtEVSb09pnQW2VC78rG9TLRYKeQieEtE23eZBea6PBoFwYRP3ubXa6spG827q94_sCLwkR4_FGEXiaTDx8yXjbh8yjOV0k-sIN8Kd1gkUxqyWqJTM7Jar1yg7RWy9bryfpX9m3Uknv1yr2vKPdryYN65cFXlIf1Z6U0xKQ-ZOfai_1_fwMAAP__eziMbQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(DISTINCT a), variance(a) FILTER (WHERE a > 0) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0k8GOmzwQgO__U1hzSiRHYCC_Kp8SpWyLlGW3QLeVthxcPKJIBFPbrFpFefcKaJVmla2okh49ns_zzVizB_O1Bg5puA03Gel0TW6Su1vyGH68366jmMxeR2mWvtvOyc8U0-1mYk6JeCqHuyjeZKQPPAldiabAmZiTm2ibhQmZfXgbJiER5FPnuj4Sdz6-LoUVOVBolMRY7NAAfwQGFDyg4AOFACgsIafQalWgMUr3KfsBiOQ34C6Fqmk724dzCoXSCHwPtrI1AodMfK4xQSFROy5QkGhFVQ9lWl3thP6-6h2AQtqKxnCycBgRjSSMKPsFNVBIsJGoOVkxSlZsbMDlnEdx9gryAwXV2aOAsaJE4OxAX5A8unWN0hI1yhOv_HCmjXVZaiyFVdpZnnaRvr-drdgcKKwf3hz_YQw9rJNoHW_CPuPXV6y8F6W9E2k2fbJsymQdtnC868_Wm67pTdL0Fo5_fU1_uqY_SdNfOMH1NYPpmsEkzWDhLP_tQp3RTNC0qjH4bLHOv-z2C4eyxHE7jep0gfdaFUOZ8Xg3cENAorHjLRsPUTNcDYK_w-yP8P8nsPsc9i6p7F8CB5fAy7-C88N_PwIAAP__unYKDQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(a), count(a), stddev(a), variance(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF9ro0AUxd_3Uwz3KYEJZtT0j0-GJgEhTVpNy0KRMutc3EDqZGfGskvJd1_UQk1oVJA8hMz1ejzH35X7AfrPDjyI5sv53YbkakcW4fqevMx_PiynwYoMZkG0iR6XQ_J5i87fBnxICX9Py_9E5pkpT9oIge_l8Z2rLc8SHPBh9TzBDY-BQiYFrvgbavBegAEFGyg4QMEFChOIKeyVTFBrqYpbPkpBIP6CN6awzfa5KS7HFBKpELwPMFuzQ_Bgw3_tMEQuUFljoCDQ8O2utNmr7RtX__wiA1CI9jzTHhlZjPBMEEak-Y0KKKxz4xGfQXygIHPz5aUNTxE8dqDd80zTVGHKjVTW5DhO9HQ_8NkQKNytn1abz3P0GM6CxaKszgWwzwb48s0zqQQqFEem8aE5Ihufyxg93b8GRUq7qBbBarp8jTaz2fx54DvUZ7TeeJ6GwXR1Nz9qhZgJVAVZSnxm-TYl5c-hxHfPvqtz9K6s-_BZl-FbbGTZvcbfkqjG9uoy47e7I7E7IbFHltMLSUuiGpLryyBxuiNxOiFxRpbbC0lLohqSm8sgcbsjcTshcUfWpBeSlkQ1JLeX35vfBAhR72Wm8WR_fv_kcbFXUaRYLWEtc5Xgg5JJaVOV61JXXhCoTdVlVRFkVasIWBezRrF9JGanYrvZucXaaVS7zWK3T-5Jo_iq2fmqj_N1o_im2fmmj_Nt86zGLZ9J80d26h0ffvwPAAD__xJcIvU=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), avg(b), sum(a), sum(a), avg(b) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy0lF-L2kAUxd_7KYb7pDASZxJ33Txl2VoQ_LM1CoUllFnnkgqasTOT0iJ-95Kk7aqsk0Ds272TnJyT3x3uAcz3LYQQjyajpyXJ9ZZ8Wsyn5GX05XnyOJ6RzsdxvIw_T7rkzysm33VElxLxI-28dum__vy8-ooUViRAIVMSZ2KHBsIXYECBAwUfKARAYQAJhb1WazRG6eKVQykYy58Q9ilssn1ui-OEwlpphPAAdmO3CCEsxesWFygkaq8PFCRasdmWNnu92Qn9KyoyAIV4LzITkp7HiMgkYUTZb6iBwjy3IYkYjTgkRwoqt292xooUIWRH2jzSY5pqTIVV2hucJ4pX007EukWYouJF9TRfzZZlfc2cXzV_88wzpSVqlGeGydEdj_Xr88Wr6ddxkdAvugVmEnWJi0Tci3xalX_bqz_hn_0Eaz5U1mSoHut5vO1Ya0KdcLu7_Vh5cyK8ERHe8_y2RGpCnRC5vz0RvzkRvxERv-cFbYnUhDohMrw9kaA5kaARkaDnDdoSqQl1QuTh_y7Dd8wXaPYqM3ixFN__cr9YlihTrDarUble47NW69KmauelrjyQaGz1lFXNOKseFQFPxcwp5mdidinmbucaa9-pDtzioE3ugVN853a-a-N87xQP3c7DNs4P7ln1a66J-5JdeifHD78DAAD__4-zEsY=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(c), sum(c), avg(d), sum(d) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lF-L2kAUxd_7KYb7ZGAkThJdN08R64Lgn61RKCyhTJ1LKmhiZyalRfzuJYmwUdZJILhP8d7M8fxy7nBPoH7vwYdwMpuM1ySTe_KyWs7J2-T762w0XZDO12m4Dr_NLHI5wv_Ena1FicoOxTOvxaUWVqkWXPMIKCSpwAU_oAL_DRhQcICCCxQ8oNCHiMJRpltUKpX5kVMhmIq_4Pco7JJjpvN2RGGbSgT_BHqn9wg-rPnPPa6QC5R2DygI1Hy3L2yOcnfg8l-QMwCF8MgT5ZOuzQhPBGEk1b9QAoVlpn0SuDTwIDpTSDP9bqc0jxF8dqbNkUZxLDHmOpV2_5oo3Mw7AbOAwni5Wawvv4uuU-k61l0Q5y7Iu3-WpFKgRHFlHp3NqKx3jzXczH9ML1wXWveq7-XVChOB0icBs8ejMD89Cl9my9F6aFESMEoC1w68_HH349yrj2PNB8-aDN5mXdtpO_oaqEqeg8eO3mmejtMoHadru23TqYGqpPP02HTc5um4jdJxu7bXNp0aqEo6w8em4zVPx2uUjte1-23TqYGqpPP8eUv1A5AVqmOaKLxZrh__cy9fuihiLDe0SjO5xVeZbgubslwWuqIhUOnyLSuLaVK-ygGrYmYUO1didit2zM411q5R7ZnFXhvuvlE8MDsP2jg_GcVDs_OwjfOzeVa9mmtivmS33tH5y_8AAAD__48DJK0=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT max(a), min(b) FROM data HAVING min(b) > 2]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF-L2kwUxu_fTzGcK4WRZCbRdecq8tZtA_7ZqpSFbS5mzcEGYsZOJrBF_O5F03ZVdicD8TKTefJ7-J1w9lD-zEHAcjwZ_78ilc7Jw2I-Jc_jp8fJKJ6Rzqd4uVp-nXTJnytb-dqRXUq2WdF56da3U2kk-TL6Fs8-_z3_Xvl-gIQnQKFQKc7kFksQz8CAAgcKAVAIgUIfEgo7rdZYlkofr-xPgTh9BeFTyIpdZY7HCYW10ghiDyYzOYKAlXzJcYEyRe35QCFFI7P8hNnpbCv1r-hYDSgsd7IoBel5jMgiJYwo8wM1UJhXRpCI04hBcqCgKvOGK43cIAh2oO6VRpuNxo00Snv9y0bTeNaJWBcoTEdPnYh3PwTyD4FvnKpQOkWN6QUkOdgrMb-pE4WHLDeoBYnYvyEKIeLZauimK7hoz9wnyFwm6LGex9vOsKHUmbDBbWbI3S1wJwu85wVtLTSUOrNwdxsLgbuFwMlC0PPCthYaSp1ZGN7GQuhuIXSyEPa8flsLDaXOLNzffqu9A1xguVNFiVfb7f0v-8eth-kG6xVZqkqv8VGr9QlTP85PudNBiqWp37L6IS7qV8eC52FmDfOLMLsOczu5AR1Y06E9HLbp3beGB3byoA35zhoe2snDNuR7-6z8ht_E_pNds5PDf78DAAD__9kwAxM=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT (a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslEFvmzAYhu_7FdZ3ajUjMJA05ZSpzSSkLOmSHCZVHDz8qUOimNlG2hTlv0_AlC7RYqySo8Evz_vwWd6D_llCAtvFcvGwI40qyefN-gt5Xnx7Wn5KV-TmMd3utl-Xt-Tvlnadrh525Ibf9nsFNzwDCpUUuOKvqCF5BgYUQqAQAYUYKEwgo1ArmaPWUrVb9l0gFb8gCSgUVd2Y9nFGIZcKIdmDKUyJkMCOfy9xg1yg8gOgINDwouwwtSpeufo9bzsAhW3NK50Qz2eEV4IwIs0PVEBh3ZiEzBlkBwqyMW8sbfgLQsIO1L3PY6FNUeXGn5yWmbfSayVQobDSwou0N4jsv3NO-AjZwVaJBe_sFJ10Yu4TYS4T8Znnh6NmMtDo-AOmV5lJ6O4fOvmHnh-N8h9odPS_u4p_5O4fOflHnh-P8h9odPSfXcU_dvePnfxjz5-M8h9odPS_v_qd9B_aBnUtK40nrEtfDtoLC8UL9heclo3K8UnJvMP0y3WX6x4I1KZ_y_pFWvWv2oL_hpk1HJ6E2Xk4tJMH0JE1HdvD8ZjeE2t4aidPx5DvrOGZnTwbQ763zyoYOCb2Q3bOzg4f_gQAAP__GTjtnQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT SUM (DISTINCT A) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslFGLm04Uxd__n2K4T__ABDNqslmfsuymIGSTbUyhsPgwdS5WMI6dGaEl5LsXtSRNyI4S--g4557z88g9gP6RQwDRcrV83pFK5eTTdvNK3pdf31ZP4Zr8_xJGu-jzakT-XNHVvjkL1887wkftdcENj4FCIQWu-R41BO_AgIILFDyg4AOFKcQUSiUT1Fqq-sqhEYTiJwQTCllRVqY-jikkUiEEBzCZyREC2PFvOW6RC1TOBCgINDzLG5tSZXuufi3qDEAhKnmhAzJ2GOGFIIxI8x0VUNhUJiALBvGRgqzM2UsbniIE7Ej753nJtMmKxDjTyzCW-e6H889jq0IqgQrFxdT4eCPBU5oqTLmRymFXXyT68nquaMFGH0byLiKx_hWwPhU4bOy4g0roSHQqYXZnCW5_YrcXsTt2vEHEHYlOxA93Env9ib1exN7Y8QcRdyQ6Ec_vJPb7E_u9iP2xMx1E3JHoRPz4D1bLjflb1KUsNF6tmNuTJ_XqQZFiu6e0rFSCb0omjU37uGl0zYFAbdq3rH0Ii_ZVHfBvMbOK3Qsxuxa7ducOa8-q9u1if0juqVU8szvPhjg_WMVzu_N8iPOjvatJx29i_8muvePjf78DAAD__wbY234=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT SUM (DISTINCT A), SUM (DISTINCT B) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslFFr2zAUhd_3K8R9WkDBkey0qZ9S2gwCadIlGQyKH9To4hkcy5Nk2Aj578P2SOaQyibeo650dM6nK-4BzM8UQtjMFrOnLSl0Sr6sVy_kbfb9dfE4X5LPz_PNdvN1MSB_j5hiX9Xmy6ctEQPaLLwPar0UVkRAIVMSl2KPBsI3YECBAwUfKARAYQwRhVyrHRqjdHnkUAnm8heEIwpJlhe2LEcUdkojhAewiU0RQtiK9xTXKCRqbwQUJFqRpJVNrpO90L-nZQagsMlFZkIy9BgRmSSMKPsDNVBYFTYkU0anHKIjBVXYs52xIkYI2ZF2j_ScGJtkO-uNm3ncFvxDi_PNRaa0RI2ycXF0vBLiMY41xsIq7bGLd9l8ezk3asoG5ds0SnzwYUq_kZJ17w3r0huPDT3etzstoU7dubu9O7w7N-_EzYee35e7JdSJ-_52br87t9-J2x96QV_ullAn7snt3EF37qATdzD0xn25W0KduB_-zxS6YrFGk6vM4MU0un7zqJxSKGOsR5pRhd7hq1a7yqZeripdVZBobL3L6sU8q7fKgP-KmVPMG2J2KeZu5xZr36kO3OKgT-6xU3zndr7r43zvFE_czpM-zg_uXo1avon7k116R8dPfwIAAP__KV_rKg==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT a, b FROM data WHERE (a + b + c::INT) = 27 ORDER BY a,b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lFFr2zAUhd_3Ky73KSUKjmSnTQUDb43LDFnSOYFtFD8otugMrp1JCmyE_Pdhe6RNWGVDsjxeSUffuecKbVH_zJHjIpgGd0vYqBzuo_lneAy-PUw_hDPoTcLFcvFlegV_j1R1OLtbgiCwag6nwgj4-imIAuj1BPRhdQV9SDgPZ8vxFbwHdgPzaBJE8PF7LYuRYFGmciaepUb-iBQJMiToIkEPCY4wJrhWZSK1LlV1ZFsLwvQX8iHBrFhvTLUcE0xKJZFv0WQml8hxKVa5jKRIpXKGSDCVRmR5jVmr7Fmo335lGAku1qLQHAYOBVGkQKE0P6RCgvdZbqTi0Ov5FPrgs6of333dEG8KJDjfGA4-JT7DeEew3JgXb9qIJ4mc7kh3_5NMm6xIjDM6NN8gCM5VKpVM25jsTeYLqmyuOub0ic_6GO9s5ujwJHfugTvafaK0y0QdOnDYRWfa0sE-tuszzpR1T411So0NHPeiqbV0sE_t5oypud1Tczul5g4c76KptXSwT218xtS87ql5nVLzBs7ooqm1dLBP7fY__br_YEZSr8tCywPiWzcPq-9Ypk-y-cJ1uVGJfFBlUmOacl7r6oVUatPs0qYIi2arMvhaTK1idiCmx2JmJ7egXavas4u9U3yPrOJrO_n6FPKNVTy2k8enkG_tsxq2PBP7Iztmx7t3fwIAAP__l1s3KA==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT DISTINCT a, b FROM data WHERE (a + b + c::INT) = 27 ORDER BY b,a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJy8lVGLm0wYhe-_X_HyXmXJBHdGs5sd-MB216VCmmxNoC1LLiY6bAVX03ECLSH_vRgDbkIz42Kay1GP5xyfA26w_Jkhx1kwDu7nsFYZPEbTz_AcfHsafwgn0HsIZ_PZl_EV7B-pzuHkfg6CwLJ-OBFawNdPQRRAryegD8sr6EPMeTiZj67gf2C3MI0eggg-foclAbFAgnmRyIl4lSXyZ6RIkCFBFwl6SHCIC4IrVcSyLAtVPbLZCcLkF_Jrgmm-Wuvq8oJgXCiJfIM61ZlEjnOxzGQkRSKVc40EE6lFmu1sVip9Feq3XwVGgrOVyEsOA4eCyBOgUOgfUiHBxzTTUnHo9XwKffBZ1cd33xbi9QEJTteag0-Jz3CxJVisdZOt1OJFIqdb0j7_rFBaKmd4GN1nfeLT_kkL9h6Lh7TUaR5rhx59oLoGwalKpJKJrZd70rTxKupXnWpjTHf8Dd6XzjtIR9uvhrZZjUMHDrvobiwN9ru56bIbi0VDhp5xN6w9GdaKDBs47kXJWBrsydx2IWOxaMiwM5Jx25NxW5FxB453UTKWBnsyoy5kLBYNGfeMZLz2ZLxWZLyBM7woGUuDPZm7LmQsFg0Z7x_9Bf9iGslyVeSlPHA89ebr6vcokxdZ_1LLYq1i-aSKeGdTH6c73e5CIktd36X1IczrW1XAt2JqFDOzmBnF7oGYHotdc-wbs7VnVA_N4qFRbHG-6VL61igemZ1HRvGdWXzXJTa1bMw2MvPKqGVmtNPOqGVonsXcvDRqmRo1b-04-2L7358AAAD__81oPMk=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data GROUP BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUlt1r4kwUxu_fv2I4V4ojcSaJH7lK3759F8HGrh-wpUiZmsEKNnEncdlS_N-XJLJ-pJ0TMYLexZhfzpnzPOchHxD9XIADw7ve3e2IrNSC_D_o35Onux8PvZuuRyr_dYej4fdelWwemVLiUxKt3iqC1MjUcbreqF0lNSJ-zSovpEb8avYKX8SCfBv0xw_k38cUmwCFIPSlJ95kBM4TMKDAgYIJFCygYMOEwlKFUxlFoUoe-UiBrv8bnAaFebBcxcntCYVpqCQ4HxDP44UEB0biZSEHUvhSGQ2g4MtYzBdpmaWavwn17iYdAYXhUgSRQ-oGIyLwCSNh_CoVUBjIwJfKIa5JiWtR4rKaa2YHpMTlNdeCyZpCuIq3bUSxmElw2JoWb_VmNlNyJuJQGfZ-py6jbjKQG-_x2euPnr1xr1dxWTV3iye3huP7imv-vbKSq9v-2Bul1_utbqu_vJNXEb1-Vniy3p6If3mi7atWQah8qaS_97L0LZozs0bZhx6O75-7ybHt6q6MLFGNbuQ0XPtL9cxj1PPCerg02IFy-aI6u1jlDjdriTcOnvy8tr1XmxXfKlZkqwxWN_i59gppdsdjzSvZK1bmXrHL3itEvc1eNcvbK17c27yQt3ndMM_lbaTZHZ1bV-JtXqa3-WV7G1Fv4-1Wed42i3vbLORts25Y5_I20uyOzu0r8bZZprfNy_Y2ot7G2-3yvG0V97ZVyNtW3bDP5W2k2R2dO1fibatMb1uX7W1EvY23O-f51v-k4EBGyzCIZKEv-UYyfOnPZKZUFK7UVD6ocJqWyX72Uy694csozv5l2Y9ukP2VNLgLs0OY7cJ8D2bHwa1TYMZOou2T6I6e5tqBm_qBm1rY0le2tDBHtLa1dFMPN08xih5GjKKHMaMgNGIUhEaM0tIOvK0fePsUo3T0mdBAQiEXKUelgp7GYkFPo7mA4FgwIDgiOMsFy_7cOTJ3fbIgmjN9tDALKZ4Ll6NE19OY6HoaFR3BMdERHBNdn6sMCVaWy5ijRNdnDENChuVS5ijR9TQmup5GRUdwTHQEx0TXJyxHEpbrP9oORZ-s__kTAAD__9amDmA=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data GROUP BY c, d ORDER BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzUl1-PqkgQxd_3U3TqSWMb7AYc5YnZe92NiYOz_kn25sZMGOk4Jg64DW52MvG7b0BdcdAuWDDRN0APp7qqfif6CeFfK7Bg3Bv0vk3IRq7Ib6PhE_nZ-_N58Nh3SO17fzwZ_zGok_1X5pR4lISb95pLGmRuWX1n0qmTBnH_XtReSYN49d0rPDdyye-j4fSZ_PojkZHh6HtvdLibAQU_8ITjvosQrJ_AgAIHCjpQMICCCTMKaxnMRRgGMv7KZyLoe_-A1aKw9NebKH48ozAPpADrE6JltBJgwcR9XYmRcD0htRZQ8ETkLleJzVou3135Ycf1AYXx2vVDizQ1RlzfI4wE0ZuQQGEkfE9Ii9g6JbZBic0atr47LiU2b9gGzLYUgk10LCOM3IUAi21p_lIfFwspFm4USM08rdRm1I4b8uj8eHGGkxdnOhjUbFbPPOLxo_H0qWbr_10Z8dW34dSZJNenpR7dXz_Imxu-nTOebY8n4hdPdHzVxg-kJ6TwTl6WvEVxZtaq-tDj6dNLPz62WU-PkcVTo_txarZ5cXp6kek5QTNYa-zL5LKmqnUxihiOAxkJqfFM2xrU5o2LHmaOAZ4bX-rFF0_PzS8TP19C-6QElh9glgdgjTU1fi2EkWJT69y-E4RZlQiz20YYmd4e4XZ1CCOGB4QzbSuCMM_PD8_FD29q-rX4QYpN7dLDnfDDq-SH3zY_yPT2_DxUxw9ieOAn07Yi_Oj5-dFz8aM3NeNa_CDFpnapcyf86FXyo982P8j09vx0quMHMTzwk2lbEX6M_PwYufgxmpp5LX6QYlO71L0Tfowq-TFumx9kent-utXxgxge-Mm07f_-BTvjMRLhOvBDkeufVSsesPAWYrcNYbCRc_Esg3lis7sdJrrkgSfCaPcp2930_d1HcYFpMfsqZmkxPxGzYuJOGTHTS6lLeXPEmysbrqsbrivFhlpsKMWmumxTKeZttXVbqX5Qix_KbJlajExaLca2DFGX8sa2rKNseFfd8K46E1pIKKgjBdkzlqHr1Jwj5hm8CkWSWo3lglqNhhIiL-eOLQxTRwtDsoWpw4WZiFwdL9jOqOOFIfnCSgUMosamVi5iMHk5d3Rn1CnDkJhh6pzhSM7wUjnD1TnDkZzhpXIGUSNTQ9TYzmDycu7ozx91znAkZ7g6ZziSM7xYzsy2v_wbAAD__2loGKI=

# There should be no "by hash" routers if there is a single stream.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, d, sum(a+c::INT) + avg(b+d) FROM data WHERE a > 9 GROUP BY c, d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkmGPk04Qxt__P8VkXtF0L2Wh_0T31VatZxOOVqDq5SSXPXZCmlAWd8Fomn53A5jYakR9uc_M8_CbGU7oPlUoMF1H65cZdLaC18n2Dh7WH3bRahOD92qTZunbaAbfWwoGmoHrjp6CORRCbOLs2QzmoD6X3hPMQc_GCK1aBe_frJM1KPjY-X5I8Bxuk-1-By_uh5wcGdZGU6yO5FA8IEeG_2POsLGmIOeM7eXT0LTRX1D4DA9107W9nDMsjCUUJ2wPbUUoMDY3plkEyFBTqw7V0HZmaLr2h8m1qiQU4ZldBPPp4Ew9VZSQ0mQX_lU8NvZwVPar7OdFhmmjaidgwf0bZJhQrckKkCEDuWQg-VyG484YyGAul_g7Pv4vfKuytFSq1tgFv8aTnMl-Iav4_jHeZo_xPoo8yWe_SEEvpfs7T4ZD8d2tJ5ezyxl4j8xAhlPYwRX2H-6VkGtM7eivDuafc4akSxr_CWc6W9DOmmL4zPjcDr5B0OTasRqOj009lnrASzOfNAfT5mDS7P9kzs__fQsAAP__05IPZw==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a), sum(b), sum(c) FROM data GROUP BY d HAVING sum(a+b) > 10]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll1vmzAUhu_3K6xzFVRHYAxpyxVZm3aRUtIl6bSqiyoSrDRSijMD0qoq_30CuuZrtamcSFzZfDz42M-rI14h-b0AD4adXudihDKxQFeD_g166Py87bW7AWpcdoej4feegd5eSbLnRmjgYpy8jVOjpKIwDdH1oH93i77eowh9a__oBtclgk7QxEC_MsuiDBFrDBhiHrEgfGYJeA9AAIMNGChgcACDC2MMS8GnLEm4yF95LYBu9Ac8C8M8XmZpfnuMYcoFA-8V0nm6YODBKJws2ICFEROmBRgilobzRbHMUsyfQ_Hi56UChuEyjBMPNU2CwjhCBPH0iQnAMGBxxISHfAcjn5z4dj5gVIwUxisMPEvXFSRpOGPgkRWuXmV7NhNsFqZcmO52kX5-GMO7m4ZvG_9m9H3mvM_cfNYO7h-D_ugxuOv1Gj4xdopbrzd5QU9h8rSzlAvj1XoD9ocbWH8ni7mImGDR1peKr0i2SKy9hd92QQzlbq_mi7SwQdYJ8jzvsnPRvWn3AEM_S71cjk-x73yohx52dwFv8qVJ3J03_7-2s7U2qR5gUiXAJmma9hEirKhzw2-rnhEmh4wwqVuE7eoxsivFyG6a9AgxUtS5ccan9YyRfcgY2XWLEa0eI1opRrRpOkeIkaLOjTM-q2eM6CFjROsWI6d6jJxKMXKapnuEGCnq3Djj83rGyDlkjJy6xUjx2zxgyZLHCav012Xlu2fRjJVHlfBMTNmt4NNimfKyX3DFjYglafmUlBfduHyUF7gJk12YbML2Fkw-B7d04HMdmGjVTVw5bUvPm8phKpfVkttypLQrh10d1XJYoVoOK1TLYZVqBa1Q3dJRfSqFz-SyznRkyWGFLDmskCWHVbIUtELWuY4souiiqjaq10f1GqleJ9VspXq9lGg1U6Lopo5C2l47_ZQ0Oa2SJqdV0uS0UpoCV0nba6pSaePVl78BAAD__9Y8yNw=

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT avg(a+b), c FROM data GROUP BY c, d HAVING c = d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlltr2zAUx9_3KQ7nKaEKjnxJW0PBWdd2gdTpchkrJRTVFmkgtTLZGSsl333YHiTpRXJRAn5LZP2sc_T7c_ALpr8X6OPoon9xPoaVXMDlcHANdxe_bvrdXgiNb73RePSj34T_W9ifWYPBETw0CUTl5phlDK6Gg8kNfL2FiEAM37s_e-EVRHAG8RQJJiLmIXviKfp3SJGgjQQdJOgiQQ-nBJdSRDxNhcy3vBRAL_6LfpvgPFmusnx5SjASkqP_gtk8W3D0ccweFnzIWcyl1UaCMc_YfFEcs5TzJyafg7w8JDhasiT1oWVRYEkMFET2yCUSvJwvMi59CBw4gyAvaMiTuFwhELgEAnoU2DhdExSrbFNLmrEZR5-uSfV6u7OZ5DOWCWl5u-UGlAT5rXTD2_twML4PJ_1-I6DNN0t2vjSaXDcCJ_91PpiE4-L3boGbMx-e4ZGlj-8dN11v-rA_7GPzqlUiZMwlj3deVrxF0Slt76fV0eT6vpc36zZ3LFmlpA8NOfvtLBQtsbSo92rn-2e7O2fT6mmmVdJs0ZZlHzTPmoq3LHdqnWe6zzzTOuXZrp4pu1Km7JblHDRTmoq3bvq41pmy95kpu06ZcqpnyqmUKadluQfNlKbirZs-qXWmnH1myqlTptzqmXIrZcptWd5BM6WpeOumT2udKXefmXLrlCnN1_aQp0uRpLzSl1o775zHM15eUypWMuI3UkTFMeXfQcEVCzFPs_IpLf_0kvJRXuA2TF_DdBu2d2D6ObhjAp-awNSobuqpaVt5344adtSyOmpbrpL21LBnoloNa1SrYY1qNaxTraE1qjsmqo-V8Ila1omJLDWskaWGNbLUsE6WhtbIOjWRRTVTVDdGzeao2SA1m6SGo9RsllKjYUo109TVSHszTj8lTU3rpKlpnTQ1rZWmwXXS3gxVpbTp-su_AAAA___hNt97

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), sum(a+b) FILTER (WHERE a < d), sum(a+b) FILTER (WHERE a = c) FROM data GROUP BY d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMllFr4k4Uxd__n2K4T0pH4mQS2wYK6X_X7gpWu9GyW7pSps5gBZtxJwlsKX73JaaLUbszKWPAJ3WcX-659xwueYXk1wICGHX73U9jlKkFuoqG1-i---Omf9kboMbn3mg8-tZvorcrSfbcYOgEPTZx6Tu66vXH3Qg1vn_tRl3E0M-s3aZTxPW3LtC0WRTkLGXoSzS8vUH_3yE-AQyx5GLAnkUCwT0QwOACBgoYPMDgwwTDUsmpSBKp8iuva6DHf0PQxjCPl1maH08wTKUSELxCOk8XAgIYs8eFiATjQjltwMBFyuaLdZmlmj8z9RLmcgDDaMniJEAthyAWc0SQTJ-EAgyRiLlQAQo9jEJyErr5R9FzcXQRUpisMMgs3QhJUjYTEJAVri72cjZTYsZSqRx_W2uYz2R0e90I3ebm298Zh_Sds3xyl4O7h8Fw_DC47fcbIWnuyNxUfnxBTyx52inqwWS1acX9Zyub52SxVFwowbeetH6KplnS3iv81g9p7vdNd9vYSKSHlTiQLbl0iL9z8_3a3lZtUj2WpEosHdJy3PqCaZBb8qpz7MEkhwwmqSWYbvVwuJXC4bYcWl84DHJL8zo99nC4hwyHW0s4aPVw0ErhoC3Hqy8cBrmleZ0dezjoIcNBawmHVz0cXqVweC3Hry8cBrmleZ0fezi8Q4bDq_195x0BkUiWMk5EpbeZdt6C4DNR9JvITE3FjZLTdZni53DNrQ-4SNLiX1L86MXFX7nAMkx2YVKG3S2YfAzu2MDnNjCx0k18Pe1q5031MNWb1dG75WlpXw_7NlbrYYPVethgtR42WW2gDVZ3bKw-1cJnerPObMzSwwaz9LDBLD1sMstAG8w6tzGLGLaoaY3a7VG7RWq3SS1Xqd0uJVbLlBi2qWcwbW-dfsg0PW0yTU-bTNPTRtMMuMm0vaWqNW2y-u9PAAAA__9xq6AD

# Same query but restricted to a single range; no local aggregation stage.
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT sum(a+b), sum(a+b) FILTER (WHERE a < d), sum(a+b) FILTER (WHERE a = c) FROM data WHERE a = 1 GROUP BY d]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUUcGO0zAQvfMVozm1Wq8aJ3uytJIXyEKkbluSrgAtOXjjUVQpjYPtSKCq_44Sg9oiNsApM2_em3nxO6D72qDAIl2mb7bQ2wbu8_UDPKWfNsu7bAWzt1mxLT4s5_CT4vr9TMEVPM_ZWQ332XKb5jD7-D7NU1DwpY-ipAI9zbqFah4OauUVnGAO7_L14wZefwZdIsPWaFqpPTkUT8iRYYwlw86aipwzdoAPIynT31BEDHdt1_sBLhlWxhKKA_qdbwgFrsy16RYxMtTk1a4ZaUeGpvcnkfOqJhTJkZ0t5tOLt-q5oZyUJruILtZjZ3d7Zb_L4T-RYdGp1glY8OvRR06tJitA3jCQ_ErGwyc8YYBuZYIvWeT_Y_Guri3Vyhu74JcO5dAXjw8zGc9P1a_IZPIH7OZFT_GFp7_kkZPrTOvonwKJjiVD0jWFzJ3pbUUba6rxTGjXo24ENDkfpklosjaMBoPnYj4pjqfF8aQ4-k1cHl_9CAAA__-qthDj

# Verify the XOR execution plan
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT xor_agg(to_hex(a)::bytes) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslF1v2jAUhu_3K6xzVSSj4CRQ6quyjVVIrHTARacqQh4-SpFonNmOxIT471OSTg2odTIll_l487x5jnWOYH7vgcNqOp9-WZNM78m35eI7eZo-Pswns3ty9XW2Wq9-zHvk9ZWD0hsRx1dWbZ7xcCV6nH_-uZ6uemVQCisioJAoiffiBQ3wJ2BAwQcKAVAIgcIQIgqpVls0Run8lWMRmMkD8AGFXZJmNr8dUdgqjcCPYHd2j8BhLX7tcYlCovYGQEGiFbt9gUn17kXoP7d5B6CwSkViOOl7jIhEEkaUfUYNFJaYSNScvP7CLfv3DxCdKKjMvtGNFTECZyfavOEkjjXGwirtDc8LPi6Wm8ndXU78EOV_iHojZInSEjXKs89HJ3cZNvj_NsFZG9Z8NKzJaDzW9_yOh1PTseJj1HY4fnMdfiMdft8LOtZR07Gi47qtjqC5jqCRjqDvhR3rqOlY0TFuqyNsriNspCPse8OOddR0rOi46XKTvYNaoklVYvBio73_5UG-6VDGWK5FozK9xQettgWmvFwUueKGRGPLp6y8mCXlo7xgNcycYf8szC7Dvptcgw6c6dAdDtv0HjrDIzd51IZ87QyP3eRxG_KNe1aDmmPiPmSX7Oj06W8AAAD__-R8DCQ=

# Verify the XOR execution plan
query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT xor_agg(a) FROM data]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyslNFq2zAUhu_3FOJcJSBjy3bS1FcJW1YCWdMluSgUU7To4AVcy5Nk6Ah592F7UCe0sod2aVu_v__jiHMC_SuHBHbL9fLznlQqJ1-3m2_kafn4sF6s7snoy2q3331fj8nfI69SPfMsG_Fxe1Jww1OgUEiB9_wFNSRPwIBCCBQioBADhQmkFEolD6i1VPWRUxNYiVdIAgrHoqxM_TqlcJAKITmBOZocIYE9_5HjFrlA5QdAQaDhx7zBlOr4wtXved0BKOxKXuiEeD4jvBCEEWl-ogIKm8okZM4gPVOQlXljacMzhISd6fA-iyxTmHEjlT-5rPO42T4v7u5Gczb-EBV-iHojVIVUAhWKi9-nZ3sZFvx7m-iiDRs-CDZkED7z_NBpFD2NOvZT11GEw-XDQfKh50dO8j2NOvI3rvLRcPlokHzk-bGTfE-jjvzMVT4eLh8Pko89f-Ik39OoI3_7PzfQO6gt6lIWGq820ft_DuoNhSLDdp1pWakDPih5aDDt46bJNS8EatN-Ze3Dqmg_1QW7YWYNhxdhdh0O7eQedGRNx_Zw7NJ7Yg1P7eSpC_nGGp7ZyTMX8q19VkHPNbFfsmt2ev70JwAA__-WyOlb

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT max(t.a), min(t.b), avg(t.c)  FROM (VALUES (1, 2, 3), (4, 5, 6), (7, 8, 0)) AS t(a, b, c) WHERE b > 3]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUkF1r2zAUhu_3Kw7nSoJDajv7KLqK2dzNkKRdnHWFzheKfTAGxcokuRSC__uwPbZ10LHena_nfYTO6L8bVFhk6-z9Hnpn4Gp3vYH77O5mneZbEB_yYl98Xkv4eXLUjyIstCQ4tp0Ii4Mk0A-NCItKzqy4TddfsgJETJAQLCWBeE3whuDtWL4juCSIpIS0gABCExwIKglfP2W7DA7wrY-iJcOyRMLO1rzVR_ao7jHGkvDkbMXeWzeOztNBXj-iigjb7tSHcVwSVtYxqjOGNhhGhcZW2sCDNj17iC4iJKw56NZMyVetCewUrJJfdqVUvt1fYjkQ2j78TvZBN4wqHuj_7WnTOG50sO4ifmrepHdiFUsk3ORbsUrGKr39KFZL-aw6eYl6x_5kO89PtM8lR0NJyHXD8-d627uKb5ytJs3cXk_cNKjZh3kbz03ezavxgX_C8T_h5C-4HF79CAAA__8-tMoV

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (VALUES (1, '222'), (2, '444')) t1(a,b) JOIN (VALUES (1, 100.0), (3, 32.0)) t2(a,b) ON t1.a = t2.a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyckU9r20AQxe_9FMNcLJXB3l35JAjItC51cK00Sksh-LCVpo5gq3V3V6Vg_N2LVin5Q9PGuWlm3m-e5u0B_Q-DOVbL9fLNFfTOwLvL8gNcL79crBerDSRvV9VV9XGdwq3k9ShIPi_Wn5YVJJJgopSapASJIpjM5_NJmsKigiAh0QRfUzgvh033CCnEVAxERpCpqbgF1B-g3ECQUw1nENRUb5Gwsw1v9Hf2mF-jxC3h3tmavbduaB2iYNX8wlwQtt2-D0N7S1hbx5gfMLTBMOZobK0N_NSmZw9iJpCw4aBbE_VHQtuHO9oHvWPM5ZFe6CBn8lkO6kmHu8V9Z13DjpvHG_8v-ctvvtf-5ty2HbuZeqBGw99CUsj0zLW7m_iFhGUfcigkFYqKjIo5PnVJdkpWl-z3tvP8rIzEcAY3Ox5j8bZ3NV84W0ebsSwjFxsN-zBO1VisujiKj3kflifA6jGs_glnD2Bx3B5f_Q4AAP__go0S1Q==

statement ok
CREATE TABLE nullables (a INT, b INT, c INT, PRIMARY KEY (a))

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT array_agg(a) FROM (SELECT a FROM data WHERE b = 1 AND c = 1.0 AND d = 1.0 ORDER BY a)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlNFr2zAQxt_3V4h7spkyR7YzimBgr3E6Q5p0TmArxRQ1OryAa2WSAish__uwna7zWDaXvOTNn-4-3_e7h9uB-V4Ch0UyTS6XZKtLMsnm1-Qu-XozjdMZccbpYrn4PHXJoUVoLZ7uRVE4wm17nedKK6Wwgnz5lGQJcZwH8oEwl8SzMXFW9fe7oXuQ8iDJPBsnGfl4S4SbA4VKSZyJRzTA74ABBR8oBEAhBAojyClstFqhMUrXLbvGkMofwIcU1tVma-vnnMJKaQS-A7u2JQKHpXgoMUMhUXtDoCDRinXZjNno9aPQT1GdHSgsNqIynAw8RkQlCSPKfkMNFCbr0qLmxHEiv47POU9ny4sDURS0SJzzyXQeLy-eUaPwV2GcXKbX8dQFCvOt5SRikO8pqK19CW6sKBA429MjcC9MSkvUKLs0EXsL-f4vG4iLQmMhrNLeqGuJsyy-vY-vrpyIuUcT-Z1ErP-6WZ91e2zg-eezcL8_nt8Lzx94wfngBf3xgl54wcALzwcv7I8X9sILB97ofPD-c-oyNBtVGeyQHfvzsD4VKAtsT4tRW73CG61WzZhWzhtf8yDR2LbKWpFWTakJ-LuZ_dP8vmMe_mn2T5kcnGIOTzGPXmXO929-BgAA__9VED8a

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT json_agg(a) FROM (SELECT a FROM data WHERE b = 1 AND c = 1.0 AND d = 1.0 ORDER BY a)]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlNGL00AQxt_9K5Z5SnBrukkqx4KQeM2dkV5zpgWVIxx73SFWctm6uwWl9H-XJNUzYjXSl77l25kv8_3mYXZgvlTAYZHMkssl2eqKXOXZDblLPtzO4nROnGm6WC7ezVxyaPlsVH0vytIRbtfqHAqik1JYQd6_SfKEOM4DeUWYS-L5lDir5vvF2D1IeZAky6dJTl5_JMItgEKtJM7FIxrgd8CAgg8UAqAQAoUJFBQ2Wq3QGKWbll1rSOVX4GMK63qztc1zQWGlNALfgV3bCoHDUjxUmKOQqL0xUJBoxbpqx2z0-lHob1GTHSgsNqI2nIw8RkQtCSPKfkINFK7WlUXNieNEfhOfc57OlxcHoijokDjnV7MsXl78QI3Cn4VpcpnexDMXKGRby0nEoNhTUFv7FNxYUSJwtqdH4J6YlJaoUfZpIvYciv0fNhCXpcZSWKW9Sd_ydpHN7-Praydi7tFAfi8QG75tNmTbHht5_vns2x-O5w_C80decD54wXC8YBBeMPLC88ELh-OFg_DCkTc5H7x_XLoczUbVBntkx_48bi4FyhK7y2LUVq_wVqtVO6aTWetrHyQa21VZJ9K6LbUBfzWzv5pf9szj383-KZODU8zhKebJf5mL_bPvAQAA__9Wiz5w

# Test that orderings on GROUP BY columns are propagated through aggregations.
statement ok
CREATE TABLE sorted_data (a INT PRIMARY KEY, b INT, c FLOAT, INDEX foo(b))

# Split into ten parts.
statement ok
ALTER TABLE sorted_data SPLIT AT SELECT i FROM generate_series(1, 9) AS g(i)

# Relocate the ten parts to the five nodes.
statement ok
ALTER TABLE sorted_data EXPERIMENTAL_RELOCATE
  SELECT ARRAY[i%5+1], i FROM generate_series(0, 9) AS g(i)

# Verify data placement.
query TTTI colnames
SELECT start_key, end_key, replicas, lease_holder FROM [SHOW EXPERIMENTAL_RANGES FROM TABLE sorted_data]
----
start_key  end_key  replicas  lease_holder
NULL       /1       {1}       1
/1         /2       {2}       2
/2         /3       {3}       3
/3         /4       {4}       4
/4         /5       {5}       5
/5         /6       {1}       1
/6         /7       {2}       2
/7         /8       {3}       3
/8         /9       {4}       4
/9         NULL     {5}       5

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT a, max(b) FROM sorted_data GROUP BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMllFr2zwUhu-_XyHOVcKn4Ei209ZXybZuBNKkS1JoKaaosUgDqeVJMrSU_PfheBA3zSQbpSOXtvXovNJzOPgN1K81RDC7HF1-naNcrtH36eQK3V_eXo8GwzFqfRvO5rOfozb6s4Rh9MxeWo_tcqESUvPkIWGaoR_Tyc01-nKHWAwYUpHwMXvmCqJ7IICBAgYfMASAIYQYQybFgislZLHkbQsMkxeIuhhWaZbr4nWMYSEkh-gN9EqvOUQwZ49rPuUs4dLrAoaEa7Zab8tkcvXM5Gu_kgowzDKWqgh1PIJYmiCChH7iEjBMch2hPsF9CvEGg8j1rqrSbMkhIhtcP9lguZR8ybSQXvg-WL-4gIlMuORJURIwDMZ3D-PJ_GF8Mxq1-qQNGK4Gt60-be-F2e3_-IqemHr6sHW82QWmfw2820eUQfb3-b_cyHAq0j3esXaR_RqR8_RQ6IN5x6IjMo-EeysP1w7e1Sb1O4806DyPdDzq2nuWbBVLvdPoPXLk3iOf33u0vn_axD_teL6rf0u2yk2dnYZ_emT_9PP9-_X9-038-x0vcPVvyVa5qfPT8O8f2b__-f6D-v6DJv6Djhe6-rdkq9zUxWn4D47sP_i3_x4H0ky5ykSqeK0_i25xHp4seXl-JXK54NdSLLZlysfJltu-SLjS5VdSPgzT8lMRsAqTfZhUYfoOJs3gngt84QITp9wkNNPUeN--GfbNsnpmW4GRDs1w6KLaDFtUm2GLajNsU22hLap7LqrPjPC5Wda5iywzbJFlhi2yzLBNloW2yLpwkUUsU9Q2Rt3mqNsgdZukjqPUbZYSp2FKLNM0sEj7ME4bSTPTNmlm2ibNTFulWXCbtA9D1Sgt3vz3OwAA__-Q0Hw3

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT a, max(b) FROM sorted_data GROUP BY a ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMlmFr4jAYx9_fpwjPK-UiNWl1W1_p3bxDcHanDjaGjMwGJzjTSyJsDL_70fbAut2SltTDd9rml-ef_B4e-gbq9xpCmA5Gg-8ztJVr9GMSXaH7we31qD8co8blcDqb_ho10d8lDKNn9tJ4bOYLlZCaxw8x0wz9nEQ31-jbHWIomlwOJtnPOWDYiJiP2TNXEN4DAQwUMPiAIQAMHZhjSKRYcKWETJe8ZcAwfoGwjWG1SbY6fTzHsBCSQ_gGeqXXHEKYscc1n3AWc-m1AUPMNVutszKJXD0z-dorBAQM04RtVIhaHkFsEyOChH7iEjBEWx2iHsE9CvMdBrHV-6pKsyWHkOxw-WT95VLyJdNCep3DYL30AiIZc8njtCRg6I_vHsbR7GF8Mxo1eqQJGK76t40ebb4Ls9__8RU9MfX0Yev5bh-Yfhp4v4_Ig7zf52u-keFUpF3fsfaR_dojj0VLJB45lPBZ-eCgPCnffKRC83mk5VHX9rNkK4jqnkb7kZrbjxy__Wh5_7SKf9ryfFf_lmyFmzo7Df-0Zv_0-P798v79Kv79lhe4-rdkK9zU-Wn492v27x_ff1Def1DFf9DyOq7-LdkKN3VxGv6Dmv0H__fz4x9pJlwlYqN4qS-LdnoeHi95fn4ltnLBr6VYZGXyv1HGZQ9irnT-luR_hpv8VRqwCJP3MCnC9AAm1eCuC3zhAhOn3KRjpqnxvn0z7Jtldc22AiPdMcMdF9Vm2KLaDFtUm2GbagttUd11UX1mhM_Nss5dZJlhiywzbJFlhm2yLLRF1oWLLGKZorYx6jZH3Qap2yR1HKVus5Q4DVNimaaBRdqHcVpJmpm2STPTNmlm2irNgtukfRiqRmnz3Zc_AQAA__9IUH8M

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, min(b), a FROM sorted_data GROUP BY a, c]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMllFr4k4Uxd__n2K4T8p_JM5MYts8pbvbXQQbu2phS5EyNYMVbMadjLCl-N2XmIKpujMJE9DHJPObe889h0veIfu9hBDGN4ObrxO0Vkv0fTS8RY83v-4G1_0Ytb71x5Pxz0EbfRyZYfS6SFvPbYx4cTaTSovkKeGaox-j4f0d-vKAOEazKWBIZSJi_ioyCB-BAAYKGBhg8AFDAFMMKyVnIsukyo-8b4F-8gfCLoZFulrr_PUUw0wqAeE76IVeCghhwp-XYiR4IpTXBQyJ0Hyx3JZZqcUrV29RqTHAMF7xNAtRxyOIpwkiSOoXoQDDcK1DFBEcMRxRmG4wyLXeFc40nwsIyQZXb-56PldizrVUXvC5t7xOPoKhSoQSSV4YMFzHD0_xcPIU3w8GrYi2AcNtP25FrH3wkbT3WtxVfX5DLzx72SvIcERgutkpof9UsrtKFu3tX_V_cZFBLukeK1_Wy45J-tBLD_Wyfb07IayCkHV6TMpRFbHsyJVHgr2Tx2v7n2qT6lklNbLqkY5HG0irpb2Sfb0zTytpOK3kVGml1RND6ySGdjzWQGIs7ZVGeHHmiaENJ4aeKjGsemJYncSwjuc3kBhLe6URXp55YljDiWGnSoxfPTF-ncT4HS9oIDGW9kojvDrzxPgNJ8Y_h3-oIz2ORLaSaSYq_SF1c5UimYtiKplcq5m4U3K2LVM8Drfc9kUiMl18JcVDPy0-5Q2WYbIPkzJMP8GkHtxzga9cYOLUNwnMNDXOm5lhZjarZ3bLN9KBGQ5crDbDFqvNsMVqM2yz2kJbrO65WH1hhC_NZl26mGWGLWaZYYtZZthmloW2mHXlYhaxbFHbGnXbo26L1G2TOq5St11KnJYpsWxT32LawTqtZZqZtplmpm2mmWmraRbcZtrBUjWaNt389zcAAP__sV68Ng==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT c, min(b), a FROM sorted_data GROUP BY a, c ORDER BY a]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMll9r4kwUh-_fTzGcK-UdiTMTbZurdLfuItikqxa2FClTM1jBZtzJCFuK332JKRi1nTFMQC_z58k5Z54fh7xD9mcBAYx6g973MVqpBfoxjG_RY-_33eC6H6HGTX80Hv0aNNHHK1OMXudp47mJES_ezaTSInlKuObo5zC-v0PfHhDHaIri4U1vuLmaAIZUJiLiryKD4BEIYKCAgQEGHzB0YIJhqeRUZJlU-SvvG6Cf_IWgjWGeLlc6vz3BMJVKQPAOeq4XAgIY8-eFGAqeCOW1AUMiNJ8vNmWWav7K1VtY6hEwjJY8zQLU8gjiaYIIkvpFKMAQr3SAQoJDhkMKkzUGudLbwpnmMwEBWePjm7uezZSYcS2V19ntLa-TH0GsEqFEkhcGDNfRw1MUj5-i-8GgEdImYLjtR42QNQ8ekuZei9uqz2_ohWcvewUZDglM1ttJ6JeTbD8li_b2P_V_8SHDuKT9WfnyvOyzkT7mpYfzsv15t4Ow2geJZEsuPbLr7Kvy_k55cnxcSYW4eqTl0RoCa2mvZLB75oElNQeWnCqw9PjE0CqJoS2P1ZAYS3ulI7w488TQmhNDT5UYdnxiWJXEsJbn15AYS3ulI7w888SwmhPDTpUY__jE-FUS47e8Tg2JsbRXOsKrM0-MX3Ni_HP4jfqkx6HIljLNxFF_SO18SpHMRHEqmVypqbhTcropU1zGG25zIxGZLp6S4qKfFo_yBssw2YdJGaY7MKkGd13gKxeYOPVNOmaaGs-bmWFmltU12_KNdMcMd1xUm2GLajNsUW2GbaottEV110X1hRG-NMu6dJFlhi2yzLBFlhm2ybLQFllXLrKIZYva1qjbHnVbpG6b1HGVuu1S4rRMiWWb-hZpB-u0kjQzbZNmpm3SzLRVmgW3STtYqkZpk_V__wIAAP__ioq_DQ==

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT b, max(c) FROM sorted_data@foo GROUP BY b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJyUklFr2zAQx9_3KcT_KQGVxHb34idnWzYyXDtLUmgpJijW1RgcnyfJ0BHy3UfswpJCvPZRp_vd_ydOB9jfFUKs5_H860a0phLfV-mdeJo_LOPZIhGjb4v1Zv0rHovXlp0Ue_Uyysd9o2XjSG-1cip6ZhY_Vun9Unx5FLsMEjVrStSeLMIneJD4jEyiMZyTtWxO5UPXtNAvCKcSZd207lTOJHI2hPAAV7qKECLhG24mASQ0OVVWXdtRglv3D7JOFYTw9ijPBnvDgzdqV9GKlCYzmV6MxzNzdPZESKwbVdtQ3EAibV0oIg_XJLyPSPzksn518C4dGlPulfnzxqMP92UUXM33P5I_KwpDhXJsJv5lfnTySY0mQ7p7r8Qsedwm6Wab3MfxKPLGkLibPYwif3xVJriQ-c-qV2Qbri29a9fTYyZBuqD-O1luTU5Lw3kX0x_TjusKmqzrb2_7w6Lur06C57A3CPvDsD8IB8NwMAhP38DZ8dPfAAAA__-h7zgW

query T
SELECT url FROM [EXPLAIN (DISTSQL) SELECT * FROM (SELECT a, max(c) FROM sorted_data GROUP BY a) JOIN (SELECT b, min(c) FROM sorted_data@foo GROUP BY b) ON a = b]
----
https://cockroachdb.github.io/distsqlplan/decode.html#eJzMl1Fv4jgQx9_vU1jzBLdGwU6gFGml9O56J1YUem1X2tUKVYa4FInGnBOkXVX97qeQnggEPHFNb_O2BP_sGfL779TPkPyzhD7cXg4vf78ja70kf96Mr8i3yy_Xw4vBiDT-GNze3f49bJLXJb_mCxqvHwUlT-J7Y9bMHydKpzK6j0QqyF8348_X5LevRDTJp3G21yszpeRpER9iwgeltty0ScYjIshHMp0AhVhFciSeZAL9b8CAAgcKPlAIgEIHJhRWWs1kkiidLXneAIPoO_TbFBbxap1mjycUZkpL6D9DukiXEvpwJ6ZLeSNFJLXXBgqRTMViuTlmpRdPQv8ICzUChduViJM-aXmMiDgijKj0UWqgMF6nfRIyGvoweaGg1un21CQVcwl99kKrV3Yxn2s5F6nSXme3sDD7AcY6klpG2ZFA4WL09X40vrsffR4OGyFrAoWriy-NkDf3itnuP_1BHkXyWNp68rItmB8teLuPygvZ3-dDvpGhK9b-WW35bm3R7ap1fGjdwc6vpJ7LT2oRS-2x3u6-S_mQNkL2oflRL-aP-T-LSnEa-jQMjop1VqEhi1JHqqVWHvf3Vh4-u7dzNqseN2YRN4-1PO4aOKS2gprdegSOnThwrB6Bs27rBIE7f8_A8erScxvpecvzXaVHaivocVYP6fmJpef1kN66LXfpefs9pferS-_bSO-3vMBVeqS2gh69ekjvn1h6vx7SW7d1AunZe0ofVJc-sJE-aHkdV-mR2gp6nNdD-uDE0gf1kN7CEbZ3s3tQ6sh1cyvEURsCmyqytPxXRLeKqfnp3KRj5406srf95TEYOb-4rpuPJ_jfiv9fF8EDhdzIZKXiRFa65rWzVmQ0l_mvk6i1nslrrWabY_KP4w23eRDJJM2_ZfmHQZx_lRVYhNk-zIow34GZHXzmAjPmRHec6HMzzY207wL3XGCGvC6E7rrQHGnbN0oamOHACPPArHjHSHfNcNclH2YYyYcZxvKB0Eg-EBrJx5lLPswwkg8zjOUDoZF8mGksHz2XfJybJ0AbGQGlAWI1A8w0NgTMNDoFEBwbAwiOeM7MYwR54wiNmI7QmOoYjriO4JjsrDRLbGxn5lnCkHHAStPESnczjeluplHdERzTHcEx3UuD1Ep3M43pbqZR3REc092Mo7qXxqmV7qXBsqt7D9G9NFmsdDfTmO5mGtUdwTHdERzTvTRVrXQ305juZhrVHcEx3c04pjs3X0g5ciPlpdmyi3MEt7mdcUu650TvvTZrvOuEc6x1uyva5OWXfwMAAP__qOFDRA==
